{"version":3,"sources":["webpack://RamanSpectrum/webpack/universalModuleDefinition","webpack://RamanSpectrum/webpack/bootstrap","webpack://RamanSpectrum/./node_modules/ml-matrix/src/matrix.js","webpack://RamanSpectrum/./node_modules/ml-matrix/src/views/base.js","webpack://RamanSpectrum/./node_modules/ml-matrix/src/index.js","webpack://RamanSpectrum/./node_modules/ml-matrix/src/util.js","webpack://RamanSpectrum/./node_modules/is-any-array/src/index.js","webpack://RamanSpectrum/./node_modules/ml-matrix/src/dc/util.js","webpack://RamanSpectrum/./node_modules/ml-savitzky-golay-generalized/node_modules/ml-stat/array.js","webpack://RamanSpectrum/./node_modules/ml-optimize-lorentzian/src/index.js","webpack://RamanSpectrum/./node_modules/ml-matrix/src/abstractMatrix.js","webpack://RamanSpectrum/./node_modules/ml-matrix/src/dc/lu.js","webpack://RamanSpectrum/./node_modules/ml-matrix/src/dc/svd.js","webpack://RamanSpectrum/./node_modules/ml-stat/index.js","webpack://RamanSpectrum/./node_modules/ml-stat/array.js","webpack://RamanSpectrum/./node_modules/ml-curve-fitting/src/algebra.js","webpack://RamanSpectrum/./node_modules/ml-arrayxy-uniquex/src/index.js","webpack://RamanSpectrum/./lib/index.js","webpack://RamanSpectrum/./node_modules/ml-array-min/lib-es6/index.js","webpack://RamanSpectrum/./node_modules/ml-array-max/lib-es6/index.js","webpack://RamanSpectrum/./node_modules/ml-gsd/src/index.js","webpack://RamanSpectrum/./node_modules/ml-gsd/src/gsd.js","webpack://RamanSpectrum/./node_modules/ml-savitzky-golay-generalized/src/index.js","webpack://RamanSpectrum/./node_modules/extend/index.js","webpack://RamanSpectrum/./node_modules/ml-savitzky-golay-generalized/node_modules/ml-stat/index.js","webpack://RamanSpectrum/./node_modules/ml-savitzky-golay-generalized/node_modules/ml-stat/matrix.js","webpack://RamanSpectrum/./node_modules/ml-gsd/src/post/optimizePeaks.js","webpack://RamanSpectrum/./node_modules/ml-curve-fitting/src/index.js","webpack://RamanSpectrum/./node_modules/ml-curve-fitting/src/LM.js","webpack://RamanSpectrum/./node_modules/ml-matrix/src/symbol-species.js","webpack://RamanSpectrum/./node_modules/ml-matrix/node_modules/ml-array-utils/src/index.js","webpack://RamanSpectrum/./node_modules/ml-matrix/node_modules/ml-array-utils/src/ArrayUtils.js","webpack://RamanSpectrum/./node_modules/ml-stat/matrix.js","webpack://RamanSpectrum/./node_modules/ml-matrix/node_modules/ml-array-utils/src/getEquallySpaced.js","webpack://RamanSpectrum/./node_modules/ml-matrix/node_modules/ml-array-utils/src/snv.js","webpack://RamanSpectrum/./node_modules/ml-matrix/src/views/transpose.js","webpack://RamanSpectrum/./node_modules/ml-matrix/src/views/row.js","webpack://RamanSpectrum/./node_modules/ml-matrix/src/views/sub.js","webpack://RamanSpectrum/./node_modules/ml-matrix/src/views/selection.js","webpack://RamanSpectrum/./node_modules/ml-matrix/src/views/column.js","webpack://RamanSpectrum/./node_modules/ml-matrix/src/views/flipRow.js","webpack://RamanSpectrum/./node_modules/ml-matrix/src/views/flipColumn.js","webpack://RamanSpectrum/./node_modules/ml-matrix/src/decompositions.js","webpack://RamanSpectrum/./node_modules/ml-matrix/src/dc/evd.js","webpack://RamanSpectrum/./node_modules/ml-matrix/src/dc/qr.js","webpack://RamanSpectrum/./node_modules/ml-matrix/src/dc/cholesky.js","webpack://RamanSpectrum/./node_modules/ml-gsd/src/post/joinBroadPeaks.js","webpack://RamanSpectrum/./node_modules/ml-gsd/src/post/broadenPeaks.js","webpack://RamanSpectrum/./node_modules/jcampconverter/src/index.js","webpack://RamanSpectrum/./node_modules/ml-array-xy-sort-x/src/index.js","webpack://RamanSpectrum/./node_modules/xy-parser/src/index.js"],"names":["require","abstractMatrix","util","Matrix","Array","constructor","nRows","nColumns","i","arguments","length","isMatrix","clone","Number","isInteger","TypeError","isArray","matrix","RangeError","concat","rows","columns","set","rowIndex","columnIndex","value","get","newMatrix","Symbol","species","row","column","removeRow","index","checkRowIndex","splice","addRow","array","undefined","checkRowVector","removeColumn","checkColumnIndex","addColumn","checkColumnVector","exports","BaseView","module","Decompositions","DC","outer","max","vector","to1DArray","checkIndices","rowIndices","columnIndices","rowOut","some","r","columnOut","c","from","checkRange","startRow","endRow","startColumn","endColumn","notAllNumbers","slice","arg","getRange","to","arr","sumByRow","sum","zeros","j","sumByColumn","sumAll","v","toString","Object","prototype","isAnyArray","object","call","endsWith","hypotenuse","a","b","Math","abs","sqrt","getEmpty2DArray","getFilled2DArray","compareNumbers","values","Infinity","l","min","minMax","arithmeticMean","mean","geometricMean","mul","pow","logMean","lnsum","log","grandMean","means","samples","n","truncatedMean","percent","alreadySorted","sort","k","floor","harmonicMean","contraHarmonicMean","r1","r2","median","half","variance","unbiased","theMean","theVariance","x","standardDeviation","standardError","quartiles","quart","q1","ceil","q2","q3","pooledStandardDeviation","pooledVariance","vari","mode","itemCount","itemArray","count","indexOf","maxValue","maxIndex","covariance","vector1","vector2","mean1","mean2","cov","y","skewness","s2","s3","dev","m2","m3","g","kurtosis","s4","m4","entropy","eps","weightedMean","weights","weightedStandardDeviation","weightedVariance","z","w","center","inPlace","result","standardize","standardDev","cumulativeSum","LM","math","algebra","sumOfLorentzians","t","p","nL","factor","p2","cols","sumOfGaussians","exp","singleLorentzian","singleGaussian","factor2","optimizeSingleLorentzian","xy","peak","opts","xy2","parseData","percentage","y_data","maxY","nbPoints","weight","dot","create","LMOptions","consts","dt","dx","p_init","width","p_min","p_max","p_fit","optimize","optimizeSingleGaussian","optimizeLorentzianTrain","group","currentIndex","nextX","tI","yI","current","push","optimizeGaussianTrain","optimizeLorentzianSum","optimizeGaussianSum","threshold","nbSeries","transpose","sizeException","LuDecomposition","SvDecomposition","arrayUtils","MatrixTransposeView","MatrixRowView","MatrixSubView","MatrixSelectionView","MatrixColumnView","MatrixFlipRowView","MatrixFlipColumnView","superCtor","from1DArray","newRows","newColumns","newData","rowVector","columnVector","empty","fill","ones","rand","rng","random","randInt","eye","diag","data","matrix1","matrix2","checkMatrix","klass","size","apply","callback","ii","jj","to2DArray","copy","isRowVector","isColumnVector","isVector","isSquare","isSymmetric","Error","repeat","rowRep","colRep","setSubMatrix","neg","mulS","getRow","getRowVector","setRow","swapRows","row1","row2","temp","getColumn","getColumnVector","setColumn","swapColumns","column1","column2","addRowVector","subRowVector","mulRowVector","divRowVector","addColumnVector","subColumnVector","mulColumnVector","divColumnVector","mulRow","mulColumn","idx","minIndex","maxRow","maxRowIndex","minRow","minRowIndex","maxColumn","maxColumnIndex","minColumn","minColumnIndex","by","prod","mmul","other","console","warn","m","Bcolj","s","strassen2x2","a11","b11","a12","b12","a21","b21","a22","b22","m1","m5","m6","m7","c00","c01","c10","c11","strassen3x3","a00","a01","a02","a10","a20","b00","b01","b02","b10","b20","m8","m9","m10","m11","m12","m13","m14","m15","m16","m17","m18","m19","m20","m21","m22","m23","c02","c12","c20","c21","c22","mmulStrassen","c1","c2","embed","mat","resultat","blockMult","halfRows","parseInt","halfCols","subMatrix","add","sub","scaleRows","scaled","scale","scaleColumns","kroneckerProduct","q","sortRows","compareFunction","sortColumns","subMatrixRow","indices","subMatrixColumn","selection","trace","transposeView","rowView","columnView","flipRowView","flipColumnView","subMatrixView","selectionView","det","d","subMatrix0","subMatrix1","subMatrix2","determinant","pseudoInverse","EPSILON","svdSolution","autoTranspose","U","leftSingularVectors","V","rightSingularVectors","diagonal","checkDimensions","otherMatrix","identity","negate","tensorProduct","inplaceOperator","inplaceOperatorScalar","inplaceOperatorMatrix","staticOperator","inplaceMethod","staticMethod","inplaceMethodWithArgs","staticMethodWithArgs","inplaceMethodWithOneArgScalar","inplaceMethodWithOneArgMatrix","inplaceMethodWithOneArg","staticMethodWithOneArg","operators","operator","inplaceOp","eval","fillTemplateFunction","name","op","inplaceOpS","inplaceOpM","staticOp","methods","forEach","mathMethod","method","inplaceMeth","staticMeth","methodsWithArgs","methodWithArg","args","inplaceMethWithArgs","staticMethWithArgs","tmplVar","inplaceMethod2","inplaceMethodS","inplaceMethodM","staticMethod2","template","replace","RegExp","lu","pivotVector","pivotSign","LUrowi","LUcolj","kmax","LU","isSingular","col","lowerTriangularMatrix","X","upperTriangularMatrix","pivotPermutationVector","solve","SingularValueDecomposition","options","nu","wantu","wantv","computeLeftSingularVectors","computeRightSingularVectors","swapped","aux","e","work","nct","nrt","ks","f","cs","sn","kase","sp","spm1","epm1","sk","ek","shift","pp","iter","tmp","condition","norm2","rank","tol","diagonalMatrix","Y","scols","Ls","VL","vrows","urows","VLU","solveForDiagonal","inverse","vcols","ucols","robustMeanAndStdev","stdev","averageDeviations","A","B","subtract","multiply","dotMultiply","dotDivide","div","dotPow","inv","uniqueX","xs","ys","counter","defineProperty","_interopDefault","ex","mlGsd","jcampconverter","sortX","xyParser","getAnnotations","spectrum","fillColor","strokeColor","creationFct","peaks","annotations","map","annotation","line","type","strokeWidth","oneAnnotation","label","text","kind","anchor","color","position","wavelength","intensity","dy","addPeak","existing","getPeakKind","minIntensity","maxIntensity","peakPicking","targetWavelength","range","bestPeak","getClosest","findClosest","bestInRange","error","newError","setBestPeak","previousIndex","autoPeakPicking","noiseLevel","minMaxRatio","fromWavelength","toWavelength","replaceExisting","gsd","realTopDetection","maxCriteria","smoothY","sgOptions","windowSize","polynomial","filter","pop","peakLoop","Spectrum","json","check","setPeaks","getData","minWavelength","maxWavelength","fromJcamp","jcamp","convert","spectra","fromText","assign","arrayType","parseXY","input","post","optimizePeaks","joinBroadPeaks","broadenPeaks","SG","defaultOptions","broadRatio","heightFactor","boundaries","derivativeThreshold","yIn","maxDx","minDx","MAX_VALUE","getNoiseLevel","yCorrection","dY","ddY","derivative","maxDdy","lastMax","lastMin","minddY","intervalL","intervalR","broadMask","minddYLen","intervalLLen","intervalRLen","broadMaskLen","signals","signalsLen","lastK","possible","frequency","distanceJ","minDistance","gettingCloser","soft","left","right","yLeft","yRight","height","base","stddev","peakList","alpha","beta","gamma","currentPoint","log10","extend","stat","SavitzkyGolay","h","np","ans","fullWeights","hs","constantH","wg1","wg2","d1","d2","getHs","wg","GramPoly","Grampoly","GenFact","gf","Weight","hasOwn","hasOwnProperty","toStr","gOPD","getOwnPropertyDescriptor","isPlainObject","obj","hasOwnConstructor","hasIsPrototypeOf","key","setProperty","target","enumerable","configurable","newValue","writable","getProperty","src","copyIsArray","deep","arrayStat","l1","l2","dimension","N","sum1","sum2","medians","modes","skew","kurt","standardDeviations","standardErrors","sqrtN","scatter","divisor","correlation","scores","zScores","cor","resultRow","sourceRow","isNaN","weightSum","weightedCovariance","s1","weightedScatter","sampleFunction","lastIndex","sampleX","sampleY","direction","sign","delta","mid","stop","fnType","groups","groupPeaks","sampling","limits","optPeaks","optPeak","upperLimit","lowerLimit","DEBUG","func","y_dat","dp","tensor_parameter","iteration","Npar","Npnt","p_old","y_old","X2","X2_old","J","length_t","length_y_dat","corr","sigma_p","sigma_y","R_sq","cvg_hist","prnt","MaxIter","epsilon_1","epsilon_2","epsilon_3","epsilon_4","lambda_0","lambda_UP_fac","lambda_DN_fac","Update_Type","dp_array","Nfit","weight_sq","lm_matx","JtWJ","JtWdy","Chi_sq","y_hat","lambda","hidx","p_try","delta_y","X2_try","JtWdy_th","rho","dX2","lm_FD_J","ps","del","y1","lm_Broyden_J","h_t","Jt","for","getEquallySpacedData","SNV","Stat","coordArrayToPoints","dimensions","pointsArr","point","coordArrayToCoordMatrix","coordinatesArray","points","coordMatrixToCoordArray","coordMatrix","coodinatesArray","resultMatrix","pointsToCoordArray","applyDotProduct","firstVector","secondVector","largestVector","smallestVector","difference","dotProductApplied","currentMin","coordMatrixToPoints","pointsToCoordMatrix","theSum","product","theProduct","reverse","xLength","isFinite","numberOfPoints","algorithm","variant","output","getEquallySpacedSlot","getEquallySpacedSmooth","step","halfStep","start","initialOriginalStep","lastOriginalStep","previousX","MIN_VALUE","previousY","nextY","currentValue","slope","intercept","sumAtMin","sumAtMax","getSlope","x0","y0","x1","main","integral","lastStep","frontOutsideSpectra","backOutsideSpectra","currentPoints","std","EigenvalueDecomposition","QrDecomposition","CholeskyDecomposition","leftHandSide","rightHandSide","SVD","EVD","QR","CHO","assumeSymmetric","tred2","tql2","H","ort","orthes","hqr2","realEigenvalues","imaginaryEigenvalues","eigenvectorMatrix","hh","dl1","c3","el1","tst1","low","high","nn","exshift","norm","ra","sa","vr","vi","notlast","cdivres","cdiv","xr","xi","yr","yi","qr","rdiag","nrm","Rdiag","isFullRank","orthogonalMatrix","positiveDefinite","Lrowj","Lrowk","L","Opt","broadLines","maxI","candidates","indexes","fitted","overlap","nextPeak","getConverter","ntuplesSeparator","GC_MS_FIELDS","convertToFloatArray","stringArray","floatArray","parseFloat","keepRecordsRegExp","withoutXY","chromatogram","keepSpectra","noContour","nbContourLevels","noiseMultiplier","profiling","wantXY","Date","now","ntuples","ldr","dataLabel","dataValue","ldrs","endLine","infos","logs","info","action","time","split","substring","trim","toUpperCase","xIndex","yIndex","firstVariable","secondVariable","symbol","first","firstX","firstY","last","lastX","lastY","vardim","xFactor","yFactor","units","xUnit","yUnit","datatable","deltaX","prepareSpectrum","match","fastParseXYData","parsePeakTable","parseXYA","title","dataType","twoD","maxX","minX","minY","observeFrequency","xType","indirectFrequency","shiftOffsetNum","shiftOffsetVal","varname","vartype","varform","yType","page","pageValue","pageSymbol","pageSymbolIndex","unit","isMSField","convertMSFieldToLabel","sampleDescription","keys","newNtuples","add2D","complexChromatogram","simpleChromatogram","toLowerCase","times","series","ms","existingGCMSFields","getMedian","convertTo3DZ","minZ","maxZ","ySize","xSize","xVector","noise","zData","contourLines","generateContourLines","povarHeight0","povarHeight1","povarHeight2","povarHeight3","isOver0","isOver1","isOver2","isOver3","nbSubSpectra","nbPovars","pAx","pAy","pBx","pBy","xN","yN","contourLevels","lineZValue","level","contourLevel","side","lines","zValue","iSubSpectra","subSpectra","subSpectraAfter","povar","segments","isXYdata","currentData","currentX","currentY","ascii","charCodeAt","newLine","isDifference","isLastDifference","lastDifference","isDuplicate","inComment","lastValue","isNegative","inValue","skipFirstValue","decimalPosition","duplicate","ascii2","removeSymbolRegExp","isXYAdata","removeCommentRegExp","peakTableSplitRegExp","isPeaktable","JcampConverter","useWorker","postToWorker","stamps","worker","createWorker","Promise","resolve","stamp","postMessage","JSON","stringify","workerURL","URL","createObjectURL","Blob","Worker","revokeObjectURL","addEventListener","event","parse","createTree","flatten","flat","stack","ntupleLevel","spaces","includes","labelLine","startsWith","join","children","finished","entry","sortFunc","grouped","val","response","normalize","xColumn","yColumn","keepInfo","maxNumberColumns","minNumberColumns","fields","uniqueXFunction","newResult"],"mappings":"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","file":"raman-spectrum.js","sourcesContent":["(function webpackUniversalModuleDefinition(root, factory) {\n\tif(typeof exports === 'object' && typeof module === 'object')\n\t\tmodule.exports = factory();\n\telse if(typeof define === 'function' && define.amd)\n\t\tdefine([], factory);\n\telse if(typeof exports === 'object')\n\t\texports[\"RamanSpectrum\"] = factory();\n\telse\n\t\troot[\"RamanSpectrum\"] = factory();\n})(typeof self !== 'undefined' ? self : this, function() {\nreturn "," \t// The module cache\n \tvar installedModules = {};\n\n \t// The require function\n \tfunction __webpack_require__(moduleId) {\n\n \t\t// Check if module is in cache\n \t\tif(installedModules[moduleId]) {\n \t\t\treturn installedModules[moduleId].exports;\n \t\t}\n \t\t// Create a new module (and put it into the cache)\n \t\tvar module = installedModules[moduleId] = {\n \t\t\ti: moduleId,\n \t\t\tl: false,\n \t\t\texports: {}\n \t\t};\n\n \t\t// Execute the module function\n \t\tmodules[moduleId].call(module.exports, module, module.exports, __webpack_require__);\n\n \t\t// Flag the module as loaded\n \t\tmodule.l = true;\n\n \t\t// Return the exports of the module\n \t\treturn module.exports;\n \t}\n\n\n \t// expose the modules object (__webpack_modules__)\n \t__webpack_require__.m = modules;\n\n \t// expose the module cache\n \t__webpack_require__.c = installedModules;\n\n \t// define getter function for harmony exports\n \t__webpack_require__.d = function(exports, name, getter) {\n \t\tif(!__webpack_require__.o(exports, name)) {\n \t\t\tObject.defineProperty(exports, name, { enumerable: true, get: getter });\n \t\t}\n \t};\n\n \t// define __esModule on exports\n \t__webpack_require__.r = function(exports) {\n \t\tif(typeof Symbol !== 'undefined' && Symbol.toStringTag) {\n \t\t\tObject.defineProperty(exports, Symbol.toStringTag, { value: 'Module' });\n \t\t}\n \t\tObject.defineProperty(exports, '__esModule', { value: true });\n \t};\n\n \t// create a fake namespace object\n \t// mode & 1: value is a module id, require it\n \t// mode & 2: merge all properties of value into the ns\n \t// mode & 4: return value when already ns object\n \t// mode & 8|1: behave like require\n \t__webpack_require__.t = function(value, mode) {\n \t\tif(mode & 1) value = __webpack_require__(value);\n \t\tif(mode & 8) return value;\n \t\tif((mode & 4) && typeof value === 'object' && value && value.__esModule) return value;\n \t\tvar ns = Object.create(null);\n \t\t__webpack_require__.r(ns);\n \t\tObject.defineProperty(ns, 'default', { enumerable: true, value: value });\n \t\tif(mode & 2 && typeof value != 'string') for(var key in value) __webpack_require__.d(ns, key, function(key) { return value[key]; }.bind(null, key));\n \t\treturn ns;\n \t};\n\n \t// getDefaultExport function for compatibility with non-harmony modules\n \t__webpack_require__.n = function(module) {\n \t\tvar getter = module && module.__esModule ?\n \t\t\tfunction getDefault() { return module['default']; } :\n \t\t\tfunction getModuleExports() { return module; };\n \t\t__webpack_require__.d(getter, 'a', getter);\n \t\treturn getter;\n \t};\n\n \t// Object.prototype.hasOwnProperty.call\n \t__webpack_require__.o = function(object, property) { return Object.prototype.hasOwnProperty.call(object, property); };\n\n \t// __webpack_public_path__\n \t__webpack_require__.p = \"\";\n\n\n \t// Load entry module and return exports\n \treturn __webpack_require__(__webpack_require__.s = 15);\n","'use strict';\n\nrequire('./symbol-species');\nvar abstractMatrix = require('./abstractMatrix');\nvar util = require('./util');\n\nclass Matrix extends abstractMatrix(Array) {\n    constructor(nRows, nColumns) {\n        var i;\n        if (arguments.length === 1 && typeof nRows === 'number') {\n            return new Array(nRows);\n        }\n        if (Matrix.isMatrix(nRows)) {\n            return nRows.clone();\n        } else if (Number.isInteger(nRows) && nRows > 0) { // Create an empty matrix\n            super(nRows);\n            if (Number.isInteger(nColumns) && nColumns > 0) {\n                for (i = 0; i < nRows; i++) {\n                    this[i] = new Array(nColumns);\n                }\n            } else {\n                throw new TypeError('nColumns must be a positive integer');\n            }\n        } else if (Array.isArray(nRows)) { // Copy the values from the 2D array\n            const matrix = nRows;\n            nRows = matrix.length;\n            nColumns = matrix[0].length;\n            if (typeof nColumns !== 'number' || nColumns === 0) {\n                throw new TypeError('Data must be a 2D array with at least one element');\n            }\n            super(nRows);\n            for (i = 0; i < nRows; i++) {\n                if (matrix[i].length !== nColumns) {\n                    throw new RangeError('Inconsistent array dimensions');\n                }\n                this[i] = [].concat(matrix[i]);\n            }\n        } else {\n            throw new TypeError('First argument must be a positive number or an array');\n        }\n        this.rows = nRows;\n        this.columns = nColumns;\n        return this;\n    }\n\n    set(rowIndex, columnIndex, value) {\n        this[rowIndex][columnIndex] = value;\n        return this;\n    }\n\n    get(rowIndex, columnIndex) {\n        return this[rowIndex][columnIndex];\n    }\n\n    /**\n     * Creates an exact and independent copy of the matrix\n     * @return {Matrix}\n     */\n    clone() {\n        var newMatrix = new this.constructor[Symbol.species](this.rows, this.columns);\n        for (var row = 0; row < this.rows; row++) {\n            for (var column = 0; column < this.columns; column++) {\n                newMatrix.set(row, column, this.get(row, column));\n            }\n        }\n        return newMatrix;\n    }\n\n    /**\n     * Removes a row from the given index\n     * @param {number} index - Row index\n     * @return {Matrix} this\n     */\n    removeRow(index) {\n        util.checkRowIndex(this, index);\n        if (this.rows === 1) {\n            throw new RangeError('A matrix cannot have less than one row');\n        }\n        this.splice(index, 1);\n        this.rows -= 1;\n        return this;\n    }\n\n    /**\n     * Adds a row at the given index\n     * @param {number} [index = this.rows] - Row index\n     * @param {Array|Matrix} array - Array or vector\n     * @return {Matrix} this\n     */\n    addRow(index, array) {\n        if (array === undefined) {\n            array = index;\n            index = this.rows;\n        }\n        util.checkRowIndex(this, index, true);\n        array = util.checkRowVector(this, array, true);\n        this.splice(index, 0, array);\n        this.rows += 1;\n        return this;\n    }\n\n    /**\n     * Removes a column from the given index\n     * @param {number} index - Column index\n     * @return {Matrix} this\n     */\n    removeColumn(index) {\n        util.checkColumnIndex(this, index);\n        if (this.columns === 1) {\n            throw new RangeError('A matrix cannot have less than one column');\n        }\n        for (var i = 0; i < this.rows; i++) {\n            this[i].splice(index, 1);\n        }\n        this.columns -= 1;\n        return this;\n    }\n\n    /**\n     * Adds a column at the given index\n     * @param {number} [index = this.columns] - Column index\n     * @param {Array|Matrix} array - Array or vector\n     * @return {Matrix} this\n     */\n    addColumn(index, array) {\n        if (typeof array === 'undefined') {\n            array = index;\n            index = this.columns;\n        }\n        util.checkColumnIndex(this, index, true);\n        array = util.checkColumnVector(this, array);\n        for (var i = 0; i < this.rows; i++) {\n            this[i].splice(index, 0, array[i]);\n        }\n        this.columns += 1;\n        return this;\n    }\n}\n\nexports.Matrix = Matrix;\nMatrix.abstractMatrix = abstractMatrix;\n","'use strict';\n\nvar abstractMatrix = require('../abstractMatrix');\nvar Matrix = require('../matrix');\n\nclass BaseView extends abstractMatrix() {\n    constructor(matrix, rows, columns) {\n        super();\n        this.matrix = matrix;\n        this.rows = rows;\n        this.columns = columns;\n    }\n\n    static get [Symbol.species]() {\n        return Matrix.Matrix;\n    }\n}\n\nmodule.exports = BaseView;\n","'use strict';\n\nmodule.exports = require('./matrix').Matrix;\nmodule.exports.Decompositions = module.exports.DC = require('./decompositions');\n","'use strict';\n\nvar Matrix = require('./matrix');\n\n/**\n * @private\n * Check that a row index is not out of bounds\n * @param {Matrix} matrix\n * @param {number} index\n * @param {boolean} [outer]\n */\nexports.checkRowIndex = function checkRowIndex(matrix, index, outer) {\n    var max = outer ? matrix.rows : matrix.rows - 1;\n    if (index < 0 || index > max) {\n        throw new RangeError('Row index out of range');\n    }\n};\n\n/**\n * @private\n * Check that a column index is not out of bounds\n * @param {Matrix} matrix\n * @param {number} index\n * @param {boolean} [outer]\n */\nexports.checkColumnIndex = function checkColumnIndex(matrix, index, outer) {\n    var max = outer ? matrix.columns : matrix.columns - 1;\n    if (index < 0 || index > max) {\n        throw new RangeError('Column index out of range');\n    }\n};\n\n/**\n * @private\n * Check that the provided vector is an array with the right length\n * @param {Matrix} matrix\n * @param {Array|Matrix} vector\n * @return {Array}\n * @throws {RangeError}\n */\nexports.checkRowVector = function checkRowVector(matrix, vector) {\n    if (vector.to1DArray) {\n        vector = vector.to1DArray();\n    }\n    if (vector.length !== matrix.columns) {\n        throw new RangeError('vector size must be the same as the number of columns');\n    }\n    return vector;\n};\n\n/**\n * @private\n * Check that the provided vector is an array with the right length\n * @param {Matrix} matrix\n * @param {Array|Matrix} vector\n * @return {Array}\n * @throws {RangeError}\n */\nexports.checkColumnVector = function checkColumnVector(matrix, vector) {\n    if (vector.to1DArray) {\n        vector = vector.to1DArray();\n    }\n    if (vector.length !== matrix.rows) {\n        throw new RangeError('vector size must be the same as the number of rows');\n    }\n    return vector;\n};\n\nexports.checkIndices = function checkIndices(matrix, rowIndices, columnIndices) {\n    var rowOut = rowIndices.some(r => {\n        return r < 0 || r >= matrix.rows;\n\n    });\n\n    var columnOut = columnIndices.some(c => {\n        return c < 0 || c >= matrix.columns;\n    });\n\n    if (rowOut || columnOut) {\n        throw new RangeError('Indices are out of range');\n    }\n\n    if (typeof rowIndices !== 'object' || typeof columnIndices !== 'object') {\n        throw new TypeError('Unexpected type for row/column indices');\n    }\n    if (!Array.isArray(rowIndices)) rowIndices = Array.from(rowIndices);\n    if (!Array.isArray(columnIndices)) rowIndices = Array.from(columnIndices);\n\n    return {\n        row: rowIndices,\n        column: columnIndices\n    };\n};\n\nexports.checkRange = function checkRange(matrix, startRow, endRow, startColumn, endColumn) {\n    if (arguments.length !== 5) throw new TypeError('Invalid argument type');\n    var notAllNumbers = Array.from(arguments).slice(1).some(function (arg) {\n        return typeof arg !== 'number';\n    });\n    if (notAllNumbers) throw new TypeError('Invalid argument type');\n    if (startRow > endRow || startColumn > endColumn || startRow < 0 || startRow >= matrix.rows || endRow < 0 || endRow >= matrix.rows || startColumn < 0 || startColumn >= matrix.columns || endColumn < 0 || endColumn >= matrix.columns) {\n        throw new RangeError('Submatrix indices are out of range');\n    }\n};\n\nexports.getRange = function getRange(from, to) {\n    var arr = new Array(to - from + 1);\n    for (var i = 0; i < arr.length; i++) {\n        arr[i] = from + i;\n    }\n    return arr;\n};\n\nexports.sumByRow = function sumByRow(matrix) {\n    var sum = Matrix.Matrix.zeros(matrix.rows, 1);\n    for (var i = 0; i < matrix.rows; ++i) {\n        for (var j = 0; j < matrix.columns; ++j) {\n            sum.set(i, 0, sum.get(i, 0) + matrix.get(i, j));\n        }\n    }\n    return sum;\n};\n\nexports.sumByColumn = function sumByColumn(matrix) {\n    var sum = Matrix.Matrix.zeros(1, matrix.columns);\n    for (var i = 0; i < matrix.rows; ++i) {\n        for (var j = 0; j < matrix.columns; ++j) {\n            sum.set(0, j, sum.get(0, j) + matrix.get(i, j));\n        }\n    }\n    return sum;\n};\n\nexports.sumAll = function sumAll(matrix) {\n    var v = 0;\n    for (var i = 0; i < matrix.rows; i++) {\n        for (var j = 0; j < matrix.columns; j++) {\n            v += matrix.get(i, j);\n        }\n    }\n    return v;\n};\n","'use strict';\n\nconst toString = Object.prototype.toString;\n\nfunction isAnyArray(object) {\n  return toString.call(object).endsWith('Array]');\n}\n\nmodule.exports = isAnyArray;\n","'use strict';\n\nexports.hypotenuse = function hypotenuse(a, b) {\n    var r;\n    if (Math.abs(a) > Math.abs(b)) {\n        r = b / a;\n        return Math.abs(a) * Math.sqrt(1 + r * r);\n    }\n    if (b !== 0) {\n        r = a / b;\n        return Math.abs(b) * Math.sqrt(1 + r * r);\n    }\n    return 0;\n};\n\n// For use in the decomposition algorithms. With big matrices, access time is\n// too long on elements from array subclass\n// todo check when it is fixed in v8\n// http://jsperf.com/access-and-write-array-subclass\nexports.getEmpty2DArray = function (rows, columns) {\n    var array = new Array(rows);\n    for (var i = 0; i < rows; i++) {\n        array[i] = new Array(columns);\n    }\n    return array;\n};\n\nexports.getFilled2DArray = function (rows, columns, value) {\n    var array = new Array(rows);\n    for (var i = 0; i < rows; i++) {\n        array[i] = new Array(columns);\n        for (var j = 0; j < columns; j++) {\n            array[i][j] = value;\n        }\n    }\n    return array;\n};\n","'use strict';\n\nfunction compareNumbers(a, b) {\n    return a - b;\n}\n\n/**\n * Computes the sum of the given values\n * @param {Array} values\n * @returns {number}\n */\nexports.sum = function sum(values) {\n    var sum = 0;\n    for (var i = 0; i < values.length; i++) {\n        sum += values[i];\n    }\n    return sum;\n};\n\n/**\n * Computes the maximum of the given values\n * @param {Array} values\n * @returns {number}\n */\nexports.max = function max(values) {\n    var max = -Infinity;\n    var l = values.length;\n    for (var i = 0; i < l; i++) {\n        if (values[i] > max) max = values[i];\n    }\n    return max;\n};\n\n/**\n * Computes the minimum of the given values\n * @param {Array} values\n * @returns {number}\n */\nexports.min = function min(values) {\n    var min = Infinity;\n    var l = values.length;\n    for (var i = 0; i < l; i++) {\n        if (values[i] < min) min = values[i];\n    }\n    return min;\n};\n\n/**\n * Computes the min and max of the given values\n * @param {Array} values\n * @returns {{min: number, max: number}}\n */\nexports.minMax = function minMax(values) {\n    var min = Infinity;\n    var max = -Infinity;\n    var l = values.length;\n    for (var i = 0; i < l; i++) {\n        if (values[i] < min) min = values[i];\n        if (values[i] > max) max = values[i];\n    }\n    return {\n        min: min,\n        max: max\n    };\n};\n\n/**\n * Computes the arithmetic mean of the given values\n * @param {Array} values\n * @returns {number}\n */\nexports.arithmeticMean = function arithmeticMean(values) {\n    var sum = 0;\n    var l = values.length;\n    for (var i = 0; i < l; i++) {\n        sum += values[i];\n    }\n    return sum / l;\n};\n\n/**\n * {@link arithmeticMean}\n */\nexports.mean = exports.arithmeticMean;\n\n/**\n * Computes the geometric mean of the given values\n * @param {Array} values\n * @returns {number}\n */\nexports.geometricMean = function geometricMean(values) {\n    var mul = 1;\n    var l = values.length;\n    for (var i = 0; i < l; i++) {\n        mul *= values[i];\n    }\n    return Math.pow(mul, 1 / l);\n};\n\n/**\n * Computes the mean of the log of the given values\n * If the return value is exponentiated, it gives the same result as the\n * geometric mean.\n * @param {Array} values\n * @returns {number}\n */\nexports.logMean = function logMean(values) {\n    var lnsum = 0;\n    var l = values.length;\n    for (var i = 0; i < l; i++) {\n        lnsum += Math.log(values[i]);\n    }\n    return lnsum / l;\n};\n\n/**\n * Computes the weighted grand mean for a list of means and sample sizes\n * @param {Array} means - Mean values for each set of samples\n * @param {Array} samples - Number of original values for each set of samples\n * @returns {number}\n */\nexports.grandMean = function grandMean(means, samples) {\n    var sum = 0;\n    var n = 0;\n    var l = means.length;\n    for (var i = 0; i < l; i++) {\n        sum += samples[i] * means[i];\n        n += samples[i];\n    }\n    return sum / n;\n};\n\n/**\n * Computes the truncated mean of the given values using a given percentage\n * @param {Array} values\n * @param {number} percent - The percentage of values to keep (range: [0,1])\n * @param {boolean} [alreadySorted=false]\n * @returns {number}\n */\nexports.truncatedMean = function truncatedMean(values, percent, alreadySorted) {\n    if (alreadySorted === undefined) alreadySorted = false;\n    if (!alreadySorted) {\n        values = values.slice().sort(compareNumbers);\n    }\n    var l = values.length;\n    var k = Math.floor(l * percent);\n    var sum = 0;\n    for (var i = k; i < (l - k); i++) {\n        sum += values[i];\n    }\n    return sum / (l - 2 * k);\n};\n\n/**\n * Computes the harmonic mean of the given values\n * @param {Array} values\n * @returns {number}\n */\nexports.harmonicMean = function harmonicMean(values) {\n    var sum = 0;\n    var l = values.length;\n    for (var i = 0; i < l; i++) {\n        if (values[i] === 0) {\n            throw new RangeError('value at index ' + i + 'is zero');\n        }\n        sum += 1 / values[i];\n    }\n    return l / sum;\n};\n\n/**\n * Computes the contraharmonic mean of the given values\n * @param {Array} values\n * @returns {number}\n */\nexports.contraHarmonicMean = function contraHarmonicMean(values) {\n    var r1 = 0;\n    var r2 = 0;\n    var l = values.length;\n    for (var i = 0; i < l; i++) {\n        r1 += values[i] * values[i];\n        r2 += values[i];\n    }\n    if (r2 < 0) {\n        throw new RangeError('sum of values is negative');\n    }\n    return r1 / r2;\n};\n\n/**\n * Computes the median of the given values\n * @param {Array} values\n * @param {boolean} [alreadySorted=false]\n * @returns {number}\n */\nexports.median = function median(values, alreadySorted) {\n    if (alreadySorted === undefined) alreadySorted = false;\n    if (!alreadySorted) {\n        values = values.slice().sort(compareNumbers);\n    }\n    var l = values.length;\n    var half = Math.floor(l / 2);\n    if (l % 2 === 0) {\n        return (values[half - 1] + values[half]) * 0.5;\n    } else {\n        return values[half];\n    }\n};\n\n/**\n * Computes the variance of the given values\n * @param {Array} values\n * @param {boolean} [unbiased=true] - if true, divide by (n-1); if false, divide by n.\n * @returns {number}\n */\nexports.variance = function variance(values, unbiased) {\n    if (unbiased === undefined) unbiased = true;\n    var theMean = exports.mean(values);\n    var theVariance = 0;\n    var l = values.length;\n\n    for (var i = 0; i < l; i++) {\n        var x = values[i] - theMean;\n        theVariance += x * x;\n    }\n\n    if (unbiased) {\n        return theVariance / (l - 1);\n    } else {\n        return theVariance / l;\n    }\n};\n\n/**\n * Computes the standard deviation of the given values\n * @param {Array} values\n * @param {boolean} [unbiased=true] - if true, divide by (n-1); if false, divide by n.\n * @returns {number}\n */\nexports.standardDeviation = function standardDeviation(values, unbiased) {\n    return Math.sqrt(exports.variance(values, unbiased));\n};\n\nexports.standardError = function standardError(values) {\n    return exports.standardDeviation(values) / Math.sqrt(values.length);\n};\n\nexports.quartiles = function quartiles(values, alreadySorted) {\n    if (typeof(alreadySorted) === 'undefined') alreadySorted = false;\n    if (!alreadySorted) {\n        values = values.slice();\n        values.sort(compareNumbers);\n    }\n\n    var quart = values.length / 4;\n    var q1 = values[Math.ceil(quart) - 1];\n    var q2 = exports.median(values, true);\n    var q3 = values[Math.ceil(quart * 3) - 1];\n\n    return {q1: q1, q2: q2, q3: q3};\n};\n\nexports.pooledStandardDeviation = function pooledStandardDeviation(samples, unbiased) {\n    return Math.sqrt(exports.pooledVariance(samples, unbiased));\n};\n\nexports.pooledVariance = function pooledVariance(samples, unbiased) {\n    if (typeof(unbiased) === 'undefined') unbiased = true;\n    var sum = 0;\n    var length = 0, l = samples.length;\n    for (var i = 0; i < l; i++) {\n        var values = samples[i];\n        var vari = exports.variance(values);\n\n        sum += (values.length - 1) * vari;\n\n        if (unbiased)\n            length += values.length - 1;\n        else\n            length += values.length;\n    }\n    return sum / length;\n};\n\nexports.mode = function mode(values) {\n    var l = values.length,\n        itemCount = new Array(l),\n        i;\n    for (i = 0; i < l; i++) {\n        itemCount[i] = 0;\n    }\n    var itemArray = new Array(l);\n    var count = 0;\n\n    for (i = 0; i < l; i++) {\n        var index = itemArray.indexOf(values[i]);\n        if (index >= 0)\n            itemCount[index]++;\n        else {\n            itemArray[count] = values[i];\n            itemCount[count] = 1;\n            count++;\n        }\n    }\n\n    var maxValue = 0, maxIndex = 0;\n    for (i = 0; i < count; i++) {\n        if (itemCount[i] > maxValue) {\n            maxValue = itemCount[i];\n            maxIndex = i;\n        }\n    }\n\n    return itemArray[maxIndex];\n};\n\nexports.covariance = function covariance(vector1, vector2, unbiased) {\n    if (typeof(unbiased) === 'undefined') unbiased = true;\n    var mean1 = exports.mean(vector1);\n    var mean2 = exports.mean(vector2);\n\n    if (vector1.length !== vector2.length)\n        throw \"Vectors do not have the same dimensions\";\n\n    var cov = 0, l = vector1.length;\n    for (var i = 0; i < l; i++) {\n        var x = vector1[i] - mean1;\n        var y = vector2[i] - mean2;\n        cov += x * y;\n    }\n\n    if (unbiased)\n        return cov / (l - 1);\n    else\n        return cov / l;\n};\n\nexports.skewness = function skewness(values, unbiased) {\n    if (typeof(unbiased) === 'undefined') unbiased = true;\n    var theMean = exports.mean(values);\n\n    var s2 = 0, s3 = 0, l = values.length;\n    for (var i = 0; i < l; i++) {\n        var dev = values[i] - theMean;\n        s2 += dev * dev;\n        s3 += dev * dev * dev;\n    }\n    var m2 = s2 / l;\n    var m3 = s3 / l;\n\n    var g = m3 / (Math.pow(m2, 3 / 2.0));\n    if (unbiased) {\n        var a = Math.sqrt(l * (l - 1));\n        var b = l - 2;\n        return (a / b) * g;\n    }\n    else {\n        return g;\n    }\n};\n\nexports.kurtosis = function kurtosis(values, unbiased) {\n    if (typeof(unbiased) === 'undefined') unbiased = true;\n    var theMean = exports.mean(values);\n    var n = values.length, s2 = 0, s4 = 0;\n\n    for (var i = 0; i < n; i++) {\n        var dev = values[i] - theMean;\n        s2 += dev * dev;\n        s4 += dev * dev * dev * dev;\n    }\n    var m2 = s2 / n;\n    var m4 = s4 / n;\n\n    if (unbiased) {\n        var v = s2 / (n - 1);\n        var a = (n * (n + 1)) / ((n - 1) * (n - 2) * (n - 3));\n        var b = s4 / (v * v);\n        var c = ((n - 1) * (n - 1)) / ((n - 2) * (n - 3));\n\n        return a * b - 3 * c;\n    }\n    else {\n        return m4 / (m2 * m2) - 3;\n    }\n};\n\nexports.entropy = function entropy(values, eps) {\n    if (typeof(eps) === 'undefined') eps = 0;\n    var sum = 0, l = values.length;\n    for (var i = 0; i < l; i++)\n        sum += values[i] * Math.log(values[i] + eps);\n    return -sum;\n};\n\nexports.weightedMean = function weightedMean(values, weights) {\n    var sum = 0, l = values.length;\n    for (var i = 0; i < l; i++)\n        sum += values[i] * weights[i];\n    return sum;\n};\n\nexports.weightedStandardDeviation = function weightedStandardDeviation(values, weights) {\n    return Math.sqrt(exports.weightedVariance(values, weights));\n};\n\nexports.weightedVariance = function weightedVariance(values, weights) {\n    var theMean = exports.weightedMean(values, weights);\n    var vari = 0, l = values.length;\n    var a = 0, b = 0;\n\n    for (var i = 0; i < l; i++) {\n        var z = values[i] - theMean;\n        var w = weights[i];\n\n        vari += w * (z * z);\n        b += w;\n        a += w * w;\n    }\n\n    return vari * (b / (b * b - a));\n};\n\nexports.center = function center(values, inPlace) {\n    if (typeof(inPlace) === 'undefined') inPlace = false;\n\n    var result = values;\n    if (!inPlace)\n        result = values.slice();\n\n    var theMean = exports.mean(result), l = result.length;\n    for (var i = 0; i < l; i++)\n        result[i] -= theMean;\n};\n\nexports.standardize = function standardize(values, standardDev, inPlace) {\n    if (typeof(standardDev) === 'undefined') standardDev = exports.standardDeviation(values);\n    if (typeof(inPlace) === 'undefined') inPlace = false;\n    var l = values.length;\n    var result = inPlace ? values : new Array(l);\n    for (var i = 0; i < l; i++)\n        result[i] = values[i] / standardDev;\n    return result;\n};\n\nexports.cumulativeSum = function cumulativeSum(array) {\n    var l = array.length;\n    var result = new Array(l);\n    result[0] = array[0];\n    for (var i = 1; i < l; i++)\n        result[i] = result[i - 1] + array[i];\n    return result;\n};\n","'use strict';\n\nvar LM = require('ml-curve-fitting');\nvar math = LM.Matrix.algebra;\nvar Matrix = require('ml-matrix');\n\n/**\n * This function calculates the spectrum as a sum of lorentzian functions. The Lorentzian\n * parameters are divided in 3 batches. 1st: centers; 2nd: heights; 3th: widths;\n * @param t Ordinate values\n * @param p Lorentzian parameters\n * @param c Constant parameters(Not used)\n * @returns {*}\n */\nfunction sumOfLorentzians(t,p,c){\n    var nL = p.length/3,factor,i, j,p2, cols = t.rows;\n    var result = Matrix.zeros(t.length,1);\n\n    for(i=0;i<nL;i++){\n        p2 = Math.pow(p[i+nL*2][0]/2,2);\n        factor = p[i+nL][0]*p2;\n        for(j=0;j<cols;j++){\n            result[j][0]+=factor/(Math.pow(t[j][0]-p[i][0],2)+p2);\n        }\n    }\n    return result;\n}\n\n/**\n * This function calculates the spectrum as a sum of gaussian functions. The Gaussian\n * parameters are divided in 3 batches. 1st: centers; 2nd: height; 3th: std's;\n * @param t Ordinate values\n * @param p Gaussian parameters\n * @param c Constant parameters(Not used)\n * @returns {*}\n */\nfunction sumOfGaussians(t,p,c){\n    var nL = p.length/3,factor,i, j, cols = t.rows;\n    var result = Matrix.zeros(t.length,1);\n\n    for(i=0;i<nL;i++){\n        factor = p[i+nL*2][0]*p[i+nL*2][0]/2;\n        for(j=0;j<cols;j++){\n            result[j][0]+=p[i+nL][0]*Math.exp(-(t[i][0]-p[i][0])*(t[i][0]-p[i][0])/factor);\n        }\n    }\n    return result;\n}\n/**\n * Single 4 parameter lorentzian function\n * @param t Ordinate values\n * @param p Lorentzian parameters\n * @param c Constant parameters(Not used)\n * @returns {*}\n */\nfunction singleLorentzian(t,p,c){\n    var factor = p[1][0]*Math.pow(p[2][0]/2,2);\n    var rows = t.rows;\n    var result = new Matrix(t.rows, t.columns);\n    for(var i=0;i<rows;i++){\n        result[i][0]=factor/(Math.pow(t[i][0]-p[0][0],2)+Math.pow(p[2][0]/2,2));\n    }\n    return result;\n}\n\n/**\n * Single 3 parameter gaussian function\n * @param t Ordinate values\n * @param p Gaussian parameters [mean, height, std]\n * @param c Constant parameters(Not used)\n * @returns {*}\n */\nfunction singleGaussian(t,p,c){\n    var factor2 = p[2][0]*p[2][0]/2;\n    var rows = t.rows;\n    var result = new Matrix(t.rows, t.columns);\n    for(var i=0;i<rows;i++){\n        result[i][0]=p[1][0]*Math.exp(-(t[i][0]-p[0][0])*(t[i][0]-p[0][0])/factor2);\n    }\n    return result;\n}\n\n/**\n * * Fits a set of points to a Lorentzian function. Returns the center of the peak, the width at half height, and the height of the signal.\n * @param data,[y]\n * @returns {*[]}\n */\nfunction optimizeSingleLorentzian(xy, peak, opts) {\n    opts = opts || {};\n    var xy2 = parseData(xy, opts.percentage||0);\n\n    if(xy2===null||xy2[0].rows<3){\n        return null; //Cannot run an optimization with less than 3 points\n    }\n\n    var t = xy2[0];\n    var y_data = xy2[1];\n    var maxY = xy2[2];\n    var nbPoints = t.rows, i;\n\n    var weight = [nbPoints / Math.sqrt(y_data.dot(y_data))];\n\n    var opts=Object.create(opts.LMOptions || [  3,    100, 1e-3, 1e-3, 1e-3, 1e-2, 1e-2,    11,    9,        1 ]);\n    //var opts = [  3,    100, 1e-3, 1e-3, 1e-3, 1e-2, 1e-2,    11,    9,        1 ];\n    var consts = [ ];\n    var dt = Math.abs(t[0][0]-t[1][0]);// optional vector of constants\n    var dx = new Matrix([[-dt/10000],[-1e-3],[-dt/10000]]);//-Math.abs(t[0][0]-t[1][0])/100;\n    var p_init = new Matrix([[peak.x],[1],[peak.width]]);\n    var p_min = new Matrix([[peak.x-dt],[0.75],[peak.width/4]]);\n    var p_max = new Matrix([[peak.x+dt],[1.25],[peak.width*4]]);\n\n    var p_fit = LM.optimize(singleLorentzian,p_init,t,y_data,weight,dx,p_min,p_max,consts,opts);\n\n\n    p_fit = p_fit.p;\n    return [p_fit[0],[p_fit[1][0]*maxY],p_fit[2]];\n\n}\n\n/**\n * Fits a set of points to a gaussian bell. Returns the mean of the peak, the std and the height of the signal.\n * @param data,[y]\n * @returns {*[]}\n */\nfunction optimizeSingleGaussian(xy, peak, opts) {\n    opts = opts || {};\n    var xy2 = parseData(xy, opts.percentage||0);\n\n    if(xy2===null||xy2[0].rows<3){\n        return null; //Cannot run an optimization with less than 3 points\n    }\n\n    var t = xy2[0];\n    var y_data = xy2[1];\n    var maxY = xy2[2];\n\n    var nbPoints = t.rows, i;\n\n\n\n    var weight = [nbPoints / Math.sqrt(y_data.dot(y_data))];\n\n    var opts=Object.create(opts.LMOptions || [  3,    100, 1e-3, 1e-3, 1e-3, 1e-2, 1e-2,    11,    9,        1 ]);\n    //var opts = [  3,    100, 1e-3, 1e-3, 1e-3, 1e-2, 1e-2,    11,    9,        1 ];\n    var consts = [ ];                         // optional vector of constants\n    var dt = Math.abs(t[0][0]-t[1][0]);\n    var dx = new Matrix([[-dt/10000],[-1e-3],[-dt/10000]]);//-Math.abs(t[0][0]-t[1][0])/100;\n\n    var dx = new Matrix([[-Math.abs(t[0][0]-t[1][0])/1000],[-1e-3],[-peak.width/1000]]);\n    var p_init = new Matrix([[peak.x],[1],[peak.width]]);\n    var p_min = new Matrix([[peak.x-dt],[0.75],[peak.width/4]]);\n    var p_max = new Matrix([[peak.x+dt],[1.25],[peak.width*4]]);\n    //var p_min = new Matrix([[peak.x-peak.width/4],[0.75],[peak.width/3]]);\n    //var p_max = new Matrix([[peak.x+peak.width/4],[1.25],[peak.width*3]]);\n\n    var p_fit = LM.optimize(singleGaussian,p_init,t,y_data,weight,dx,p_min,p_max,consts,opts);\n    p_fit = p_fit.p;\n    return [p_fit[0],[p_fit[1][0]*maxY],p_fit[2]];\n}\n\n/*\n peaks on group should sorted\n */\nfunction optimizeLorentzianTrain(xy, group, opts){\n    var xy2 = parseData(xy);\n    //console.log(xy2[0].rows);\n    if(xy2===null||xy2[0].rows<3){\n        return null; //Cannot run an optimization with less than 3 points\n    }\n\n    var t = xy2[0];\n    var y_data = xy2[1];\n    var maxY = xy2[2];\n    var currentIndex = 0;\n    var nbPoints = t.length;\n    var nextX;\n    var tI, yI, maxY;\n    var result=[], current;\n    for(var i=0; i<group.length;i++){\n        nextX = group[i].x-group[i].width*1.5;\n        //console.log(group[i]);\n        while(t[currentIndex++]<nextX&&currentIndex<nbPoints);\n        nextX = group[i].x+group[i].width*1.5;\n        tI = [];\n        yI = [];\n        while(t[currentIndex]<=nextX&&currentIndex<nbPoints){\n            tI.push(t[currentIndex][0]);\n            yI.push(y_data[currentIndex][0]*maxY);\n            currentIndex++;\n        }\n\n        current=optimizeSingleLorentzian([tI, yI], group[i], opts);\n        if(current){\n            result.push({\"x\":current[0][0],\"y\":current[1][0],\"width\":current[2][0],\"opt\":true});\n        }\n        else{\n            result.push({\"x\":group[i].x,\"y\":group[i].y,\"width\":group[i].width,\"opt\":false});\n        }\n    }\n\n    return result;\n\n}\n\nfunction optimizeGaussianTrain(xy, group, opts){\n    var xy2 = parseData(xy);\n    //console.log(xy2[0].rows);\n    if(xy2===null||xy2[0].rows<3){\n        return null; //Cannot run an optimization with less than 3 points\n    }\n\n    var t = xy2[0];\n    var y_data = xy2[1];\n    var maxY = xy2[2];\n    var currentIndex = 0;\n    var nbPoints = t.length;\n    var nextX;\n    var tI, yI, maxY;\n    var result=[], current;\n    for(var i=0; i<group.length;i++){\n        nextX = group[i].x-group[i].width*1.5;\n        //console.log(group[i]);\n        while(t[currentIndex++]<nextX&&currentIndex<nbPoints);\n        nextX = group[i].x+group[i].width*1.5;\n        tI = [];\n        yI = [];\n        while(t[currentIndex]<=nextX&&currentIndex<nbPoints){\n            tI.push(t[currentIndex][0]);\n            yI.push(y_data[currentIndex][0]*maxY);\n            currentIndex++;\n        }\n\n        current=optimizeSingleGaussian([tI, yI], group[i], opts);\n        if(current){\n            result.push({\"x\":current[0][0],\"y\":current[1][0],\"width\":current[2][0],\"opt\":true});\n        }\n        else{\n            result.push({\"x\":group[i].x,\"y\":group[i].y,\"width\":group[i].width,\"opt\":false});\n        }\n    }\n\n    return result;\n}\n\n\n\n/**\n *\n * @param xy A two column matrix containing the x and y data to be fitted\n * @param group A set of initial lorentzian parameters to be optimized [center, heigth, half_width_at_half_height]\n * @returns {Array} A set of final lorentzian parameters [center, heigth, hwhh*2]\n */\nfunction optimizeLorentzianSum(xy, group, opts){\n    var xy2 = parseData(xy);\n\n    if(xy2===null||xy2[0].rows<3){\n        return null; //Cannot run an optimization with less than 3 points\n    }\n\n    var t = xy2[0];\n    var y_data = xy2[1];\n    var maxY = xy2[2];\n    var nbPoints = t.rows, i;\n\n    var weight = [nbPoints / math.sqrt(y_data.dot(y_data))];\n    var opts=Object.create(opts || [  3,    100, 1e-3, 1e-3, 1e-3, 1e-2, 1e-2, 11, 9, 1 ]);\n    var consts = [ ];// optional vector of constants\n\n    var nL = group.length;\n    var p_init = new Matrix(nL*3,1);\n    var p_min =  new Matrix(nL*3,1);\n    var p_max =  new Matrix(nL*3,1);\n    var dx = new Matrix(nL*3,1);\n    var dt = Math.abs(t[0][0]-t[1][0]);\n    for( i=0;i<nL;i++){\n        p_init[i][0] = group[i].x;\n        p_init[i+nL][0] = 1;\n        p_init[i+2*nL][0] = group[i].width;\n\n        p_min[i][0] = group[i].x-dt;//-group[i].width/4;\n        p_min[i+nL][0] = 0;\n        p_min[i+2*nL][0] = group[i].width/4;\n\n        p_max[i][0] = group[i].x+dt;//+group[i].width/4;\n        p_max[i+nL][0] = 1.5;\n        p_max[i+2*nL][0] = group[i].width*4;\n\n        dx[i][0] = -dt/1000;\n        dx[i+nL][0] = -1e-3;\n        dx[i+2*nL][0] = -dt/1000;\n    }\n\n    var dx = -Math.abs(t[0][0]-t[1][0])/10000;\n    var p_fit = LM.optimize(sumOfLorentzians, p_init, t, y_data, weight, dx, p_min, p_max, consts, opts);\n    p_fit=p_fit.p;\n    //Put back the result in the correct format\n    var result = new Array(nL);\n    for( i=0;i<nL;i++){\n        result[i]=[p_fit[i],[p_fit[i+nL][0]*maxY],p_fit[i+2*nL]];\n    }\n\n    return result;\n\n}\n\n/**\n *\n * @param xy A two column matrix containing the x and y data to be fitted\n * @param group A set of initial lorentzian parameters to be optimized [center, heigth, half_width_at_half_height]\n * @returns {Array} A set of final lorentzian parameters [center, heigth, hwhh*2]\n */\nfunction optimizeGaussianSum(xy, group, opts){\n    var xy2 = parseData(xy);\n\n    if(xy2===null||xy2[0].rows<3){\n        return null; //Cannot run an optimization with less than 3 points\n    }\n\n    var t = xy2[0];\n    var y_data = xy2[1];\n    var maxY = xy2[2];\n    var nbPoints = t.rows,i;\n\n    var weight = new Matrix(nbPoints,1);//[nbPoints / math.sqrt(y_data.dot(y_data))];\n    var k = nbPoints / math.sqrt(y_data.dot(y_data));\n    for(i=0;i<nbPoints;i++){\n        weight[i][0]=k;///(y_data[i][0]);\n        //weight[i][0]=k*(2-y_data[i][0]);\n    }\n\n    var opts=Object.create(opts || [  3,    100, 1e-3, 1e-3, 1e-3, 1e-2, 1e-2,    11,    9,        2 ]);\n    //var opts=[  3,    100, 1e-5, 1e-6, 1e-6, 1e-6, 1e-6,    11,    9,        1 ];\n    var consts = [ ];// optional vector of constants\n\n    var nL = group.length;\n    var p_init = new Matrix(nL*3,1);\n    var p_min =  new Matrix(nL*3,1);\n    var p_max =  new Matrix(nL*3,1);\n    var dx = new Matrix(nL*3,1);\n    var dt = Math.abs(t[0][0]-t[1][0]);\n    for( i=0;i<nL;i++){\n        p_init[i][0] = group[i].x;\n        p_init[i+nL][0] = group[i].y/maxY;\n        p_init[i+2*nL][0] = group[i].width;\n\n        p_min[i][0] = group[i].x-dt;\n        p_min[i+nL][0] = group[i].y*0.8/maxY;\n        p_min[i+2*nL][0] = group[i].width/2;\n\n        p_max[i][0] = group[i].x+dt;\n        p_max[i+nL][0] = group[i].y*1.2/maxY;\n        p_max[i+2*nL][0] = group[i].width*2;\n\n        dx[i][0] = -dt/1000;\n        dx[i+nL][0] = -1e-3;\n        dx[i+2*nL][0] = -dt/1000;\n    }\n    //console.log(t);\n    var p_fit = LM.optimize(sumOfLorentzians,p_init,t,y_data,weight,dx,p_min,p_max,consts,opts);\n    p_fit = p_fit.p;\n    //Put back the result in the correct format\n    var result = new Array(nL);\n    for( i=0;i<nL;i++){\n        result[i]=[p_fit[i],[p_fit[i+nL][0]*maxY],p_fit[i+2*nL]];\n    }\n\n    return result;\n\n}\n/**\n *\n * Converts the given input to the required x, y column matrices. y data is normalized to max(y)=1\n * @param xy\n * @returns {*[]}\n */\nfunction parseData(xy, threshold){\n    var nbSeries = xy.length;\n    var t = null;\n    var y_data = null, x,y;\n    var maxY = 0, i,j;\n\n    if(nbSeries==2){\n        //Looks like row wise matrix [x,y]\n        var nbPoints = xy[0].length;\n        //if(nbPoints<3)\n        //    throw new Exception(nbPoints);\n        //else{\n        t = new Array(nbPoints);//new Matrix(nbPoints,1);\n        y_data = new Array(nbPoints);//new Matrix(nbPoints,1);\n        x = xy[0];\n        y = xy[1];\n        if(typeof x[0] === \"number\"){\n            for(i=0;i<nbPoints;i++){\n                t[i]=x[i];\n                y_data[i]=y[i];\n                if(y[i]>maxY)\n                    maxY = y[i];\n            }\n        }\n        else{\n            //It is a colum matrix\n            if(typeof x[0] === \"object\"){\n                for(i=0;i<nbPoints;i++){\n                    t[i]=x[i][0];\n                    y_data[i]=y[i][0];\n                    if(y[i][0]>maxY)\n                        maxY = y[i][0];\n                }\n            }\n\n        }\n\n        //}\n    }\n    else{\n        //Looks like a column wise matrix [[x],[y]]\n        var nbPoints = nbSeries;\n        //if(nbPoints<3)\n        //    throw new SizeException(nbPoints);\n        //else {\n        t = new Array(nbPoints);//new Matrix(nbPoints, 1);\n        y_data = new Array(nbPoints);//new Matrix(nbPoints, 1);\n        for (i = 0; i < nbPoints; i++) {\n            t[i] = xy[i][0];\n            y_data[i] = xy[i][1];\n            if(y_data[i]>maxY)\n                maxY = y_data[i];\n        }\n        //}\n    }\n    for (i = 0; i < nbPoints; i++) {\n        y_data[i]/=maxY;\n    }\n    if(threshold){\n        for (i = nbPoints-1; i >=0; i--) {\n            if(y_data[i]<threshold) {\n                y_data.splice(i,1);\n                t.splice(i,1);\n            }\n        }\n    }\n    if(t.length>0)\n        return [(new Matrix([t])).transpose(),(new Matrix([y_data])).transpose(),maxY];\n    return null;\n}\n\nfunction sizeException(nbPoints) {\n    return new RangeError(\"Not enough points to perform the optimization: \"+nbPoints +\"< 3\");\n}\n\nmodule.exports.optimizeSingleLorentzian = optimizeSingleLorentzian;\nmodule.exports.optimizeLorentzianSum = optimizeLorentzianSum;\nmodule.exports.optimizeSingleGaussian = optimizeSingleGaussian;\nmodule.exports.optimizeGaussianSum = optimizeGaussianSum;\nmodule.exports.singleGaussian = singleGaussian;\nmodule.exports.singleLorentzian = singleLorentzian;\nmodule.exports.optimizeGaussianTrain = optimizeGaussianTrain;\nmodule.exports.optimizeLorentzianTrain = optimizeLorentzianTrain;","'use strict';\n\nmodule.exports = abstractMatrix;\n\nvar LuDecomposition = require('./dc/lu');\nvar SvDecomposition = require('./dc/svd');\nvar arrayUtils = require('ml-array-utils');\nvar util = require('./util');\nvar MatrixTransposeView = require('./views/transpose');\nvar MatrixRowView = require('./views/row');\nvar MatrixSubView = require('./views/sub');\nvar MatrixSelectionView = require('./views/selection');\nvar MatrixColumnView = require('./views/column');\nvar MatrixFlipRowView = require('./views/flipRow');\nvar MatrixFlipColumnView = require('./views/flipColumn');\n\nfunction abstractMatrix(superCtor) {\n    if (superCtor === undefined) superCtor = Object;\n\n    /**\n     * Real matrix\n     * @class Matrix\n     * @param {number|Array|Matrix} nRows - Number of rows of the new matrix,\n     * 2D array containing the data or Matrix instance to clone\n     * @param {number} [nColumns] - Number of columns of the new matrix\n     */\n    class Matrix extends superCtor {\n        static get [Symbol.species]() {\n            return this;\n        }\n\n        /**\n         * Constructs a Matrix with the chosen dimensions from a 1D array\n         * @param {number} newRows - Number of rows\n         * @param {number} newColumns - Number of columns\n         * @param {Array} newData - A 1D array containing data for the matrix\n         * @return {Matrix} - The new matrix\n         */\n        static from1DArray(newRows, newColumns, newData) {\n            var length = newRows * newColumns;\n            if (length !== newData.length) {\n                throw new RangeError('Data length does not match given dimensions');\n            }\n            var newMatrix = new this(newRows, newColumns);\n            for (var row = 0; row < newRows; row++) {\n                for (var column = 0; column < newColumns; column++) {\n                    newMatrix.set(row, column, newData[row * newColumns + column]);\n                }\n            }\n            return newMatrix;\n        }\n\n        /**\n         * Creates a row vector, a matrix with only one row.\n         * @param {Array} newData - A 1D array containing data for the vector\n         * @return {Matrix} - The new matrix\n         */\n        static rowVector(newData) {\n            var vector = new this(1, newData.length);\n            for (var i = 0; i < newData.length; i++) {\n                vector.set(0, i, newData[i]);\n            }\n            return vector;\n        }\n\n        /**\n         * Creates a column vector, a matrix with only one column.\n         * @param {Array} newData - A 1D array containing data for the vector\n         * @return {Matrix} - The new matrix\n         */\n        static columnVector(newData) {\n            var vector = new this(newData.length, 1);\n            for (var i = 0; i < newData.length; i++) {\n                vector.set(i, 0, newData[i]);\n            }\n            return vector;\n        }\n\n        /**\n         * Creates an empty matrix with the given dimensions. Values will be undefined. Same as using new Matrix(rows, columns).\n         * @param {number} rows - Number of rows\n         * @param {number} columns - Number of columns\n         * @return {Matrix} - The new matrix\n         */\n        static empty(rows, columns) {\n            return new this(rows, columns);\n        }\n\n        /**\n         * Creates a matrix with the given dimensions. Values will be set to zero.\n         * @param {number} rows - Number of rows\n         * @param {number} columns - Number of columns\n         * @return {Matrix} - The new matrix\n         */\n        static zeros(rows, columns) {\n            return this.empty(rows, columns).fill(0);\n        }\n\n        /**\n         * Creates a matrix with the given dimensions. Values will be set to one.\n         * @param {number} rows - Number of rows\n         * @param {number} columns - Number of columns\n         * @return {Matrix} - The new matrix\n         */\n        static ones(rows, columns) {\n            return this.empty(rows, columns).fill(1);\n        }\n\n        /**\n         * Creates a matrix with the given dimensions. Values will be randomly set.\n         * @param {number} rows - Number of rows\n         * @param {number} columns - Number of columns\n         * @param {function} [rng=Math.random] - Random number generator\n         * @return {Matrix} The new matrix\n         */\n        static rand(rows, columns, rng) {\n            if (rng === undefined) rng = Math.random;\n            var matrix = this.empty(rows, columns);\n            for (var i = 0; i < rows; i++) {\n                for (var j = 0; j < columns; j++) {\n                    matrix.set(i, j, rng());\n                }\n            }\n            return matrix;\n        }\n\n        /**\n         * Creates a matrix with the given dimensions. Values will be random integers.\n         * @param {number} rows - Number of rows\n         * @param {number} columns - Number of columns\n         * @param {number} [maxValue=1000] - Maximum value\n         * @param {function} [rng=Math.random] - Random number generator\n         * @return {Matrix} The new matrix\n         */\n        static randInt(rows, columns, maxValue, rng) {\n            if (maxValue === undefined) maxValue = 1000;\n            if (rng === undefined) rng = Math.random;\n            var matrix = this.empty(rows, columns);\n            for (var i = 0; i < rows; i++) {\n                for (var j = 0; j < columns; j++) {\n                    var value = Math.floor(rng() * maxValue);\n                    matrix.set(i, j, value);\n                }\n            }\n            return matrix;\n        }\n\n        /**\n         * Creates an identity matrix with the given dimension. Values of the diagonal will be 1 and others will be 0.\n         * @param {number} rows - Number of rows\n         * @param {number} [columns=rows] - Number of columns\n         * @param {number} [value=1] - Value to fill the diagonal with\n         * @return {Matrix} - The new identity matrix\n         */\n        static eye(rows, columns, value) {\n            if (columns === undefined) columns = rows;\n            if (value === undefined) value = 1;\n            var min = Math.min(rows, columns);\n            var matrix = this.zeros(rows, columns);\n            for (var i = 0; i < min; i++) {\n                matrix.set(i, i, value);\n            }\n            return matrix;\n        }\n\n        /**\n         * Creates a diagonal matrix based on the given array.\n         * @param {Array} data - Array containing the data for the diagonal\n         * @param {number} [rows] - Number of rows (Default: data.length)\n         * @param {number} [columns] - Number of columns (Default: rows)\n         * @return {Matrix} - The new diagonal matrix\n         */\n        static diag(data, rows, columns) {\n            var l = data.length;\n            if (rows === undefined) rows = l;\n            if (columns === undefined) columns = rows;\n            var min = Math.min(l, rows, columns);\n            var matrix = this.zeros(rows, columns);\n            for (var i = 0; i < min; i++) {\n                matrix.set(i, i, data[i]);\n            }\n            return matrix;\n        }\n\n        /**\n         * Returns a matrix whose elements are the minimum between matrix1 and matrix2\n         * @param {Matrix} matrix1\n         * @param {Matrix} matrix2\n         * @return {Matrix}\n         */\n        static min(matrix1, matrix2) {\n            matrix1 = this.checkMatrix(matrix1);\n            matrix2 = this.checkMatrix(matrix2);\n            var rows = matrix1.rows;\n            var columns = matrix1.columns;\n            var result = new this(rows, columns);\n            for (var i = 0; i < rows; i++) {\n                for (var j = 0; j < columns; j++) {\n                    result.set(i, j, Math.min(matrix1.get(i, j), matrix2.get(i, j)));\n                }\n            }\n            return result;\n        }\n\n        /**\n         * Returns a matrix whose elements are the maximum between matrix1 and matrix2\n         * @param {Matrix} matrix1\n         * @param {Matrix} matrix2\n         * @return {Matrix}\n         */\n        static max(matrix1, matrix2) {\n            matrix1 = this.checkMatrix(matrix1);\n            matrix2 = this.checkMatrix(matrix2);\n            var rows = matrix1.rows;\n            var columns = matrix1.columns;\n            var result = new this(rows, columns);\n            for (var i = 0; i < rows; i++) {\n                for (var j = 0; j < columns; j++) {\n                    result.set(i, j, Math.max(matrix1.get(i, j), matrix2.get(i, j)));\n                }\n            }\n            return result;\n        }\n\n        /**\n         * Check that the provided value is a Matrix and tries to instantiate one if not\n         * @param {*} value - The value to check\n         * @return {Matrix}\n         */\n        static checkMatrix(value) {\n            return Matrix.isMatrix(value) ? value : new this(value);\n        }\n\n        /**\n         * Returns true if the argument is a Matrix, false otherwise\n         * @param {*} value - The value to check\n         * @return {boolean}\n         */\n        static isMatrix(value) {\n            return (value != null) && (value.klass === 'Matrix');\n        }\n\n        /**\n         * @prop {number} size - The number of elements in the matrix.\n         */\n        get size() {\n            return this.rows * this.columns;\n        }\n\n        /**\n         * Applies a callback for each element of the matrix. The function is called in the matrix (this) context.\n         * @param {function} callback - Function that will be called with two parameters : i (row) and j (column)\n         * @return {Matrix} this\n         */\n        apply(callback) {\n            if (typeof callback !== 'function') {\n                throw new TypeError('callback must be a function');\n            }\n            var ii = this.rows;\n            var jj = this.columns;\n            for (var i = 0; i < ii; i++) {\n                for (var j = 0; j < jj; j++) {\n                    callback.call(this, i, j);\n                }\n            }\n            return this;\n        }\n\n        /**\n         * Returns a new 1D array filled row by row with the matrix values\n         * @return {Array}\n         */\n        to1DArray() {\n            var array = new Array(this.size);\n            for (var i = 0; i < this.rows; i++) {\n                for (var j = 0; j < this.columns; j++) {\n                    array[i * this.columns + j] = this.get(i, j);\n                }\n            }\n            return array;\n        }\n\n        /**\n         * Returns a 2D array containing a copy of the data\n         * @return {Array}\n         */\n        to2DArray() {\n            var copy = new Array(this.rows);\n            for (var i = 0; i < this.rows; i++) {\n                copy[i] = new Array(this.columns);\n                for (var j = 0; j < this.columns; j++) {\n                    copy[i][j] = this.get(i, j);\n                }\n            }\n            return copy;\n        }\n\n        /**\n         * @return {boolean} true if the matrix has one row\n         */\n        isRowVector() {\n            return this.rows === 1;\n        }\n\n        /**\n         * @return {boolean} true if the matrix has one column\n         */\n        isColumnVector() {\n            return this.columns === 1;\n        }\n\n        /**\n         * @return {boolean} true if the matrix has one row or one column\n         */\n        isVector() {\n            return (this.rows === 1) || (this.columns === 1);\n        }\n\n        /**\n         * @return {boolean} true if the matrix has the same number of rows and columns\n         */\n        isSquare() {\n            return this.rows === this.columns;\n        }\n\n        /**\n         * @return {boolean} true if the matrix is square and has the same values on both sides of the diagonal\n         */\n        isSymmetric() {\n            if (this.isSquare()) {\n                for (var i = 0; i < this.rows; i++) {\n                    for (var j = 0; j <= i; j++) {\n                        if (this.get(i, j) !== this.get(j, i)) {\n                            return false;\n                        }\n                    }\n                }\n                return true;\n            }\n            return false;\n        }\n\n        /**\n         * Sets a given element of the matrix. mat.set(3,4,1) is equivalent to mat[3][4]=1\n         * @abstract\n         * @param {number} rowIndex - Index of the row\n         * @param {number} columnIndex - Index of the column\n         * @param {number} value - The new value for the element\n         * @return {Matrix} this\n         */\n        set(rowIndex, columnIndex, value) { // eslint-disable-line no-unused-vars\n            throw new Error('set method is unimplemented');\n        }\n\n        /**\n         * Returns the given element of the matrix. mat.get(3,4) is equivalent to matrix[3][4]\n         * @abstract\n         * @param {number} rowIndex - Index of the row\n         * @param {number} columnIndex - Index of the column\n         * @return {number}\n         */\n        get(rowIndex, columnIndex) { // eslint-disable-line no-unused-vars\n            throw new Error('get method is unimplemented');\n        }\n\n        /**\n         * Creates a new matrix that is a repetition of the current matrix. New matrix has rowRep times the number of\n         * rows of the matrix, and colRep times the number of columns of the matrix\n         * @param {number} rowRep - Number of times the rows should be repeated\n         * @param {number} colRep - Number of times the columns should be re\n         * @return {Matrix}\n         * @example\n         * var matrix = new Matrix([[1,2]]);\n         * matrix.repeat(2); // [[1,2],[1,2]]\n         */\n        repeat(rowRep, colRep) {\n            rowRep = rowRep || 1;\n            colRep = colRep || 1;\n            var matrix = new this.constructor[Symbol.species](this.rows * rowRep, this.columns * colRep);\n            for (var i = 0; i < rowRep; i++) {\n                for (var j = 0; j < colRep; j++) {\n                    matrix.setSubMatrix(this, this.rows * i, this.columns * j);\n                }\n            }\n            return matrix;\n        }\n\n        /**\n         * Fills the matrix with a given value. All elements will be set to this value.\n         * @param {number} value - New value\n         * @return {Matrix} this\n         */\n        fill(value) {\n            for (var i = 0; i < this.rows; i++) {\n                for (var j = 0; j < this.columns; j++) {\n                    this.set(i, j, value);\n                }\n            }\n            return this;\n        }\n\n        /**\n         * Negates the matrix. All elements will be multiplied by (-1)\n         * @return {Matrix} this\n         */\n        neg() {\n            return this.mulS(-1);\n        }\n\n        /**\n         * Returns a new array from the given row index\n         * @param {number} index - Row index\n         * @return {Array}\n         */\n        getRow(index) {\n            util.checkRowIndex(this, index);\n            var row = new Array(this.columns);\n            for (var i = 0; i < this.columns; i++) {\n                row[i] = this.get(index, i);\n            }\n            return row;\n        }\n\n        /**\n         * Returns a new row vector from the given row index\n         * @param {number} index - Row index\n         * @return {Matrix}\n         */\n        getRowVector(index) {\n            return this.constructor.rowVector(this.getRow(index));\n        }\n\n        /**\n         * Sets a row at the given index\n         * @param {number} index - Row index\n         * @param {Array|Matrix} array - Array or vector\n         * @return {Matrix} this\n         */\n        setRow(index, array) {\n            util.checkRowIndex(this, index);\n            array = util.checkRowVector(this, array);\n            for (var i = 0; i < this.columns; i++) {\n                this.set(index, i, array[i]);\n            }\n            return this;\n        }\n\n        /**\n         * Swaps two rows\n         * @param {number} row1 - First row index\n         * @param {number} row2 - Second row index\n         * @return {Matrix} this\n         */\n        swapRows(row1, row2) {\n            util.checkRowIndex(this, row1);\n            util.checkRowIndex(this, row2);\n            for (var i = 0; i < this.columns; i++) {\n                var temp = this.get(row1, i);\n                this.set(row1, i, this.get(row2, i));\n                this.set(row2, i, temp);\n            }\n            return this;\n        }\n\n        /**\n         * Returns a new array from the given column index\n         * @param {number} index - Column index\n         * @return {Array}\n         */\n        getColumn(index) {\n            util.checkColumnIndex(this, index);\n            var column = new Array(this.rows);\n            for (var i = 0; i < this.rows; i++) {\n                column[i] = this.get(i, index);\n            }\n            return column;\n        }\n\n        /**\n         * Returns a new column vector from the given column index\n         * @param {number} index - Column index\n         * @return {Matrix}\n         */\n        getColumnVector(index) {\n            return this.constructor.columnVector(this.getColumn(index));\n        }\n\n        /**\n         * Sets a column at the given index\n         * @param {number} index - Column index\n         * @param {Array|Matrix} array - Array or vector\n         * @return {Matrix} this\n         */\n        setColumn(index, array) {\n            util.checkColumnIndex(this, index);\n            array = util.checkColumnVector(this, array);\n            for (var i = 0; i < this.rows; i++) {\n                this.set(i, index, array[i]);\n            }\n            return this;\n        }\n\n        /**\n         * Swaps two columns\n         * @param {number} column1 - First column index\n         * @param {number} column2 - Second column index\n         * @return {Matrix} this\n         */\n        swapColumns(column1, column2) {\n            util.checkColumnIndex(this, column1);\n            util.checkColumnIndex(this, column2);\n            for (var i = 0; i < this.rows; i++) {\n                var temp = this.get(i, column1);\n                this.set(i, column1, this.get(i, column2));\n                this.set(i, column2, temp);\n            }\n            return this;\n        }\n\n        /**\n         * Adds the values of a vector to each row\n         * @param {Array|Matrix} vector - Array or vector\n         * @return {Matrix} this\n         */\n        addRowVector(vector) {\n            vector = util.checkRowVector(this, vector);\n            for (var i = 0; i < this.rows; i++) {\n                for (var j = 0; j < this.columns; j++) {\n                    this.set(i, j, this.get(i, j) + vector[j]);\n                }\n            }\n            return this;\n        }\n\n        /**\n         * Subtracts the values of a vector from each row\n         * @param {Array|Matrix} vector - Array or vector\n         * @return {Matrix} this\n         */\n        subRowVector(vector) {\n            vector = util.checkRowVector(this, vector);\n            for (var i = 0; i < this.rows; i++) {\n                for (var j = 0; j < this.columns; j++) {\n                    this.set(i, j, this.get(i, j) - vector[j]);\n                }\n            }\n            return this;\n        }\n\n        /**\n         * Multiplies the values of a vector with each row\n         * @param {Array|Matrix} vector - Array or vector\n         * @return {Matrix} this\n         */\n        mulRowVector(vector) {\n            vector = util.checkRowVector(this, vector);\n            for (var i = 0; i < this.rows; i++) {\n                for (var j = 0; j < this.columns; j++) {\n                    this.set(i, j, this.get(i, j) * vector[j]);\n                }\n            }\n            return this;\n        }\n\n        /**\n         * Divides the values of each row by those of a vector\n         * @param {Array|Matrix} vector - Array or vector\n         * @return {Matrix} this\n         */\n        divRowVector(vector) {\n            vector = util.checkRowVector(this, vector);\n            for (var i = 0; i < this.rows; i++) {\n                for (var j = 0; j < this.columns; j++) {\n                    this.set(i, j, this.get(i, j) / vector[j]);\n                }\n            }\n            return this;\n        }\n\n        /**\n         * Adds the values of a vector to each column\n         * @param {Array|Matrix} vector - Array or vector\n         * @return {Matrix} this\n         */\n        addColumnVector(vector) {\n            vector = util.checkColumnVector(this, vector);\n            for (var i = 0; i < this.rows; i++) {\n                for (var j = 0; j < this.columns; j++) {\n                    this.set(i, j, this.get(i, j) + vector[i]);\n                }\n            }\n            return this;\n        }\n\n        /**\n         * Subtracts the values of a vector from each column\n         * @param {Array|Matrix} vector - Array or vector\n         * @return {Matrix} this\n         */\n        subColumnVector(vector) {\n            vector = util.checkColumnVector(this, vector);\n            for (var i = 0; i < this.rows; i++) {\n                for (var j = 0; j < this.columns; j++) {\n                    this.set(i, j, this.get(i, j) - vector[i]);\n                }\n            }\n            return this;\n        }\n\n        /**\n         * Multiplies the values of a vector with each column\n         * @param {Array|Matrix} vector - Array or vector\n         * @return {Matrix} this\n         */\n        mulColumnVector(vector) {\n            vector = util.checkColumnVector(this, vector);\n            for (var i = 0; i < this.rows; i++) {\n                for (var j = 0; j < this.columns; j++) {\n                    this.set(i, j, this.get(i, j) * vector[i]);\n                }\n            }\n            return this;\n        }\n\n        /**\n         * Divides the values of each column by those of a vector\n         * @param {Array|Matrix} vector - Array or vector\n         * @return {Matrix} this\n         */\n        divColumnVector(vector) {\n            vector = util.checkColumnVector(this, vector);\n            for (var i = 0; i < this.rows; i++) {\n                for (var j = 0; j < this.columns; j++) {\n                    this.set(i, j, this.get(i, j) / vector[i]);\n                }\n            }\n            return this;\n        }\n\n        /**\n         * Multiplies the values of a row with a scalar\n         * @param {number} index - Row index\n         * @param {number} value\n         * @return {Matrix} this\n         */\n        mulRow(index, value) {\n            util.checkRowIndex(this, index);\n            for (var i = 0; i < this.columns; i++) {\n                this.set(index, i, this.get(index, i) * value);\n            }\n            return this;\n        }\n\n        /**\n         * Multiplies the values of a column with a scalar\n         * @param {number} index - Column index\n         * @param {number} value\n         * @return {Matrix} this\n         */\n        mulColumn(index, value) {\n            util.checkColumnIndex(this, index);\n            for (var i = 0; i < this.rows; i++) {\n                this.set(i, index, this.get(i, index) * value);\n            }\n            return this;\n        }\n\n        /**\n         * Returns the maximum value of the matrix\n         * @return {number}\n         */\n        max() {\n            var v = this.get(0, 0);\n            for (var i = 0; i < this.rows; i++) {\n                for (var j = 0; j < this.columns; j++) {\n                    if (this.get(i, j) > v) {\n                        v = this.get(i, j);\n                    }\n                }\n            }\n            return v;\n        }\n\n        /**\n         * Returns the index of the maximum value\n         * @return {Array}\n         */\n        maxIndex() {\n            var v = this.get(0, 0);\n            var idx = [0, 0];\n            for (var i = 0; i < this.rows; i++) {\n                for (var j = 0; j < this.columns; j++) {\n                    if (this.get(i, j) > v) {\n                        v = this.get(i, j);\n                        idx[0] = i;\n                        idx[1] = j;\n                    }\n                }\n            }\n            return idx;\n        }\n\n        /**\n         * Returns the minimum value of the matrix\n         * @return {number}\n         */\n        min() {\n            var v = this.get(0, 0);\n            for (var i = 0; i < this.rows; i++) {\n                for (var j = 0; j < this.columns; j++) {\n                    if (this.get(i, j) < v) {\n                        v = this.get(i, j);\n                    }\n                }\n            }\n            return v;\n        }\n\n        /**\n         * Returns the index of the minimum value\n         * @return {Array}\n         */\n        minIndex() {\n            var v = this.get(0, 0);\n            var idx = [0, 0];\n            for (var i = 0; i < this.rows; i++) {\n                for (var j = 0; j < this.columns; j++) {\n                    if (this.get(i, j) < v) {\n                        v = this.get(i, j);\n                        idx[0] = i;\n                        idx[1] = j;\n                    }\n                }\n            }\n            return idx;\n        }\n\n        /**\n         * Returns the maximum value of one row\n         * @param {number} row - Row index\n         * @return {number}\n         */\n        maxRow(row) {\n            util.checkRowIndex(this, row);\n            var v = this.get(row, 0);\n            for (var i = 1; i < this.columns; i++) {\n                if (this.get(row, i) > v) {\n                    v = this.get(row, i);\n                }\n            }\n            return v;\n        }\n\n        /**\n         * Returns the index of the maximum value of one row\n         * @param {number} row - Row index\n         * @return {Array}\n         */\n        maxRowIndex(row) {\n            util.checkRowIndex(this, row);\n            var v = this.get(row, 0);\n            var idx = [row, 0];\n            for (var i = 1; i < this.columns; i++) {\n                if (this.get(row, i) > v) {\n                    v = this.get(row, i);\n                    idx[1] = i;\n                }\n            }\n            return idx;\n        }\n\n        /**\n         * Returns the minimum value of one row\n         * @param {number} row - Row index\n         * @return {number}\n         */\n        minRow(row) {\n            util.checkRowIndex(this, row);\n            var v = this.get(row, 0);\n            for (var i = 1; i < this.columns; i++) {\n                if (this.get(row, i) < v) {\n                    v = this.get(row, i);\n                }\n            }\n            return v;\n        }\n\n        /**\n         * Returns the index of the maximum value of one row\n         * @param {number} row - Row index\n         * @return {Array}\n         */\n        minRowIndex(row) {\n            util.checkRowIndex(this, row);\n            var v = this.get(row, 0);\n            var idx = [row, 0];\n            for (var i = 1; i < this.columns; i++) {\n                if (this.get(row, i) < v) {\n                    v = this.get(row, i);\n                    idx[1] = i;\n                }\n            }\n            return idx;\n        }\n\n        /**\n         * Returns the maximum value of one column\n         * @param {number} column - Column index\n         * @return {number}\n         */\n        maxColumn(column) {\n            util.checkColumnIndex(this, column);\n            var v = this.get(0, column);\n            for (var i = 1; i < this.rows; i++) {\n                if (this.get(i, column) > v) {\n                    v = this.get(i, column);\n                }\n            }\n            return v;\n        }\n\n        /**\n         * Returns the index of the maximum value of one column\n         * @param {number} column - Column index\n         * @return {Array}\n         */\n        maxColumnIndex(column) {\n            util.checkColumnIndex(this, column);\n            var v = this.get(0, column);\n            var idx = [0, column];\n            for (var i = 1; i < this.rows; i++) {\n                if (this.get(i, column) > v) {\n                    v = this.get(i, column);\n                    idx[0] = i;\n                }\n            }\n            return idx;\n        }\n\n        /**\n         * Returns the minimum value of one column\n         * @param {number} column - Column index\n         * @return {number}\n         */\n        minColumn(column) {\n            util.checkColumnIndex(this, column);\n            var v = this.get(0, column);\n            for (var i = 1; i < this.rows; i++) {\n                if (this.get(i, column) < v) {\n                    v = this.get(i, column);\n                }\n            }\n            return v;\n        }\n\n        /**\n         * Returns the index of the minimum value of one column\n         * @param {number} column - Column index\n         * @return {Array}\n         */\n        minColumnIndex(column) {\n            util.checkColumnIndex(this, column);\n            var v = this.get(0, column);\n            var idx = [0, column];\n            for (var i = 1; i < this.rows; i++) {\n                if (this.get(i, column) < v) {\n                    v = this.get(i, column);\n                    idx[0] = i;\n                }\n            }\n            return idx;\n        }\n\n        /**\n         * Returns an array containing the diagonal values of the matrix\n         * @return {Array}\n         */\n        diag() {\n            var min = Math.min(this.rows, this.columns);\n            var diag = new Array(min);\n            for (var i = 0; i < min; i++) {\n                diag[i] = this.get(i, i);\n            }\n            return diag;\n        }\n\n        /**\n         * Returns the sum by the argument given, if no argument given,\n         * it returns the sum of all elements of the matrix.\n         * @param {string} by - sum by 'row' or 'column'.\n         * @return {Matrix|number}\n         */\n        sum(by) {\n            switch (by) {\n                case 'row':\n                    return util.sumByRow(this);\n                case 'column':\n                    return util.sumByColumn(this);\n                default:\n                    return util.sumAll(this);\n            }\n        }\n\n        /**\n         * Returns the mean of all elements of the matrix\n         * @return {number}\n         */\n        mean() {\n            return this.sum() / this.size;\n        }\n\n        /**\n         * Returns the product of all elements of the matrix\n         * @return {number}\n         */\n        prod() {\n            var prod = 1;\n            for (var i = 0; i < this.rows; i++) {\n                for (var j = 0; j < this.columns; j++) {\n                    prod *= this.get(i, j);\n                }\n            }\n            return prod;\n        }\n\n        /**\n         * Computes the cumulative sum of the matrix elements (in place, row by row)\n         * @return {Matrix} this\n         */\n        cumulativeSum() {\n            var sum = 0;\n            for (var i = 0; i < this.rows; i++) {\n                for (var j = 0; j < this.columns; j++) {\n                    sum += this.get(i, j);\n                    this.set(i, j, sum);\n                }\n            }\n            return this;\n        }\n\n        /**\n         * Computes the dot (scalar) product between the matrix and another\n         * @param {Matrix} vector2 vector\n         * @return {number}\n         */\n        dot(vector2) {\n            if (Matrix.isMatrix(vector2)) vector2 = vector2.to1DArray();\n            var vector1 = this.to1DArray();\n            if (vector1.length !== vector2.length) {\n                throw new RangeError('vectors do not have the same size');\n            }\n            var dot = 0;\n            for (var i = 0; i < vector1.length; i++) {\n                dot += vector1[i] * vector2[i];\n            }\n            return dot;\n        }\n\n        /**\n         * Returns the matrix product between this and other\n         * @param {Matrix} other\n         * @return {Matrix}\n         */\n        mmul(other) {\n            other = this.constructor.checkMatrix(other);\n            if (this.columns !== other.rows) {\n                // eslint-disable-next-line no-console\n                console.warn('Number of columns of left matrix are not equal to number of rows of right matrix.');\n            }\n\n            var m = this.rows;\n            var n = this.columns;\n            var p = other.columns;\n\n            var result = new this.constructor[Symbol.species](m, p);\n\n            var Bcolj = new Array(n);\n            for (var j = 0; j < p; j++) {\n                for (var k = 0; k < n; k++) {\n                    Bcolj[k] = other.get(k, j);\n                }\n\n                for (var i = 0; i < m; i++) {\n                    var s = 0;\n                    for (k = 0; k < n; k++) {\n                        s += this.get(i, k) * Bcolj[k];\n                    }\n\n                    result.set(i, j, s);\n                }\n            }\n            return result;\n        }\n\n        strassen2x2(other) {\n            var result = new this.constructor[Symbol.species](2, 2);\n            const a11 = this.get(0, 0);\n            const b11 = other.get(0, 0);\n            const a12 = this.get(0, 1);\n            const b12 = other.get(0, 1);\n            const a21 = this.get(1, 0);\n            const b21 = other.get(1, 0);\n            const a22 = this.get(1, 1);\n            const b22 = other.get(1, 1);\n\n            // Compute intermediate values.\n            const m1 = (a11 + a22) * (b11 + b22);\n            const m2 = (a21 + a22) * b11;\n            const m3 = a11 * (b12 - b22);\n            const m4 = a22 * (b21 - b11);\n            const m5 = (a11 + a12) * b22;\n            const m6 = (a21 - a11) * (b11 + b12);\n            const m7 = (a12 - a22) * (b21 + b22);\n\n            // Combine intermediate values into the output.\n            const c00 = m1 + m4 - m5 + m7;\n            const c01 = m3 + m5;\n            const c10 = m2 + m4;\n            const c11 = m1 - m2 + m3 + m6;\n\n            result.set(0, 0, c00);\n            result.set(0, 1, c01);\n            result.set(1, 0, c10);\n            result.set(1, 1, c11);\n            return result;\n        }\n\n        strassen3x3(other) {\n            var result = new this.constructor[Symbol.species](3, 3);\n\n            const a00 = this.get(0, 0);\n            const a01 = this.get(0, 1);\n            const a02 = this.get(0, 2);\n            const a10 = this.get(1, 0);\n            const a11 = this.get(1, 1);\n            const a12 = this.get(1, 2);\n            const a20 = this.get(2, 0);\n            const a21 = this.get(2, 1);\n            const a22 = this.get(2, 2);\n\n            const b00 = other.get(0, 0);\n            const b01 = other.get(0, 1);\n            const b02 = other.get(0, 2);\n            const b10 = other.get(1, 0);\n            const b11 = other.get(1, 1);\n            const b12 = other.get(1, 2);\n            const b20 = other.get(2, 0);\n            const b21 = other.get(2, 1);\n            const b22 = other.get(2, 2);\n\n            const m1 = (a00 + a01 + a02 - a10 - a11 - a21 - a22) * b11;\n            const m2 = (a00 - a10) * (-b01 + b11);\n            const m3 = a11 * (-b00 + b01 + b10 - b11 - b12 - b20 + b22);\n            const m4 = (-a00 + a10 + a11) * (b00 - b01 + b11);\n            const m5 = (a10 + a11) * (-b00 + b01);\n            const m6 = a00 * b00;\n            const m7 = (-a00 + a20 + a21) * (b00 - b02 + b12);\n            const m8 = (-a00 + a20) * (b02 - b12);\n            const m9 = (a20 + a21) * (-b00 + b02);\n            const m10 = (a00 + a01 + a02 - a11 - a12 - a20 - a21) * b12;\n            const m11 = a21 * (-b00 + b02 + b10 - b11 - b12 - b20 + b21);\n            const m12 = (-a02 + a21 + a22) * (b11 + b20 - b21);\n            const m13 = (a02 - a22) * (b11 - b21);\n            const m14 = a02 * b20;\n            const m15 = (a21 + a22) * (-b20 + b21);\n            const m16 = (-a02 + a11 + a12) * (b12 + b20 - b22);\n            const m17 = (a02 - a12) * (b12 - b22);\n            const m18 = (a11 + a12) * (-b20 + b22);\n            const m19 = a01 * b10;\n            const m20 = a12 * b21;\n            const m21 = a10 * b02;\n            const m22 = a20 * b01;\n            const m23 = a22 * b22;\n\n            const c00 = m6 + m14 + m19;\n            const c01 = m1 + m4 + m5 + m6 + m12 + m14 + m15;\n            const c02 = m6 + m7 + m9 + m10 + m14 + m16 + m18;\n            const c10 = m2 + m3 + m4 + m6 + m14 + m16 + m17;\n            const c11 = m2 + m4 + m5 + m6 + m20;\n            const c12 = m14 + m16 + m17 + m18 + m21;\n            const c20 = m6 + m7 + m8 + m11 + m12 + m13 + m14;\n            const c21 = m12 + m13 + m14 + m15 + m22;\n            const c22 = m6 + m7 + m8 + m9 + m23;\n\n            result.set(0, 0, c00);\n            result.set(0, 1, c01);\n            result.set(0, 2, c02);\n            result.set(1, 0, c10);\n            result.set(1, 1, c11);\n            result.set(1, 2, c12);\n            result.set(2, 0, c20);\n            result.set(2, 1, c21);\n            result.set(2, 2, c22);\n            return result;\n        }\n\n        /**\n         * Returns the matrix product between x and y. More efficient than mmul(other) only when we multiply squared matrix and when the size of the matrix is > 1000.\n         * @param {Matrix} y\n         * @return {Matrix}\n         */\n        mmulStrassen(y) {\n            var x = this.clone();\n            var r1 = x.rows;\n            var c1 = x.columns;\n            var r2 = y.rows;\n            var c2 = y.columns;\n            if (c1 !== r2) {\n                // eslint-disable-next-line no-console\n                console.warn(`Multiplying ${r1} x ${c1} and ${r2} x ${c2} matrix: dimensions do not match.`);\n            }\n\n            // Put a matrix into the top left of a matrix of zeros.\n            // `rows` and `cols` are the dimensions of the output matrix.\n            function embed(mat, rows, cols) {\n                var r = mat.rows;\n                var c = mat.columns;\n                if ((r === rows) && (c === cols)) {\n                    return mat;\n                } else {\n                    var resultat = Matrix.zeros(rows, cols);\n                    resultat = resultat.setSubMatrix(mat, 0, 0);\n                    return resultat;\n                }\n            }\n\n\n            // Make sure both matrices are the same size.\n            // This is exclusively for simplicity:\n            // this algorithm can be implemented with matrices of different sizes.\n\n            var r = Math.max(r1, r2);\n            var c = Math.max(c1, c2);\n            x = embed(x, r, c);\n            y = embed(y, r, c);\n\n            // Our recursive multiplication function.\n            function blockMult(a, b, rows, cols) {\n                // For small matrices, resort to naive multiplication.\n                if (rows <= 512 || cols <= 512) {\n                    return a.mmul(b); // a is equivalent to this\n                }\n\n                // Apply dynamic padding.\n                if ((rows % 2 === 1) && (cols % 2 === 1)) {\n                    a = embed(a, rows + 1, cols + 1);\n                    b = embed(b, rows + 1, cols + 1);\n                } else if (rows % 2 === 1) {\n                    a = embed(a, rows + 1, cols);\n                    b = embed(b, rows + 1, cols);\n                } else if (cols % 2 === 1) {\n                    a = embed(a, rows, cols + 1);\n                    b = embed(b, rows, cols + 1);\n                }\n\n                var halfRows = parseInt(a.rows / 2);\n                var halfCols = parseInt(a.columns / 2);\n                // Subdivide input matrices.\n                var a11 = a.subMatrix(0, halfRows - 1, 0, halfCols - 1);\n                var b11 = b.subMatrix(0, halfRows - 1, 0, halfCols - 1);\n\n                var a12 = a.subMatrix(0, halfRows - 1, halfCols, a.columns - 1);\n                var b12 = b.subMatrix(0, halfRows - 1, halfCols, b.columns - 1);\n\n                var a21 = a.subMatrix(halfRows, a.rows - 1, 0, halfCols - 1);\n                var b21 = b.subMatrix(halfRows, b.rows - 1, 0, halfCols - 1);\n\n                var a22 = a.subMatrix(halfRows, a.rows - 1, halfCols, a.columns - 1);\n                var b22 = b.subMatrix(halfRows, b.rows - 1, halfCols, b.columns - 1);\n\n                // Compute intermediate values.\n                var m1 = blockMult(Matrix.add(a11, a22), Matrix.add(b11, b22), halfRows, halfCols);\n                var m2 = blockMult(Matrix.add(a21, a22), b11, halfRows, halfCols);\n                var m3 = blockMult(a11, Matrix.sub(b12, b22), halfRows, halfCols);\n                var m4 = blockMult(a22, Matrix.sub(b21, b11), halfRows, halfCols);\n                var m5 = blockMult(Matrix.add(a11, a12), b22, halfRows, halfCols);\n                var m6 = blockMult(Matrix.sub(a21, a11), Matrix.add(b11, b12), halfRows, halfCols);\n                var m7 = blockMult(Matrix.sub(a12, a22), Matrix.add(b21, b22), halfRows, halfCols);\n\n                // Combine intermediate values into the output.\n                var c11 = Matrix.add(m1, m4);\n                c11.sub(m5);\n                c11.add(m7);\n                var c12 = Matrix.add(m3, m5);\n                var c21 = Matrix.add(m2, m4);\n                var c22 = Matrix.sub(m1, m2);\n                c22.add(m3);\n                c22.add(m6);\n\n                //Crop output to the desired size (undo dynamic padding).\n                var resultat = Matrix.zeros(2 * c11.rows, 2 * c11.columns);\n                resultat = resultat.setSubMatrix(c11, 0, 0);\n                resultat = resultat.setSubMatrix(c12, c11.rows, 0);\n                resultat = resultat.setSubMatrix(c21, 0, c11.columns);\n                resultat = resultat.setSubMatrix(c22, c11.rows, c11.columns);\n                return resultat.subMatrix(0, rows - 1, 0, cols - 1);\n            }\n            return blockMult(x, y, r, c);\n        }\n\n        /**\n         * Returns a row-by-row scaled matrix\n         * @param {number} [min=0] - Minimum scaled value\n         * @param {number} [max=1] - Maximum scaled value\n         * @return {Matrix} - The scaled matrix\n         */\n        scaleRows(min, max) {\n            min = min === undefined ? 0 : min;\n            max = max === undefined ? 1 : max;\n            if (min >= max) {\n                throw new RangeError('min should be strictly smaller than max');\n            }\n            var newMatrix = this.constructor.empty(this.rows, this.columns);\n            for (var i = 0; i < this.rows; i++) {\n                var scaled = arrayUtils.scale(this.getRow(i), {min, max});\n                newMatrix.setRow(i, scaled);\n            }\n            return newMatrix;\n        }\n\n        /**\n         * Returns a new column-by-column scaled matrix\n         * @param {number} [min=0] - Minimum scaled value\n         * @param {number} [max=1] - Maximum scaled value\n         * @return {Matrix} - The new scaled matrix\n         * @example\n         * var matrix = new Matrix([[1,2],[-1,0]]);\n         * var scaledMatrix = matrix.scaleColumns(); // [[1,1],[0,0]]\n         */\n        scaleColumns(min, max) {\n            min = min === undefined ? 0 : min;\n            max = max === undefined ? 1 : max;\n            if (min >= max) {\n                throw new RangeError('min should be strictly smaller than max');\n            }\n            var newMatrix = this.constructor.empty(this.rows, this.columns);\n            for (var i = 0; i < this.columns; i++) {\n                var scaled = arrayUtils.scale(this.getColumn(i), {\n                    min: min,\n                    max: max\n                });\n                newMatrix.setColumn(i, scaled);\n            }\n            return newMatrix;\n        }\n\n\n        /**\n         * Returns the Kronecker product (also known as tensor product) between this and other\n         * See https://en.wikipedia.org/wiki/Kronecker_product\n         * @param {Matrix} other\n         * @return {Matrix}\n         */\n        kroneckerProduct(other) {\n            other = this.constructor.checkMatrix(other);\n\n            var m = this.rows;\n            var n = this.columns;\n            var p = other.rows;\n            var q = other.columns;\n\n            var result = new this.constructor[Symbol.species](m * p, n * q);\n            for (var i = 0; i < m; i++) {\n                for (var j = 0; j < n; j++) {\n                    for (var k = 0; k < p; k++) {\n                        for (var l = 0; l < q; l++) {\n                            result[p * i + k][q * j + l] = this.get(i, j) * other.get(k, l);\n                        }\n                    }\n                }\n            }\n            return result;\n        }\n\n        /**\n         * Transposes the matrix and returns a new one containing the result\n         * @return {Matrix}\n         */\n        transpose() {\n            var result = new this.constructor[Symbol.species](this.columns, this.rows);\n            for (var i = 0; i < this.rows; i++) {\n                for (var j = 0; j < this.columns; j++) {\n                    result.set(j, i, this.get(i, j));\n                }\n            }\n            return result;\n        }\n\n        /**\n         * Sorts the rows (in place)\n         * @param {function} compareFunction - usual Array.prototype.sort comparison function\n         * @return {Matrix} this\n         */\n        sortRows(compareFunction) {\n            if (compareFunction === undefined) compareFunction = compareNumbers;\n            for (var i = 0; i < this.rows; i++) {\n                this.setRow(i, this.getRow(i).sort(compareFunction));\n            }\n            return this;\n        }\n\n        /**\n         * Sorts the columns (in place)\n         * @param {function} compareFunction - usual Array.prototype.sort comparison function\n         * @return {Matrix} this\n         */\n        sortColumns(compareFunction) {\n            if (compareFunction === undefined) compareFunction = compareNumbers;\n            for (var i = 0; i < this.columns; i++) {\n                this.setColumn(i, this.getColumn(i).sort(compareFunction));\n            }\n            return this;\n        }\n\n        /**\n         * Returns a subset of the matrix\n         * @param {number} startRow - First row index\n         * @param {number} endRow - Last row index\n         * @param {number} startColumn - First column index\n         * @param {number} endColumn - Last column index\n         * @return {Matrix}\n         */\n        subMatrix(startRow, endRow, startColumn, endColumn) {\n            util.checkRange(this, startRow, endRow, startColumn, endColumn);\n            var newMatrix = new this.constructor[Symbol.species](endRow - startRow + 1, endColumn - startColumn + 1);\n            for (var i = startRow; i <= endRow; i++) {\n                for (var j = startColumn; j <= endColumn; j++) {\n                    newMatrix[i - startRow][j - startColumn] = this.get(i, j);\n                }\n            }\n            return newMatrix;\n        }\n\n        /**\n         * Returns a subset of the matrix based on an array of row indices\n         * @param {Array} indices - Array containing the row indices\n         * @param {number} [startColumn = 0] - First column index\n         * @param {number} [endColumn = this.columns-1] - Last column index\n         * @return {Matrix}\n         */\n        subMatrixRow(indices, startColumn, endColumn) {\n            if (startColumn === undefined) startColumn = 0;\n            if (endColumn === undefined) endColumn = this.columns - 1;\n            if ((startColumn > endColumn) || (startColumn < 0) || (startColumn >= this.columns) || (endColumn < 0) || (endColumn >= this.columns)) {\n                throw new RangeError('Argument out of range');\n            }\n\n            var newMatrix = new this.constructor[Symbol.species](indices.length, endColumn - startColumn + 1);\n            for (var i = 0; i < indices.length; i++) {\n                for (var j = startColumn; j <= endColumn; j++) {\n                    if (indices[i] < 0 || indices[i] >= this.rows) {\n                        throw new RangeError('Row index out of range: ' + indices[i]);\n                    }\n                    newMatrix.set(i, j - startColumn, this.get(indices[i], j));\n                }\n            }\n            return newMatrix;\n        }\n\n        /**\n         * Returns a subset of the matrix based on an array of column indices\n         * @param {Array} indices - Array containing the column indices\n         * @param {number} [startRow = 0] - First row index\n         * @param {number} [endRow = this.rows-1] - Last row index\n         * @return {Matrix}\n         */\n        subMatrixColumn(indices, startRow, endRow) {\n            if (startRow === undefined) startRow = 0;\n            if (endRow === undefined) endRow = this.rows - 1;\n            if ((startRow > endRow) || (startRow < 0) || (startRow >= this.rows) || (endRow < 0) || (endRow >= this.rows)) {\n                throw new RangeError('Argument out of range');\n            }\n\n            var newMatrix = new this.constructor[Symbol.species](endRow - startRow + 1, indices.length);\n            for (var i = 0; i < indices.length; i++) {\n                for (var j = startRow; j <= endRow; j++) {\n                    if (indices[i] < 0 || indices[i] >= this.columns) {\n                        throw new RangeError('Column index out of range: ' + indices[i]);\n                    }\n                    newMatrix.set(j - startRow, i, this.get(j, indices[i]));\n                }\n            }\n            return newMatrix;\n        }\n\n        /**\n         * Set a part of the matrix to the given sub-matrix\n         * @param {Matrix|Array< Array >} matrix - The source matrix from which to extract values.\n         * @param {number} startRow - The index of the first row to set\n         * @param {number} startColumn - The index of the first column to set\n         * @return {Matrix}\n         */\n        setSubMatrix(matrix, startRow, startColumn) {\n            matrix = this.constructor.checkMatrix(matrix);\n            var endRow = startRow + matrix.rows - 1;\n            var endColumn = startColumn + matrix.columns - 1;\n            util.checkRange(this, startRow, endRow, startColumn, endColumn);\n            for (var i = 0; i < matrix.rows; i++) {\n                for (var j = 0; j < matrix.columns; j++) {\n                    this[startRow + i][startColumn + j] = matrix.get(i, j);\n                }\n            }\n            return this;\n        }\n\n        /**\n         * Return a new matrix based on a selection of rows and columns\n         * @param {Array<number>} rowIndices - The row indices to select. Order matters and an index can be more than once.\n         * @param {Array<number>} columnIndices - The column indices to select. Order matters and an index can be use more than once.\n         * @return {Matrix} The new matrix\n         */\n        selection(rowIndices, columnIndices) {\n            var indices = util.checkIndices(this, rowIndices, columnIndices);\n            var newMatrix = new this.constructor[Symbol.species](rowIndices.length, columnIndices.length);\n            for (var i = 0; i < indices.row.length; i++) {\n                var rowIndex = indices.row[i];\n                for (var j = 0; j < indices.column.length; j++) {\n                    var columnIndex = indices.column[j];\n                    newMatrix[i][j] = this.get(rowIndex, columnIndex);\n                }\n            }\n            return newMatrix;\n        }\n\n        /**\n         * Returns the trace of the matrix (sum of the diagonal elements)\n         * @return {number}\n         */\n        trace() {\n            var min = Math.min(this.rows, this.columns);\n            var trace = 0;\n            for (var i = 0; i < min; i++) {\n                trace += this.get(i, i);\n            }\n            return trace;\n        }\n\n        /*\n         Matrix views\n         */\n\n        /**\n         * Returns a view of the transposition of the matrix\n         * @return {MatrixTransposeView}\n         */\n        transposeView() {\n            return new MatrixTransposeView(this);\n        }\n\n        /**\n         * Returns a view of the row vector with the given index\n         * @param {number} row - row index of the vector\n         * @return {MatrixRowView}\n         */\n        rowView(row) {\n            util.checkRowIndex(this, row);\n            return new MatrixRowView(this, row);\n        }\n\n        /**\n         * Returns a view of the column vector with the given index\n         * @param {number} column - column index of the vector\n         * @return {MatrixColumnView}\n         */\n        columnView(column) {\n            util.checkColumnIndex(this, column);\n            return new MatrixColumnView(this, column);\n        }\n\n        /**\n         * Returns a view of the matrix flipped in the row axis\n         * @return {MatrixFlipRowView}\n         */\n        flipRowView() {\n            return new MatrixFlipRowView(this);\n        }\n\n        /**\n         * Returns a view of the matrix flipped in the column axis\n         * @return {MatrixFlipColumnView}\n         */\n        flipColumnView() {\n            return new MatrixFlipColumnView(this);\n        }\n\n        /**\n         * Returns a view of a submatrix giving the index boundaries\n         * @param {number} startRow - first row index of the submatrix\n         * @param {number} endRow - last row index of the submatrix\n         * @param {number} startColumn - first column index of the submatrix\n         * @param {number} endColumn - last column index of the submatrix\n         * @return {MatrixSubView}\n         */\n        subMatrixView(startRow, endRow, startColumn, endColumn) {\n            return new MatrixSubView(this, startRow, endRow, startColumn, endColumn);\n        }\n\n        /**\n         * Returns a view of the cross of the row indices and the column indices\n         * @example\n         * // resulting vector is [[2], [2]]\n         * var matrix = new Matrix([[1,2,3], [4,5,6]]).selectionView([0, 0], [1])\n         * @param {Array<number>} rowIndices\n         * @param {Array<number>} columnIndices\n         * @return {MatrixSelectionView}\n         */\n        selectionView(rowIndices, columnIndices) {\n            return new MatrixSelectionView(this, rowIndices, columnIndices);\n        }\n\n\n        /**\n        * Calculates and returns the determinant of a matrix as a Number\n        * @example\n        *   new Matrix([[1,2,3], [4,5,6]]).det()\n        * @return {number}\n        */\n        det() {\n            if (this.isSquare()) {\n                var a, b, c, d;\n                if (this.columns === 2) {\n                    // 2 x 2 matrix\n                    a = this.get(0, 0);\n                    b = this.get(0, 1);\n                    c = this.get(1, 0);\n                    d = this.get(1, 1);\n\n                    return a * d - (b * c);\n                } else if (this.columns === 3) {\n                    // 3 x 3 matrix\n                    var subMatrix0, subMatrix1, subMatrix2;\n                    subMatrix0 = this.selectionView([1, 2], [1, 2]);\n                    subMatrix1 = this.selectionView([1, 2], [0, 2]);\n                    subMatrix2 = this.selectionView([1, 2], [0, 1]);\n                    a = this.get(0, 0);\n                    b = this.get(0, 1);\n                    c = this.get(0, 2);\n\n                    return a * subMatrix0.det() - b * subMatrix1.det() + c * subMatrix2.det();\n                } else {\n                    // general purpose determinant using the LU decomposition\n                    return new LuDecomposition(this).determinant;\n                }\n\n            } else {\n                throw Error('Determinant can only be calculated for a square matrix.');\n            }\n        }\n\n        /**\n         * Returns inverse of a matrix if it exists or the pseudoinverse\n         * @param {number} threshold - threshold for taking inverse of singular values (default = 1e-15)\n         * @return {Matrix} the (pseudo)inverted matrix.\n         */\n        pseudoInverse(threshold) {\n            if (threshold === undefined) threshold = Number.EPSILON;\n            var svdSolution = new SvDecomposition(this, {autoTranspose: true});\n\n            var U = svdSolution.leftSingularVectors;\n            var V = svdSolution.rightSingularVectors;\n            var s = svdSolution.diagonal;\n\n            for (var i = 0; i < s.length; i++) {\n                if (Math.abs(s[i]) > threshold) {\n                    s[i] = 1.0 / s[i];\n                } else {\n                    s[i] = 0.0;\n                }\n            }\n\n            // convert list to diagonal\n            s = this.constructor[Symbol.species].diag(s);\n            return V.mmul(s.mmul(U.transposeView()));\n        }\n    }\n\n    Matrix.prototype.klass = 'Matrix';\n\n    /**\n     * @private\n     * Check that two matrices have the same dimensions\n     * @param {Matrix} matrix\n     * @param {Matrix} otherMatrix\n     */\n    function checkDimensions(matrix, otherMatrix) { // eslint-disable-line no-unused-vars\n        if (matrix.rows !== otherMatrix.rows ||\n            matrix.columns !== otherMatrix.columns) {\n            throw new RangeError('Matrices dimensions must be equal');\n        }\n    }\n\n    function compareNumbers(a, b) {\n        return a - b;\n    }\n\n    /*\n     Synonyms\n     */\n\n    Matrix.random = Matrix.rand;\n    Matrix.diagonal = Matrix.diag;\n    Matrix.prototype.diagonal = Matrix.prototype.diag;\n    Matrix.identity = Matrix.eye;\n    Matrix.prototype.negate = Matrix.prototype.neg;\n    Matrix.prototype.tensorProduct = Matrix.prototype.kroneckerProduct;\n    Matrix.prototype.determinant = Matrix.prototype.det;\n\n    /*\n     Add dynamically instance and static methods for mathematical operations\n     */\n\n    var inplaceOperator = `\n(function %name%(value) {\n    if (typeof value === 'number') return this.%name%S(value);\n    return this.%name%M(value);\n})\n`;\n\n    var inplaceOperatorScalar = `\n(function %name%S(value) {\n    for (var i = 0; i < this.rows; i++) {\n        for (var j = 0; j < this.columns; j++) {\n            this.set(i, j, this.get(i, j) %op% value);\n        }\n    }\n    return this;\n})\n`;\n\n    var inplaceOperatorMatrix = `\n(function %name%M(matrix) {\n    matrix = this.constructor.checkMatrix(matrix);\n    checkDimensions(this, matrix);\n    for (var i = 0; i < this.rows; i++) {\n        for (var j = 0; j < this.columns; j++) {\n            this.set(i, j, this.get(i, j) %op% matrix.get(i, j));\n        }\n    }\n    return this;\n})\n`;\n\n    var staticOperator = `\n(function %name%(matrix, value) {\n    var newMatrix = new this[Symbol.species](matrix);\n    return newMatrix.%name%(value);\n})\n`;\n\n    var inplaceMethod = `\n(function %name%() {\n    for (var i = 0; i < this.rows; i++) {\n        for (var j = 0; j < this.columns; j++) {\n            this.set(i, j, %method%(this.get(i, j)));\n        }\n    }\n    return this;\n})\n`;\n\n    var staticMethod = `\n(function %name%(matrix) {\n    var newMatrix = new this[Symbol.species](matrix);\n    return newMatrix.%name%();\n})\n`;\n\n    var inplaceMethodWithArgs = `\n(function %name%(%args%) {\n    for (var i = 0; i < this.rows; i++) {\n        for (var j = 0; j < this.columns; j++) {\n            this.set(i, j, %method%(this.get(i, j), %args%));\n        }\n    }\n    return this;\n})\n`;\n\n    var staticMethodWithArgs = `\n(function %name%(matrix, %args%) {\n    var newMatrix = new this[Symbol.species](matrix);\n    return newMatrix.%name%(%args%);\n})\n`;\n\n\n    var inplaceMethodWithOneArgScalar = `\n(function %name%S(value) {\n    for (var i = 0; i < this.rows; i++) {\n        for (var j = 0; j < this.columns; j++) {\n            this.set(i, j, %method%(this.get(i, j), value));\n        }\n    }\n    return this;\n})\n`;\n    var inplaceMethodWithOneArgMatrix = `\n(function %name%M(matrix) {\n    matrix = this.constructor.checkMatrix(matrix);\n    checkDimensions(this, matrix);\n    for (var i = 0; i < this.rows; i++) {\n        for (var j = 0; j < this.columns; j++) {\n            this.set(i, j, %method%(this.get(i, j), matrix.get(i, j)));\n        }\n    }\n    return this;\n})\n`;\n\n    var inplaceMethodWithOneArg = `\n(function %name%(value) {\n    if (typeof value === 'number') return this.%name%S(value);\n    return this.%name%M(value);\n})\n`;\n\n    var staticMethodWithOneArg = staticMethodWithArgs;\n\n    var operators = [\n        // Arithmetic operators\n        ['+', 'add'],\n        ['-', 'sub', 'subtract'],\n        ['*', 'mul', 'multiply'],\n        ['/', 'div', 'divide'],\n        ['%', 'mod', 'modulus'],\n        // Bitwise operators\n        ['&', 'and'],\n        ['|', 'or'],\n        ['^', 'xor'],\n        ['<<', 'leftShift'],\n        ['>>', 'signPropagatingRightShift'],\n        ['>>>', 'rightShift', 'zeroFillRightShift']\n    ];\n\n    var i;\n\n    for (var operator of operators) {\n        var inplaceOp = eval(fillTemplateFunction(inplaceOperator, {name: operator[1], op: operator[0]}));\n        var inplaceOpS = eval(fillTemplateFunction(inplaceOperatorScalar, {name: operator[1] + 'S', op: operator[0]}));\n        var inplaceOpM = eval(fillTemplateFunction(inplaceOperatorMatrix, {name: operator[1] + 'M', op: operator[0]}));\n        var staticOp = eval(fillTemplateFunction(staticOperator, {name: operator[1]}));\n        for (i = 1; i < operator.length; i++) {\n            Matrix.prototype[operator[i]] = inplaceOp;\n            Matrix.prototype[operator[i] + 'S'] = inplaceOpS;\n            Matrix.prototype[operator[i] + 'M'] = inplaceOpM;\n            Matrix[operator[i]] = staticOp;\n        }\n    }\n\n    var methods = [\n        ['~', 'not']\n    ];\n\n    [\n        'abs', 'acos', 'acosh', 'asin', 'asinh', 'atan', 'atanh', 'cbrt', 'ceil',\n        'clz32', 'cos', 'cosh', 'exp', 'expm1', 'floor', 'fround', 'log', 'log1p',\n        'log10', 'log2', 'round', 'sign', 'sin', 'sinh', 'sqrt', 'tan', 'tanh', 'trunc'\n    ].forEach(function (mathMethod) {\n        methods.push(['Math.' + mathMethod, mathMethod]);\n    });\n\n    for (var method of methods) {\n        var inplaceMeth = eval(fillTemplateFunction(inplaceMethod, {name: method[1], method: method[0]}));\n        var staticMeth = eval(fillTemplateFunction(staticMethod, {name: method[1]}));\n        for (i = 1; i < method.length; i++) {\n            Matrix.prototype[method[i]] = inplaceMeth;\n            Matrix[method[i]] = staticMeth;\n        }\n    }\n\n    var methodsWithArgs = [\n        ['Math.pow', 1, 'pow']\n    ];\n\n    for (var methodWithArg of methodsWithArgs) {\n        var args = 'arg0';\n        for (i = 1; i < methodWithArg[1]; i++) {\n            args += `, arg${i}`;\n        }\n        if (methodWithArg[1] !== 1) {\n            var inplaceMethWithArgs = eval(fillTemplateFunction(inplaceMethodWithArgs, {\n                name: methodWithArg[2],\n                method: methodWithArg[0],\n                args: args\n            }));\n            var staticMethWithArgs = eval(fillTemplateFunction(staticMethodWithArgs, {name: methodWithArg[2], args: args}));\n            for (i = 2; i < methodWithArg.length; i++) {\n                Matrix.prototype[methodWithArg[i]] = inplaceMethWithArgs;\n                Matrix[methodWithArg[i]] = staticMethWithArgs;\n            }\n        } else {\n            var tmplVar = {\n                name: methodWithArg[2],\n                args: args,\n                method: methodWithArg[0]\n            };\n            var inplaceMethod2 = eval(fillTemplateFunction(inplaceMethodWithOneArg, tmplVar));\n            var inplaceMethodS = eval(fillTemplateFunction(inplaceMethodWithOneArgScalar, tmplVar));\n            var inplaceMethodM = eval(fillTemplateFunction(inplaceMethodWithOneArgMatrix, tmplVar));\n            var staticMethod2 = eval(fillTemplateFunction(staticMethodWithOneArg, tmplVar));\n            for (i = 2; i < methodWithArg.length; i++) {\n                Matrix.prototype[methodWithArg[i]] = inplaceMethod2;\n                Matrix.prototype[methodWithArg[i] + 'M'] = inplaceMethodM;\n                Matrix.prototype[methodWithArg[i] + 'S'] = inplaceMethodS;\n                Matrix[methodWithArg[i]] = staticMethod2;\n            }\n        }\n    }\n\n    function fillTemplateFunction(template, values) {\n        for (var value in values) {\n            template = template.replace(new RegExp('%' + value + '%', 'g'), values[value]);\n        }\n        return template;\n    }\n\n    return Matrix;\n}\n","'use strict';\n\nvar Matrix = require('../matrix');\n\n// https://github.com/lutzroeder/Mapack/blob/master/Source/LuDecomposition.cs\nfunction LuDecomposition(matrix) {\n    if (!(this instanceof LuDecomposition)) {\n        return new LuDecomposition(matrix);\n    }\n\n    matrix = Matrix.Matrix.checkMatrix(matrix);\n\n    var lu = matrix.clone(),\n        rows = lu.rows,\n        columns = lu.columns,\n        pivotVector = new Array(rows),\n        pivotSign = 1,\n        i, j, k, p, s, t, v,\n        LUrowi, LUcolj, kmax;\n\n    for (i = 0; i < rows; i++) {\n        pivotVector[i] = i;\n    }\n\n    LUcolj = new Array(rows);\n\n    for (j = 0; j < columns; j++) {\n\n        for (i = 0; i < rows; i++) {\n            LUcolj[i] = lu[i][j];\n        }\n\n        for (i = 0; i < rows; i++) {\n            LUrowi = lu[i];\n            kmax = Math.min(i, j);\n            s = 0;\n            for (k = 0; k < kmax; k++) {\n                s += LUrowi[k] * LUcolj[k];\n            }\n            LUrowi[j] = LUcolj[i] -= s;\n        }\n\n        p = j;\n        for (i = j + 1; i < rows; i++) {\n            if (Math.abs(LUcolj[i]) > Math.abs(LUcolj[p])) {\n                p = i;\n            }\n        }\n\n        if (p !== j) {\n            for (k = 0; k < columns; k++) {\n                t = lu[p][k];\n                lu[p][k] = lu[j][k];\n                lu[j][k] = t;\n            }\n\n            v = pivotVector[p];\n            pivotVector[p] = pivotVector[j];\n            pivotVector[j] = v;\n\n            pivotSign = -pivotSign;\n        }\n\n        if (j < rows && lu[j][j] !== 0) {\n            for (i = j + 1; i < rows; i++) {\n                lu[i][j] /= lu[j][j];\n            }\n        }\n    }\n\n    this.LU = lu;\n    this.pivotVector = pivotVector;\n    this.pivotSign = pivotSign;\n}\n\nLuDecomposition.prototype = {\n    isSingular: function () {\n        var data = this.LU,\n            col = data.columns;\n        for (var j = 0; j < col; j++) {\n            if (data[j][j] === 0) {\n                return true;\n            }\n        }\n        return false;\n    },\n    get determinant() {\n        var data = this.LU;\n        if (!data.isSquare()) {\n            throw new Error('Matrix must be square');\n        }\n        var determinant = this.pivotSign, col = data.columns;\n        for (var j = 0; j < col; j++) {\n            determinant *= data[j][j];\n        }\n        return determinant;\n    },\n    get lowerTriangularMatrix() {\n        var data = this.LU,\n            rows = data.rows,\n            columns = data.columns,\n            X = new Matrix.Matrix(rows, columns);\n        for (var i = 0; i < rows; i++) {\n            for (var j = 0; j < columns; j++) {\n                if (i > j) {\n                    X[i][j] = data[i][j];\n                } else if (i === j) {\n                    X[i][j] = 1;\n                } else {\n                    X[i][j] = 0;\n                }\n            }\n        }\n        return X;\n    },\n    get upperTriangularMatrix() {\n        var data = this.LU,\n            rows = data.rows,\n            columns = data.columns,\n            X = new Matrix.Matrix(rows, columns);\n        for (var i = 0; i < rows; i++) {\n            for (var j = 0; j < columns; j++) {\n                if (i <= j) {\n                    X[i][j] = data[i][j];\n                } else {\n                    X[i][j] = 0;\n                }\n            }\n        }\n        return X;\n    },\n    get pivotPermutationVector() {\n        return this.pivotVector.slice();\n    },\n    solve: function (value) {\n        value = Matrix.Matrix.checkMatrix(value);\n\n        var lu = this.LU,\n            rows = lu.rows;\n\n        if (rows !== value.rows) {\n            throw new Error('Invalid matrix dimensions');\n        }\n        if (this.isSingular()) {\n            throw new Error('LU matrix is singular');\n        }\n\n        var count = value.columns;\n        var X = value.subMatrixRow(this.pivotVector, 0, count - 1);\n        var columns = lu.columns;\n        var i, j, k;\n\n        for (k = 0; k < columns; k++) {\n            for (i = k + 1; i < columns; i++) {\n                for (j = 0; j < count; j++) {\n                    X[i][j] -= X[k][j] * lu[i][k];\n                }\n            }\n        }\n        for (k = columns - 1; k >= 0; k--) {\n            for (j = 0; j < count; j++) {\n                X[k][j] /= lu[k][k];\n            }\n            for (i = 0; i < k; i++) {\n                for (j = 0; j < count; j++) {\n                    X[i][j] -= X[k][j] * lu[i][k];\n                }\n            }\n        }\n        return X;\n    }\n};\n\nmodule.exports = LuDecomposition;\n","'use strict';\n\nvar Matrix = require('../matrix');\nvar util = require('./util');\nvar hypotenuse = util.hypotenuse;\nvar getFilled2DArray = util.getFilled2DArray;\n\n// https://github.com/lutzroeder/Mapack/blob/master/Source/SingularValueDecomposition.cs\nfunction SingularValueDecomposition(value, options) {\n    if (!(this instanceof SingularValueDecomposition)) {\n        return new SingularValueDecomposition(value, options);\n    }\n    value = Matrix.Matrix.checkMatrix(value);\n\n    options = options || {};\n\n    var m = value.rows,\n        n = value.columns,\n        nu = Math.min(m, n);\n\n    var wantu = true, wantv = true;\n    if (options.computeLeftSingularVectors === false) wantu = false;\n    if (options.computeRightSingularVectors === false) wantv = false;\n    var autoTranspose = options.autoTranspose === true;\n\n    var swapped = false;\n    var a;\n    if (m < n) {\n        if (!autoTranspose) {\n            a = value.clone();\n            // eslint-disable-next-line no-console\n            console.warn('Computing SVD on a matrix with more columns than rows. Consider enabling autoTranspose');\n        } else {\n            a = value.transpose();\n            m = a.rows;\n            n = a.columns;\n            swapped = true;\n            var aux = wantu;\n            wantu = wantv;\n            wantv = aux;\n        }\n    } else {\n        a = value.clone();\n    }\n\n    var s = new Array(Math.min(m + 1, n)),\n        U = getFilled2DArray(m, nu, 0),\n        V = getFilled2DArray(n, n, 0),\n        e = new Array(n),\n        work = new Array(m);\n\n    var nct = Math.min(m - 1, n);\n    var nrt = Math.max(0, Math.min(n - 2, m));\n\n    var i, j, k, p, t, ks, f, cs, sn, max, kase,\n        scale, sp, spm1, epm1, sk, ek, b, c, shift, g;\n\n    for (k = 0, max = Math.max(nct, nrt); k < max; k++) {\n        if (k < nct) {\n            s[k] = 0;\n            for (i = k; i < m; i++) {\n                s[k] = hypotenuse(s[k], a[i][k]);\n            }\n            if (s[k] !== 0) {\n                if (a[k][k] < 0) {\n                    s[k] = -s[k];\n                }\n                for (i = k; i < m; i++) {\n                    a[i][k] /= s[k];\n                }\n                a[k][k] += 1;\n            }\n            s[k] = -s[k];\n        }\n\n        for (j = k + 1; j < n; j++) {\n            if ((k < nct) && (s[k] !== 0)) {\n                t = 0;\n                for (i = k; i < m; i++) {\n                    t += a[i][k] * a[i][j];\n                }\n                t = -t / a[k][k];\n                for (i = k; i < m; i++) {\n                    a[i][j] += t * a[i][k];\n                }\n            }\n            e[j] = a[k][j];\n        }\n\n        if (wantu && (k < nct)) {\n            for (i = k; i < m; i++) {\n                U[i][k] = a[i][k];\n            }\n        }\n\n        if (k < nrt) {\n            e[k] = 0;\n            for (i = k + 1; i < n; i++) {\n                e[k] = hypotenuse(e[k], e[i]);\n            }\n            if (e[k] !== 0) {\n                if (e[k + 1] < 0) {\n                    e[k] = 0 - e[k];\n                }\n                for (i = k + 1; i < n; i++) {\n                    e[i] /= e[k];\n                }\n                e[k + 1] += 1;\n            }\n            e[k] = -e[k];\n            if ((k + 1 < m) && (e[k] !== 0)) {\n                for (i = k + 1; i < m; i++) {\n                    work[i] = 0;\n                }\n                for (j = k + 1; j < n; j++) {\n                    for (i = k + 1; i < m; i++) {\n                        work[i] += e[j] * a[i][j];\n                    }\n                }\n                for (j = k + 1; j < n; j++) {\n                    t = -e[j] / e[k + 1];\n                    for (i = k + 1; i < m; i++) {\n                        a[i][j] += t * work[i];\n                    }\n                }\n            }\n            if (wantv) {\n                for (i = k + 1; i < n; i++) {\n                    V[i][k] = e[i];\n                }\n            }\n        }\n    }\n\n    p = Math.min(n, m + 1);\n    if (nct < n) {\n        s[nct] = a[nct][nct];\n    }\n    if (m < p) {\n        s[p - 1] = 0;\n    }\n    if (nrt + 1 < p) {\n        e[nrt] = a[nrt][p - 1];\n    }\n    e[p - 1] = 0;\n\n    if (wantu) {\n        for (j = nct; j < nu; j++) {\n            for (i = 0; i < m; i++) {\n                U[i][j] = 0;\n            }\n            U[j][j] = 1;\n        }\n        for (k = nct - 1; k >= 0; k--) {\n            if (s[k] !== 0) {\n                for (j = k + 1; j < nu; j++) {\n                    t = 0;\n                    for (i = k; i < m; i++) {\n                        t += U[i][k] * U[i][j];\n                    }\n                    t = -t / U[k][k];\n                    for (i = k; i < m; i++) {\n                        U[i][j] += t * U[i][k];\n                    }\n                }\n                for (i = k; i < m; i++) {\n                    U[i][k] = -U[i][k];\n                }\n                U[k][k] = 1 + U[k][k];\n                for (i = 0; i < k - 1; i++) {\n                    U[i][k] = 0;\n                }\n            } else {\n                for (i = 0; i < m; i++) {\n                    U[i][k] = 0;\n                }\n                U[k][k] = 1;\n            }\n        }\n    }\n\n    if (wantv) {\n        for (k = n - 1; k >= 0; k--) {\n            if ((k < nrt) && (e[k] !== 0)) {\n                for (j = k + 1; j < n; j++) {\n                    t = 0;\n                    for (i = k + 1; i < n; i++) {\n                        t += V[i][k] * V[i][j];\n                    }\n                    t = -t / V[k + 1][k];\n                    for (i = k + 1; i < n; i++) {\n                        V[i][j] += t * V[i][k];\n                    }\n                }\n            }\n            for (i = 0; i < n; i++) {\n                V[i][k] = 0;\n            }\n            V[k][k] = 1;\n        }\n    }\n\n    var pp = p - 1,\n        iter = 0,\n        eps = Math.pow(2, -52);\n    while (p > 0) {\n        for (k = p - 2; k >= -1; k--) {\n            if (k === -1) {\n                break;\n            }\n            if (Math.abs(e[k]) <= eps * (Math.abs(s[k]) + Math.abs(s[k + 1]))) {\n                e[k] = 0;\n                break;\n            }\n        }\n        if (k === p - 2) {\n            kase = 4;\n        } else {\n            for (ks = p - 1; ks >= k; ks--) {\n                if (ks === k) {\n                    break;\n                }\n                t = (ks !== p ? Math.abs(e[ks]) : 0) + (ks !== k + 1 ? Math.abs(e[ks - 1]) : 0);\n                if (Math.abs(s[ks]) <= eps * t) {\n                    s[ks] = 0;\n                    break;\n                }\n            }\n            if (ks === k) {\n                kase = 3;\n            } else if (ks === p - 1) {\n                kase = 1;\n            } else {\n                kase = 2;\n                k = ks;\n            }\n        }\n\n        k++;\n\n        switch (kase) {\n            case 1: {\n                f = e[p - 2];\n                e[p - 2] = 0;\n                for (j = p - 2; j >= k; j--) {\n                    t = hypotenuse(s[j], f);\n                    cs = s[j] / t;\n                    sn = f / t;\n                    s[j] = t;\n                    if (j !== k) {\n                        f = -sn * e[j - 1];\n                        e[j - 1] = cs * e[j - 1];\n                    }\n                    if (wantv) {\n                        for (i = 0; i < n; i++) {\n                            t = cs * V[i][j] + sn * V[i][p - 1];\n                            V[i][p - 1] = -sn * V[i][j] + cs * V[i][p - 1];\n                            V[i][j] = t;\n                        }\n                    }\n                }\n                break;\n            }\n            case 2 : {\n                f = e[k - 1];\n                e[k - 1] = 0;\n                for (j = k; j < p; j++) {\n                    t = hypotenuse(s[j], f);\n                    cs = s[j] / t;\n                    sn = f / t;\n                    s[j] = t;\n                    f = -sn * e[j];\n                    e[j] = cs * e[j];\n                    if (wantu) {\n                        for (i = 0; i < m; i++) {\n                            t = cs * U[i][j] + sn * U[i][k - 1];\n                            U[i][k - 1] = -sn * U[i][j] + cs * U[i][k - 1];\n                            U[i][j] = t;\n                        }\n                    }\n                }\n                break;\n            }\n            case 3 : {\n                scale = Math.max(Math.max(Math.max(Math.max(Math.abs(s[p - 1]), Math.abs(s[p - 2])), Math.abs(e[p - 2])), Math.abs(s[k])), Math.abs(e[k]));\n                sp = s[p - 1] / scale;\n                spm1 = s[p - 2] / scale;\n                epm1 = e[p - 2] / scale;\n                sk = s[k] / scale;\n                ek = e[k] / scale;\n                b = ((spm1 + sp) * (spm1 - sp) + epm1 * epm1) / 2;\n                c = (sp * epm1) * (sp * epm1);\n                shift = 0;\n                if ((b !== 0) || (c !== 0)) {\n                    shift = Math.sqrt(b * b + c);\n                    if (b < 0) {\n                        shift = -shift;\n                    }\n                    shift = c / (b + shift);\n                }\n                f = (sk + sp) * (sk - sp) + shift;\n                g = sk * ek;\n                for (j = k; j < p - 1; j++) {\n                    t = hypotenuse(f, g);\n                    cs = f / t;\n                    sn = g / t;\n                    if (j !== k) {\n                        e[j - 1] = t;\n                    }\n                    f = cs * s[j] + sn * e[j];\n                    e[j] = cs * e[j] - sn * s[j];\n                    g = sn * s[j + 1];\n                    s[j + 1] = cs * s[j + 1];\n                    if (wantv) {\n                        for (i = 0; i < n; i++) {\n                            t = cs * V[i][j] + sn * V[i][j + 1];\n                            V[i][j + 1] = -sn * V[i][j] + cs * V[i][j + 1];\n                            V[i][j] = t;\n                        }\n                    }\n                    t = hypotenuse(f, g);\n                    cs = f / t;\n                    sn = g / t;\n                    s[j] = t;\n                    f = cs * e[j] + sn * s[j + 1];\n                    s[j + 1] = -sn * e[j] + cs * s[j + 1];\n                    g = sn * e[j + 1];\n                    e[j + 1] = cs * e[j + 1];\n                    if (wantu && (j < m - 1)) {\n                        for (i = 0; i < m; i++) {\n                            t = cs * U[i][j] + sn * U[i][j + 1];\n                            U[i][j + 1] = -sn * U[i][j] + cs * U[i][j + 1];\n                            U[i][j] = t;\n                        }\n                    }\n                }\n                e[p - 2] = f;\n                iter = iter + 1;\n                break;\n            }\n            case 4: {\n                if (s[k] <= 0) {\n                    s[k] = (s[k] < 0 ? -s[k] : 0);\n                    if (wantv) {\n                        for (i = 0; i <= pp; i++) {\n                            V[i][k] = -V[i][k];\n                        }\n                    }\n                }\n                while (k < pp) {\n                    if (s[k] >= s[k + 1]) {\n                        break;\n                    }\n                    t = s[k];\n                    s[k] = s[k + 1];\n                    s[k + 1] = t;\n                    if (wantv && (k < n - 1)) {\n                        for (i = 0; i < n; i++) {\n                            t = V[i][k + 1];\n                            V[i][k + 1] = V[i][k];\n                            V[i][k] = t;\n                        }\n                    }\n                    if (wantu && (k < m - 1)) {\n                        for (i = 0; i < m; i++) {\n                            t = U[i][k + 1];\n                            U[i][k + 1] = U[i][k];\n                            U[i][k] = t;\n                        }\n                    }\n                    k++;\n                }\n                iter = 0;\n                p--;\n                break;\n            }\n            // no default\n        }\n    }\n\n    if (swapped) {\n        var tmp = V;\n        V = U;\n        U = tmp;\n    }\n\n    this.m = m;\n    this.n = n;\n    this.s = s;\n    this.U = U;\n    this.V = V;\n}\n\nSingularValueDecomposition.prototype = {\n    get condition() {\n        return this.s[0] / this.s[Math.min(this.m, this.n) - 1];\n    },\n    get norm2() {\n        return this.s[0];\n    },\n    get rank() {\n        var eps = Math.pow(2, -52),\n            tol = Math.max(this.m, this.n) * this.s[0] * eps,\n            r = 0,\n            s = this.s;\n        for (var i = 0, ii = s.length; i < ii; i++) {\n            if (s[i] > tol) {\n                r++;\n            }\n        }\n        return r;\n    },\n    get diagonal() {\n        return this.s;\n    },\n    // https://github.com/accord-net/framework/blob/development/Sources/Accord.Math/Decompositions/SingularValueDecomposition.cs\n    get threshold() {\n        return (Math.pow(2, -52) / 2) * Math.max(this.m, this.n) * this.s[0];\n    },\n    get leftSingularVectors() {\n        if (!Matrix.Matrix.isMatrix(this.U)) {\n            this.U = new Matrix.Matrix(this.U);\n        }\n        return this.U;\n    },\n    get rightSingularVectors() {\n        if (!Matrix.Matrix.isMatrix(this.V)) {\n            this.V = new Matrix.Matrix(this.V);\n        }\n        return this.V;\n    },\n    get diagonalMatrix() {\n        return Matrix.Matrix.diag(this.s);\n    },\n    solve: function (value) {\n\n        var Y = value,\n            e = this.threshold,\n            scols = this.s.length,\n            Ls = Matrix.Matrix.zeros(scols, scols),\n            i;\n\n        for (i = 0; i < scols; i++) {\n            if (Math.abs(this.s[i]) <= e) {\n                Ls[i][i] = 0;\n            } else {\n                Ls[i][i] = 1 / this.s[i];\n            }\n        }\n\n        var U = this.U;\n        var V = this.rightSingularVectors;\n\n        var VL = V.mmul(Ls),\n            vrows = V.rows,\n            urows = U.length,\n            VLU = Matrix.Matrix.zeros(vrows, urows),\n            j, k, sum;\n\n        for (i = 0; i < vrows; i++) {\n            for (j = 0; j < urows; j++) {\n                sum = 0;\n                for (k = 0; k < scols; k++) {\n                    sum += VL[i][k] * U[j][k];\n                }\n                VLU[i][j] = sum;\n            }\n        }\n\n        return VLU.mmul(Y);\n    },\n    solveForDiagonal: function (value) {\n        return this.solve(Matrix.Matrix.diag(value));\n    },\n    inverse: function () {\n        var V = this.V;\n        var e = this.threshold,\n            vrows = V.length,\n            vcols = V[0].length,\n            X = new Matrix.Matrix(vrows, this.s.length),\n            i, j;\n\n        for (i = 0; i < vrows; i++) {\n            for (j = 0; j < vcols; j++) {\n                if (Math.abs(this.s[j]) > e) {\n                    X[i][j] = V[i][j] / this.s[j];\n                } else {\n                    X[i][j] = 0;\n                }\n            }\n        }\n\n        var U = this.U;\n\n        var urows = U.length,\n            ucols = U[0].length,\n            Y = new Matrix.Matrix(vrows, urows),\n            k, sum;\n\n        for (i = 0; i < vrows; i++) {\n            for (j = 0; j < urows; j++) {\n                sum = 0;\n                for (k = 0; k < ucols; k++) {\n                    sum += X[i][k] * U[j][k];\n                }\n                Y[i][j] = sum;\n            }\n        }\n\n        return Y;\n    }\n};\n\nmodule.exports = SingularValueDecomposition;\n","'use strict';\n\nexports.array = require('./array');\nexports.matrix = require('./matrix');\n","'use strict';\n\nfunction compareNumbers(a, b) {\n    return a - b;\n}\n\n/**\n * Computes the sum of the given values\n * @param {Array} values\n * @returns {number}\n */\nexports.sum = function sum(values) {\n    var sum = 0;\n    for (var i = 0; i < values.length; i++) {\n        sum += values[i];\n    }\n    return sum;\n};\n\n/**\n * Computes the maximum of the given values\n * @param {Array} values\n * @returns {number}\n */\nexports.max = function max(values) {\n    var max = values[0];\n    var l = values.length;\n    for (var i = 1; i < l; i++) {\n        if (values[i] > max) max = values[i];\n    }\n    return max;\n};\n\n/**\n * Computes the minimum of the given values\n * @param {Array} values\n * @returns {number}\n */\nexports.min = function min(values) {\n    var min = values[0];\n    var l = values.length;\n    for (var i = 1; i < l; i++) {\n        if (values[i] < min) min = values[i];\n    }\n    return min;\n};\n\n/**\n * Computes the min and max of the given values\n * @param {Array} values\n * @returns {{min: number, max: number}}\n */\nexports.minMax = function minMax(values) {\n    var min = values[0];\n    var max = values[0];\n    var l = values.length;\n    for (var i = 1; i < l; i++) {\n        if (values[i] < min) min = values[i];\n        if (values[i] > max) max = values[i];\n    }\n    return {\n        min: min,\n        max: max\n    };\n};\n\n/**\n * Computes the arithmetic mean of the given values\n * @param {Array} values\n * @returns {number}\n */\nexports.arithmeticMean = function arithmeticMean(values) {\n    var sum = 0;\n    var l = values.length;\n    for (var i = 0; i < l; i++) {\n        sum += values[i];\n    }\n    return sum / l;\n};\n\n/**\n * {@link arithmeticMean}\n */\nexports.mean = exports.arithmeticMean;\n\n/**\n * Computes the geometric mean of the given values\n * @param {Array} values\n * @returns {number}\n */\nexports.geometricMean = function geometricMean(values) {\n    var mul = 1;\n    var l = values.length;\n    for (var i = 0; i < l; i++) {\n        mul *= values[i];\n    }\n    return Math.pow(mul, 1 / l);\n};\n\n/**\n * Computes the mean of the log of the given values\n * If the return value is exponentiated, it gives the same result as the\n * geometric mean.\n * @param {Array} values\n * @returns {number}\n */\nexports.logMean = function logMean(values) {\n    var lnsum = 0;\n    var l = values.length;\n    for (var i = 0; i < l; i++) {\n        lnsum += Math.log(values[i]);\n    }\n    return lnsum / l;\n};\n\n/**\n * Computes the weighted grand mean for a list of means and sample sizes\n * @param {Array} means - Mean values for each set of samples\n * @param {Array} samples - Number of original values for each set of samples\n * @returns {number}\n */\nexports.grandMean = function grandMean(means, samples) {\n    var sum = 0;\n    var n = 0;\n    var l = means.length;\n    for (var i = 0; i < l; i++) {\n        sum += samples[i] * means[i];\n        n += samples[i];\n    }\n    return sum / n;\n};\n\n/**\n * Computes the truncated mean of the given values using a given percentage\n * @param {Array} values\n * @param {number} percent - The percentage of values to keep (range: [0,1])\n * @param {boolean} [alreadySorted=false]\n * @returns {number}\n */\nexports.truncatedMean = function truncatedMean(values, percent, alreadySorted) {\n    if (alreadySorted === undefined) alreadySorted = false;\n    if (!alreadySorted) {\n        values = [].concat(values).sort(compareNumbers);\n    }\n    var l = values.length;\n    var k = Math.floor(l * percent);\n    var sum = 0;\n    for (var i = k; i < (l - k); i++) {\n        sum += values[i];\n    }\n    return sum / (l - 2 * k);\n};\n\n/**\n * Computes the harmonic mean of the given values\n * @param {Array} values\n * @returns {number}\n */\nexports.harmonicMean = function harmonicMean(values) {\n    var sum = 0;\n    var l = values.length;\n    for (var i = 0; i < l; i++) {\n        if (values[i] === 0) {\n            throw new RangeError('value at index ' + i + 'is zero');\n        }\n        sum += 1 / values[i];\n    }\n    return l / sum;\n};\n\n/**\n * Computes the contraharmonic mean of the given values\n * @param {Array} values\n * @returns {number}\n */\nexports.contraHarmonicMean = function contraHarmonicMean(values) {\n    var r1 = 0;\n    var r2 = 0;\n    var l = values.length;\n    for (var i = 0; i < l; i++) {\n        r1 += values[i] * values[i];\n        r2 += values[i];\n    }\n    if (r2 < 0) {\n        throw new RangeError('sum of values is negative');\n    }\n    return r1 / r2;\n};\n\n/**\n * Computes the median of the given values\n * @param {Array} values\n * @param {boolean} [alreadySorted=false]\n * @returns {number}\n */\nexports.median = function median(values, alreadySorted) {\n    if (alreadySorted === undefined) alreadySorted = false;\n    if (!alreadySorted) {\n        values = [].concat(values).sort(compareNumbers);\n    }\n    var l = values.length;\n    var half = Math.floor(l / 2);\n    if (l % 2 === 0) {\n        return (values[half - 1] + values[half]) * 0.5;\n    } else {\n        return values[half];\n    }\n};\n\n/**\n * Computes the variance of the given values\n * @param {Array} values\n * @param {boolean} [unbiased=true] - if true, divide by (n-1); if false, divide by n.\n * @returns {number}\n */\nexports.variance = function variance(values, unbiased) {\n    if (unbiased === undefined) unbiased = true;\n    var theMean = exports.mean(values);\n    var theVariance = 0;\n    var l = values.length;\n\n    for (var i = 0; i < l; i++) {\n        var x = values[i] - theMean;\n        theVariance += x * x;\n    }\n\n    if (unbiased) {\n        return theVariance / (l - 1);\n    } else {\n        return theVariance / l;\n    }\n};\n\n/**\n * Computes the standard deviation of the given values\n * @param {Array} values\n * @param {boolean} [unbiased=true] - if true, divide by (n-1); if false, divide by n.\n * @returns {number}\n */\nexports.standardDeviation = function standardDeviation(values, unbiased) {\n    return Math.sqrt(exports.variance(values, unbiased));\n};\n\nexports.standardError = function standardError(values) {\n    return exports.standardDeviation(values) / Math.sqrt(values.length);\n};\n\n/**\n * IEEE Transactions on biomedical engineering, vol. 52, no. 1, january 2005, p. 76-\n * Calculate the standard deviation via the Median of the absolute deviation\n *  The formula for the standard deviation only holds for Gaussian random variables.\n * @returns {{mean: number, stdev: number}}\n */\nexports.robustMeanAndStdev = function robustMeanAndStdev(y) {\n    var mean = 0, stdev = 0;\n    var length = y.length, i = 0;\n    for (i = 0; i < length; i++) {\n        mean += y[i];\n    }\n    mean /= length;\n    var averageDeviations = new Array(length);\n    for (i = 0; i < length; i++)\n        averageDeviations[i] = Math.abs(y[i] - mean);\n    averageDeviations.sort(compareNumbers);\n    if (length % 2 === 1) {\n        stdev = averageDeviations[(length - 1) / 2] / 0.6745;\n    } else {\n        stdev = 0.5 * (averageDeviations[length / 2] + averageDeviations[length / 2 - 1]) / 0.6745;\n    }\n\n    return {\n        mean: mean,\n        stdev: stdev\n    };\n};\n\nexports.quartiles = function quartiles(values, alreadySorted) {\n    if (typeof (alreadySorted) === 'undefined') alreadySorted = false;\n    if (!alreadySorted) {\n        values = [].concat(values).sort(compareNumbers);\n    }\n\n    var quart = values.length / 4;\n    var q1 = values[Math.ceil(quart) - 1];\n    var q2 = exports.median(values, true);\n    var q3 = values[Math.ceil(quart * 3) - 1];\n\n    return {q1: q1, q2: q2, q3: q3};\n};\n\nexports.pooledStandardDeviation = function pooledStandardDeviation(samples, unbiased) {\n    return Math.sqrt(exports.pooledVariance(samples, unbiased));\n};\n\nexports.pooledVariance = function pooledVariance(samples, unbiased) {\n    if (typeof (unbiased) === 'undefined') unbiased = true;\n    var sum = 0;\n    var length = 0, l = samples.length;\n    for (var i = 0; i < l; i++) {\n        var values = samples[i];\n        var vari = exports.variance(values);\n\n        sum += (values.length - 1) * vari;\n\n        if (unbiased)\n            length += values.length - 1;\n        else\n            length += values.length;\n    }\n    return sum / length;\n};\n\nexports.mode = function mode(values) {\n    var l = values.length,\n        itemCount = new Array(l),\n        i;\n    for (i = 0; i < l; i++) {\n        itemCount[i] = 0;\n    }\n    var itemArray = new Array(l);\n    var count = 0;\n\n    for (i = 0; i < l; i++) {\n        var index = itemArray.indexOf(values[i]);\n        if (index >= 0)\n            itemCount[index]++;\n        else {\n            itemArray[count] = values[i];\n            itemCount[count] = 1;\n            count++;\n        }\n    }\n\n    var maxValue = 0, maxIndex = 0;\n    for (i = 0; i < count; i++) {\n        if (itemCount[i] > maxValue) {\n            maxValue = itemCount[i];\n            maxIndex = i;\n        }\n    }\n\n    return itemArray[maxIndex];\n};\n\nexports.covariance = function covariance(vector1, vector2, unbiased) {\n    if (typeof (unbiased) === 'undefined') unbiased = true;\n    var mean1 = exports.mean(vector1);\n    var mean2 = exports.mean(vector2);\n\n    if (vector1.length !== vector2.length)\n        throw 'Vectors do not have the same dimensions';\n\n    var cov = 0, l = vector1.length;\n    for (var i = 0; i < l; i++) {\n        var x = vector1[i] - mean1;\n        var y = vector2[i] - mean2;\n        cov += x * y;\n    }\n\n    if (unbiased)\n        return cov / (l - 1);\n    else\n        return cov / l;\n};\n\nexports.skewness = function skewness(values, unbiased) {\n    if (typeof (unbiased) === 'undefined') unbiased = true;\n    var theMean = exports.mean(values);\n\n    var s2 = 0, s3 = 0, l = values.length;\n    for (var i = 0; i < l; i++) {\n        var dev = values[i] - theMean;\n        s2 += dev * dev;\n        s3 += dev * dev * dev;\n    }\n    var m2 = s2 / l;\n    var m3 = s3 / l;\n\n    var g = m3 / (Math.pow(m2, 3 / 2.0));\n    if (unbiased) {\n        var a = Math.sqrt(l * (l - 1));\n        var b = l - 2;\n        return (a / b) * g;\n    } else {\n        return g;\n    }\n};\n\nexports.kurtosis = function kurtosis(values, unbiased) {\n    if (typeof (unbiased) === 'undefined') unbiased = true;\n    var theMean = exports.mean(values);\n    var n = values.length, s2 = 0, s4 = 0;\n\n    for (var i = 0; i < n; i++) {\n        var dev = values[i] - theMean;\n        s2 += dev * dev;\n        s4 += dev * dev * dev * dev;\n    }\n    var m2 = s2 / n;\n    var m4 = s4 / n;\n\n    if (unbiased) {\n        var v = s2 / (n - 1);\n        var a = (n * (n + 1)) / ((n - 1) * (n - 2) * (n - 3));\n        var b = s4 / (v * v);\n        var c = ((n - 1) * (n - 1)) / ((n - 2) * (n - 3));\n\n        return a * b - 3 * c;\n    } else {\n        return m4 / (m2 * m2) - 3;\n    }\n};\n\nexports.entropy = function entropy(values, eps) {\n    if (typeof (eps) === 'undefined') eps = 0;\n    var sum = 0, l = values.length;\n    for (var i = 0; i < l; i++)\n        sum += values[i] * Math.log(values[i] + eps);\n    return -sum;\n};\n\nexports.weightedMean = function weightedMean(values, weights) {\n    var sum = 0, l = values.length;\n    for (var i = 0; i < l; i++)\n        sum += values[i] * weights[i];\n    return sum;\n};\n\nexports.weightedStandardDeviation = function weightedStandardDeviation(values, weights) {\n    return Math.sqrt(exports.weightedVariance(values, weights));\n};\n\nexports.weightedVariance = function weightedVariance(values, weights) {\n    var theMean = exports.weightedMean(values, weights);\n    var vari = 0, l = values.length;\n    var a = 0, b = 0;\n\n    for (var i = 0; i < l; i++) {\n        var z = values[i] - theMean;\n        var w = weights[i];\n\n        vari += w * (z * z);\n        b += w;\n        a += w * w;\n    }\n\n    return vari * (b / (b * b - a));\n};\n\nexports.center = function center(values, inPlace) {\n    if (typeof (inPlace) === 'undefined') inPlace = false;\n\n    var result = values;\n    if (!inPlace)\n        result = [].concat(values);\n\n    var theMean = exports.mean(result), l = result.length;\n    for (var i = 0; i < l; i++)\n        result[i] -= theMean;\n};\n\nexports.standardize = function standardize(values, standardDev, inPlace) {\n    if (typeof (standardDev) === 'undefined') standardDev = exports.standardDeviation(values);\n    if (typeof (inPlace) === 'undefined') inPlace = false;\n    var l = values.length;\n    var result = inPlace ? values : new Array(l);\n    for (var i = 0; i < l; i++)\n        result[i] = values[i] / standardDev;\n    return result;\n};\n\nexports.cumulativeSum = function cumulativeSum(array) {\n    var l = array.length;\n    var result = new Array(l);\n    result[0] = array[0];\n    for (var i = 1; i < l; i++)\n        result[i] = result[i - 1] + array[i];\n    return result;\n};\n","/**\n * Created by acastillo on 8/24/15.\n */\n/**\n * Non in-place function definitions, compatible with mathjs code *\n */\n\n'use strict';\n\nvar Matrix = require('ml-matrix');\n\nfunction matrix(A,B){\n    return new Matrix(A,B);\n}\n\nfunction ones(rows, cols){\n    return Matrix.ones(rows,cols);\n}\n\nfunction eye(rows, cols){\n    return Matrix.eye(rows, cols);\n}\n\nfunction zeros(rows, cols){\n    return Matrix.zeros(rows, cols);\n}\n\nfunction random(rows, cols){\n    return Matrix.rand(rows,cols);\n}\n\nfunction transpose(A){\n    if(typeof A == 'number')\n        return A;\n    var result = A.clone();\n    return result.transpose();\n}\n\nfunction add(A, B){\n    if(typeof A == 'number'&&typeof B === 'number')\n        return A+B;\n    if(typeof A == 'number')\n        return this.add(B,A);\n\n    var result = A.clone();\n    return result.add(B);\n\n}\n\nfunction subtract(A, B){\n    if(typeof A == 'number'&&typeof B === 'number')\n        return A-B;\n    if(typeof A == 'number')\n        return this.subtract(B,A);\n    var result = A.clone();\n    return result.sub(B);\n}\n\nfunction multiply(A, B){\n    if(typeof A == 'number'&&typeof B === 'number')\n        return A*B;\n    if(typeof A == 'number')\n        return this.multiply(B,A);\n\n    var result = A.clone();\n\n    if(typeof B === 'number')\n        result.mul(B);\n    else\n        result = result.mmul(B);\n\n    if(result.rows==1&&result.columns==1)\n        return result[0][0];\n    else\n        return result;\n\n}\n\nfunction dotMultiply(A, B){\n    var result = A.clone();\n    return result.mul(B);\n}\n\nfunction dotDivide(A, B){\n    var result = A.clone();\n    return result.div(B);\n}\n\nfunction diag(A){\n    var diag = null;\n    var rows = A.rows, cols = A.columns, j, r;\n    //It is an array\n    if(typeof cols === \"undefined\" && (typeof A)=='object'){\n        if(A[0]&&A[0].length){\n            rows = A.length;\n            cols = A[0].length;\n            r = Math.min(rows,cols);\n            diag = Matrix.zeros(cols, cols);\n            for (j = 0; j < cols; j++) {\n                diag[j][j]=A[j][j];\n            }\n        }\n        else{\n            cols = A.length;\n            diag = Matrix.zeros(cols, cols);\n            for (j = 0; j < cols; j++) {\n                diag[j][j]=A[j];\n            }\n        }\n\n    }\n    if(rows == 1){\n        diag = Matrix.zeros(cols, cols);\n        for (j = 0; j < cols; j++) {\n            diag[j][j]=A[0][j];\n        }\n    }\n    else{\n        if(rows>0 && cols > 0){\n            r = Math.min(rows,cols);\n            diag = new Array(r);\n            for (j = 0; j < r; j++) {\n                diag[j] = A[j][j];\n            }\n        }\n    }\n    return diag;\n}\n\nfunction min(A, B){\n    if(typeof A==='number' && typeof B ==='number')\n        return Math.min(A,B);\n    var ii = A.rows, jj = A.columns;\n    var result = new Matrix(ii,jj);\n    for (var i = 0; i < ii; i++) {\n        for (var j = 0; j < jj; j++) {\n            if (A[i][j] < B[i][j]) {\n                result[i][j] = A[i][j];\n            }\n            else{\n                result[i][j] = B[i][j];\n            }\n        }\n    }\n    return result;\n}\n\nfunction max(A, B){\n    if(typeof A==='number' && typeof B ==='number')\n        return Math.max(A,B);\n    var ii = A.rows, jj = A.columns;\n    var result = new Matrix(ii,jj);\n    for (var i = 0; i < ii; i++) {\n        for (var j = 0; j < jj; j++) {\n            if (A[i][j] > B[i][j]) {\n                result[i][j] = A[i][j];\n            }\n            else{\n                result[i][j] = B[i][j];\n            }\n        }\n    }\n    return result;\n}\n\nfunction sqrt(A){\n    if(typeof A==='number' )\n        return Math.sqrt(A);\n    var ii = A.rows, jj = A.columns;\n    var result = new Matrix(ii,jj);\n    for (var i = 0; i < ii; i++) {\n        for (var j = 0; j < jj; j++) {\n            result[i][j] = Math.sqrt(A[i][j]);\n\n        }\n    }\n    return result;\n}\n\nfunction abs(A){\n    if(typeof A==='number' )\n        return Math.abs(A);\n    var ii = A.rows, jj = A.columns;\n    var result = new Matrix(ii,jj);\n    for (var i = 0; i < ii; i++) {\n        for (var j = 0; j < jj; j++) {\n            result[i][j] = Math.abs(A[i][j]);\n\n        }\n    }\n    return result;\n}\n\nfunction exp(A){\n    if(typeof A==='number' )\n        return Math.sqrt(A);\n    var ii = A.rows, jj = A.columns;\n    var result = new Matrix(ii,jj);\n    for (var i = 0; i < ii; i++) {\n        for (var j = 0; j < jj; j++) {\n            result[i][j] = Math.exp(A[i][j]);\n        }\n    }\n    return result;\n}\n\nfunction dotPow(A, b){\n    if(typeof A==='number' )\n        return Math.pow(A,b);\n    //console.log(A);\n    var ii = A.rows, jj = A.columns;\n    var result = new Matrix(ii,jj);\n    for (var i = 0; i < ii; i++) {\n        for (var j = 0; j < jj; j++) {\n            result[i][j] = Math.pow(A[i][j],b);\n        }\n    }\n    return result;\n}\n\nfunction solve(A, B){\n    return A.solve(B);\n}\n\nfunction inv(A){\n    if(typeof A ===\"number\")\n        return 1/A;\n    return A.inverse();\n}\n\nmodule.exports = {\n    transpose:transpose,\n    add:add,\n    subtract:subtract,\n    multiply:multiply,\n    dotMultiply:dotMultiply,\n    dotDivide:dotDivide,\n    diag:diag,\n    min:min,\n    max:max,\n    solve:solve,\n    inv:inv,\n    sqrt:sqrt,\n    exp:exp,\n    dotPow:dotPow,\n    abs:abs,\n    matrix:matrix,\n    ones:ones,\n    zeros:zeros,\n    random:random,\n    eye:eye\n};\n","'use strict';\n\n/**\n * In place modification of the 2 arrays to make X unique and sum the Y if X has the same value\n * @param xs\n * @param ys\n */\n\nfunction uniqueX(xs, ys) {\n    if (xs.length < 2) return;\n\n    var current = xs[0];\n    var counter = 0;\n\n    for (var i = 1; i < xs.length; i++) {\n        if (current !== xs[i]) {\n            counter++;\n            current = xs[i];\n            xs[counter] = xs[i];\n            if (i !== counter) {\n                ys[counter] = 0;\n            }\n        }\n        if (i !== counter) {\n            ys[counter] += ys[i];\n        }\n\n    }\n\n    xs.length = counter + 1;\n    ys.length = counter + 1;\n}\n\nmodule.exports = uniqueX;\n","'use strict';\n\nObject.defineProperty(exports, '__esModule', { value: true });\n\nfunction _interopDefault (ex) { return (ex && (typeof ex === 'object') && 'default' in ex) ? ex['default'] : ex; }\n\nvar min = _interopDefault(require('ml-array-min'));\nvar max = _interopDefault(require('ml-array-max'));\nvar mlGsd = require('ml-gsd');\nvar jcampconverter = require('jcampconverter');\nvar sortX = _interopDefault(require('ml-array-xy-sort-x'));\nvar xyParser = require('xy-parser');\n\nfunction getAnnotations(spectrum, options = {}) {\n  const { fillColor = 'green', strokeColor = 'red', creationFct } = options;\n  const peaks = spectrum.peaks;\n  if (!peaks) return [];\n  let annotations = peaks.map(peak => {\n    var annotation = {\n      line: 1,\n      type: 'rect',\n      strokeColor: strokeColor,\n      strokeWidth: 0,\n      fillColor: fillColor\n    };\n    if (creationFct) {\n      creationFct(annotation, peak);\n    }\n    oneAnnotation(annotation, peak);\n    return annotation;\n  });\n\n  return annotations;\n}\n\nfunction oneAnnotation(annotation, peak) {\n  annotation.label = [\n    {\n      text: peak.kind,\n      size: '18px',\n      anchor: 'middle',\n      color: 'red',\n      position: {\n        x: peak.wavelength,\n        y: peak.intensity,\n        dy: '-15px'\n      }\n    }\n  ];\n  annotation.position = [\n    {\n      x: peak.wavelength,\n      y: peak.intensity,\n      dy: '-10px',\n      dx: '-1px'\n    },\n    {\n      x: peak.wavelength,\n      y: peak.intensity,\n      dy: '-5px',\n      dx: '1px'\n    }\n  ];\n}\n\n/**\n *\n * @param {Spectrum} spectrum\n * @param {object} peak\n */\n\nfunction addPeak(spectrum, peak = {}) {\n  if (!peak.wavelength) {\n    throw new Error('addPeak: peak mush have wavelength property');\n  }\n  const { wavelength, intensity } = peak;\n\n  for (let existing of spectrum.peaks) {\n    if (Number(existing.wavelength) === wavelength) return existing;\n  }\n  spectrum.peaks.push({\n    wavelength: wavelength,\n    intensity: intensity,\n    kind: getPeakKind(intensity, spectrum.minIntensity, spectrum.maxIntensity)\n  });\n  return peak;\n}\n\nfunction getPeakKind(intensity, minIntensity, maxIntensity) {\n  var position = intensity / (maxIntensity - minIntensity);\n  if (position < 0.33) {\n    return 'w';\n  } else if (position < 0.66) {\n    return 'm';\n  }\n  return 'S';\n}\n\n/**\n *\n * @param {Spectrum} spectrum\n * @param {number} targetWavelength\n * @param {object} [options]\n * @param {number} [options.range=0] Search in a range around the targetWavelength\n * @param {boolean} [options.optimize=false] Search for the closest peak to the targetWavelength\n */\n\nfunction peakPicking(spectrum, targetWavelength, options = {}) {\n  const { range = 0, optimize = false } = options;\n\n  // find the peak that is the closest to the click\n  let bestPeak = getClosest(spectrum, targetWavelength);\n\n  if (optimize) {\n    findClosest(spectrum, bestPeak);\n  } else if (range) {\n    bestInRange(spectrum, bestPeak, targetWavelength, range);\n  }\n\n  return addPeak(spectrum, bestPeak);\n}\n\nfunction getClosest(spectrum, targetWavelength) {\n  let bestPeak = {\n    intensity: spectrum.intensity[0],\n    wavelength: spectrum.wavelength[0],\n    index: 0\n  };\n\n  let error = Math.abs(targetWavelength - bestPeak.wavelength);\n  for (let i = 1; i < spectrum.wavelength.length; i++) {\n    let newError = Math.abs(targetWavelength - spectrum.wavelength[i]);\n    if (newError < error) {\n      error = newError;\n      setBestPeak(spectrum, bestPeak, i);\n    }\n  }\n  return bestPeak;\n}\n\nfunction bestInRange(spectrum, bestPeak, targetWavelength, range) {\n  // we search the minimum based on wavelength +/- range\n  for (let i = 0; i < spectrum.wavelength.length; i++) {\n    if (Math.abs(spectrum.wavelength[i] - targetWavelength) <= range) {\n      if (spectrum.intensity[i] > bestPeak.intensity) {\n        setBestPeak(spectrum, bestPeak, i);\n      }\n    }\n  }\n}\n\nfunction findClosest(spectrum, bestPeak) {\n  let index = bestPeak.index;\n  let previousIndex;\n  while (index !== previousIndex) {\n    previousIndex = index;\n    if (index > 0 && spectrum.intensity[index - 1] > bestPeak.intensity) {\n      index--;\n      setBestPeak(spectrum, bestPeak, index);\n    } else if (\n      index < spectrum.wavelength.length - 1 &&\n      spectrum.intensity[index + 1] > bestPeak.intensity\n    ) {\n      index++;\n      setBestPeak(spectrum, bestPeak, index);\n    }\n  }\n}\n\nfunction setBestPeak(spectrum, bestPeak, index) {\n  bestPeak.index = index;\n  bestPeak.wavelength = spectrum.wavelength[index];\n  bestPeak.intensity = spectrum.intensity[index];\n}\n\n/**\n *\n * @param {*} spectrum\n * @param {object} [options={}]\n * @param {number} [options.fromWavelength=0]\n * @param {number} [options.toWavelength=5000]\n * @param {number} [options.noiseLevel=0.01] - Specify the level of the noise\n * @param {number} [options.minMaxRatio=0.05] - Threshold to determine if a given peak should be considered as a noise\n * @param {boolean} [options.replaceExisting=true] - Replace existing peaks\n */\n\nfunction autoPeakPicking(spectrum, options = {}) {\n  const {\n    noiseLevel = 0.001,\n    minMaxRatio = 0.05,\n    fromWavelength = 0,\n    toWavelength = 5000,\n    replaceExisting = true\n  } = options;\n\n  let peaks = mlGsd.gsd(spectrum.wavelength, spectrum.intensity, {\n    noiseLevel,\n    minMaxRatio,\n    realTopDetection: true,\n    maxCriteria: true,\n    smoothY: false,\n    sgOptions: { windowSize: 7, polynomial: 3 }\n  });\n\n  peaks = peaks.filter(\n    peak => peak.x >= fromWavelength && peak.x <= toWavelength\n  );\n\n  if (replaceExisting) {\n    while (spectrum.peaks.length) {\n      spectrum.peaks.pop();\n    }\n  }\n\n  peakLoop: for (let peak of peaks) {\n    for (let existing of spectrum.peaks) {\n      if (Number(existing.wavelength) === Number(peak.x)) continue peakLoop;\n    }\n    addPeak(spectrum, {\n      wavelength: peak.x,\n      intensity: peak.y\n    });\n  }\n}\n\n/**\n * Class allowing manipulate one Raman spectrum\n * @class spectrum\n * @param {object} [json={}] - object containing a spectrum\n * @param {Array} [json.wavelength=[]] - wavelength\n * @param {Array} [json.intensity=[]] - intensity values\n */\nclass Spectrum {\n  constructor(json) {\n    this.wavelength = json.wavelength || [];\n    this.intensity = json.intensity || [];\n    this.peaks = [];\n    check(this);\n  }\n\n  /**\n   *\n   * @param {Array} [peaks=[]] array of peaks. Peaks are composed of transmittance, wavelength, kind\n   */\n  setPeaks(peaks = []) {\n    this.peaks = peaks;\n  }\n\n  peakPicking(targetWavelength, options = {}) {\n    peakPicking(this, targetWavelength, options);\n  }\n\n  getData() {\n    return { x: this.wavelength, y: this.intensity };\n  }\n}\n\nSpectrum.prototype.getAnnotations = function(options) {\n  return getAnnotations(this, options);\n};\n\nSpectrum.prototype.autoPeakPicking = function(options) {\n  return autoPeakPicking(this, options);\n};\n\nfunction check(spectrum) {\n  if (spectrum.wavelength.length > 0) {\n    spectrum.minWavelength = min(spectrum.wavelength);\n  }\n  if (spectrum.wavelength.length > 0) {\n    spectrum.maxWavelength = max(spectrum.wavelength);\n  }\n  if (spectrum.intensity.length > 0) {\n    spectrum.minIntensity = min(spectrum.intensity);\n  }\n  if (spectrum.intensity.length > 0) {\n    spectrum.maxIntensity = max(spectrum.intensity);\n  }\n}\n\n/**\n * Creates a new Chromatogram element based in a JCAMP string\n * @param {string} jcamp - String containing the JCAMP data\n * @return {Spectrum} - New class element with the given data\n */\nfunction fromJcamp(jcamp) {\n  const data = jcampconverter.convert(jcamp, { xy: true });\n  let spectrum = data.spectra[0].data[0];\n  spectrum = sortX(spectrum);\n  return new Spectrum({\n    wavelength: spectrum.x,\n    intensity: spectrum.y\n  });\n}\n\n/**\n * Creates a new Chromatogram element based in a Txt string\n * @param {string} text - String containing the data as CSV or TSV\n * @param {object} [options] - Options object for the parser\n * @param {string} [options.kind] - Absorbance or Transmisstance\n * @return {Spectrum} - New class element with the given data\n */\nfunction fromText(text, options = {}) {\n  options = Object.assign({}, options, { arrayType: 'xxyy' });\n  const data = xyParser.parseXY(text, options);\n  let spectrum = sortX({ x: data[0], y: data[1] });\n\n  return new Spectrum({\n    wavelength: spectrum.x,\n    intensity: spectrum.y\n  });\n}\n\nexports.Spectrum = Spectrum;\nexports.fromJcamp = fromJcamp;\nexports.fromText = fromText;\n","import isArray from 'is-any-array';\n\n/**\n * Computes the minimum of the given values\n * @param {Array<number>} input\n * @return {number}\n */\n\nfunction min(input) {\n  if (!isArray(input)) {\n    throw new TypeError('input must be an array');\n  }\n\n  if (input.length === 0) {\n    throw new TypeError('input must not be empty');\n  }\n\n  var min = input[0];\n\n  for (var i = 1; i < input.length; i++) {\n    if (input[i] < min) min = input[i];\n  }\n\n  return min;\n}\n\nexport default min;\n","import isArray from 'is-any-array';\n\n/**\n * Computes the maximum of the given values\n * @param {Array<number>} input\n * @return {number}\n */\n\nfunction max(input) {\n  if (!isArray(input)) {\n    throw new TypeError('input must be an array');\n  }\n\n  if (input.length === 0) {\n    throw new TypeError('input must not be empty');\n  }\n\n  var max = input[0];\n\n  for (var i = 1; i < input.length; i++) {\n    if (input[i] > max) max = input[i];\n  }\n\n  return max;\n}\n\nexport default max;\n","'use strict';\n\nmodule.exports.gsd = require('./gsd');\n\nmodule.exports.post = {\n  optimizePeaks: require('./post/optimizePeaks'),\n  joinBroadPeaks: require('./post/joinBroadPeaks'),\n  broadenPeaks: require('./post/broadenPeaks')\n};\n","'use strict';\n\nconst SG = require('ml-savitzky-golay-generalized');\n\nconst defaultOptions = {\n  sgOptions: {\n    windowSize: 9,\n    polynomial: 3\n  },\n  minMaxRatio: 0.00025,\n  broadRatio: 0.0,\n  maxCriteria: true,\n  smoothY: true,\n  realTopDetection: false,\n  heightFactor: 0,\n  boundaries: false,\n  derivativeThreshold: -1\n};\n\n/**\n * Global spectra deconvolution\n * @param {Array<number>} x - Independent variable\n * @param {Array<number>} yIn - Dependent variable\n * @param {object} [options] - Options object\n * @param {object} [options.sgOptions] - Options object for Savitzky-Golay filter. See https://github.com/mljs/savitzky-golay-generalized#options\n * @param {number} [options.sgOptions.windowSize = 9] - points to use in the approximations\n * @param {number} [options.sgOptions.polynomial = 3] - degree of the polynomial to use in the approximations\n * @param {number} [options.minMaxRatio = 0.00025] - Threshold to determine if a given peak should be considered as a noise\n * @param {number} [options.broadRatio = 0.00] - If `broadRatio` is higher than 0, then all the peaks which second derivative\n * smaller than `broadRatio * maxAbsSecondDerivative` will be marked with the soft mask equal to true.\n * @param {number} [options.noiseLevel = 0] - Noise threshold in spectrum units\n * @param {boolean} [options.maxCriteria = true] - Peaks are local maximum(true) or minimum(false)\n * @param {boolean} [options.smoothY = true] - Select the peak intensities from a smoothed version of the independent variables\n * @param {boolean} [options.realTopDetection = false] - Use a quadratic optimizations with the peak and its 3 closest neighbors\n * to determine the true x,y values of the peak?\n * @param {number} [options.heightFactor = 0] - Factor to multiply the calculated height (usually 2)\n * @param {boolean} [options.boundaries = false] - Return also the inflection points of the peaks\n * @param {number} [options.derivativeThreshold = -1] - Filters based on the amplitude of the first derivative\n * @return {Array<object>}\n */\nfunction gsd(x, yIn, options) {\n  options = Object.assign({}, defaultOptions, options);\n  let sgOptions = options.sgOptions;\n  const y = [].concat(yIn);\n\n  if (!('noiseLevel' in options)) {\n    // We have to know if x is equally spaced\n    var maxDx = 0;\n\n    var minDx = Number.MAX_VALUE;\n\n    var tmp;\n    for (let i = 0; i < x.length - 1; ++i) {\n      tmp = Math.abs(x[i + 1] - x[i]);\n      if (tmp < minDx) {\n        minDx = tmp;\n      }\n      if (tmp > maxDx) {\n        maxDx = tmp;\n      }\n    }\n\n    if ((maxDx - minDx) / maxDx < 0.05) {\n      options.noiseLevel = getNoiseLevel(y);\n    } else {\n      options.noiseLevel = 0;\n    }\n  }\n  const yCorrection = { m: 1, b: options.noiseLevel };\n  if (!options.maxCriteria) {\n    yCorrection.m = -1;\n    yCorrection.b *= -1;\n  }\n\n  for (let i = 0; i < y.length; i++) {\n    y[i] = yCorrection.m * y[i] - yCorrection.b;\n  }\n\n  for (let i = 0; i < y.length; i++) {\n    if (y[i] < 0) {\n      y[i] = 0;\n    }\n  }\n  // If the max difference between delta x is less than 5%, then, we can assume it to be equally spaced variable\n  let Y = y;\n  let dY, ddY;\n  if ((maxDx - minDx) / maxDx < 0.05) {\n    if (options.smoothY) {\n      Y = SG(y, x[1] - x[0], {\n        windowSize: sgOptions.windowSize,\n        polynomial: sgOptions.polynomial,\n        derivative: 0\n      });\n    }\n    dY = SG(y, x[1] - x[0], {\n      windowSize: sgOptions.windowSize,\n      polynomial: sgOptions.polynomial,\n      derivative: 1\n    });\n    ddY = SG(y, x[1] - x[0], {\n      windowSize: sgOptions.windowSize,\n      polynomial: sgOptions.polynomial,\n      derivative: 2\n    });\n  } else {\n    if (options.smoothY) {\n      Y = SG(y, x, {\n        windowSize: sgOptions.windowSize,\n        polynomial: sgOptions.polynomial,\n        derivative: 0\n      });\n    }\n    dY = SG(y, x, {\n      windowSize: sgOptions.windowSize,\n      polynomial: sgOptions.polynomial,\n      derivative: 1\n    });\n    ddY = SG(y, x, {\n      windowSize: sgOptions.windowSize,\n      polynomial: sgOptions.polynomial,\n      derivative: 2\n    });\n  }\n\n  const X = x;\n  const dx = x[1] - x[0];\n  var maxDdy = 0;\n  var maxY = 0;\n  for (let i = 0; i < Y.length; i++) {\n    if (Math.abs(ddY[i]) > maxDdy) {\n      maxDdy = Math.abs(ddY[i]);\n    }\n    if (Math.abs(Y[i]) > maxY) {\n      maxY = Math.abs(Y[i]);\n    }\n  }\n\n  var lastMax = null;\n  var lastMin = null;\n  var minddY = new Array(Y.length - 2);\n  var intervalL = new Array(Y.length);\n  var intervalR = new Array(Y.length);\n  var broadMask = new Array(Y.length - 2);\n  var minddYLen = 0;\n  var intervalLLen = 0;\n  var intervalRLen = 0;\n  var broadMaskLen = 0;\n  // By the intermediate value theorem We cannot find 2 consecutive maximum or minimum\n  for (let i = 1; i < Y.length - 1; ++i) {\n    // filter based on derivativeThreshold\n    if (Math.abs(dY[i]) > options.derivativeThreshold) {\n      // Minimum in first derivative\n      if (\n        (dY[i] < dY[i - 1] && dY[i] <= dY[i + 1]) ||\n        (dY[i] <= dY[i - 1] && dY[i] < dY[i + 1])\n      ) {\n        lastMin = {\n          x: X[i],\n          index: i\n        };\n        if (dx > 0 && lastMax !== null) {\n          intervalL[intervalLLen++] = lastMax;\n          intervalR[intervalRLen++] = lastMin;\n        }\n      }\n\n      // Maximum in first derivative\n      if (\n        (dY[i] >= dY[i - 1] && dY[i] > dY[i + 1]) ||\n        (dY[i] > dY[i - 1] && dY[i] >= dY[i + 1])\n      ) {\n        lastMax = {\n          x: X[i],\n          index: i\n        };\n        if (dx < 0 && lastMin !== null) {\n          intervalL[intervalLLen++] = lastMax;\n          intervalR[intervalRLen++] = lastMin;\n        }\n      }\n    }\n\n    // Minimum in second derivative\n    if (ddY[i] < ddY[i - 1] && ddY[i] < ddY[i + 1]) {\n      // TODO should we change this to have 3 arrays ? Huge overhead creating arrays\n      minddY[minddYLen++] = i; // ( [X[i], Y[i], i] );\n      broadMask[broadMaskLen++] =\n        Math.abs(ddY[i]) <= options.broadRatio * maxDdy;\n    }\n  }\n  minddY.length = minddYLen;\n  intervalL.length = intervalLLen;\n  intervalR.length = intervalRLen;\n  broadMask.length = broadMaskLen;\n\n  let signals = new Array(minddY.length);\n  let signalsLen = 0;\n  let lastK = -1;\n  let possible, frequency, distanceJ, minDistance, gettingCloser;\n  for (let j = 0; j < minddY.length; ++j) {\n    frequency = X[minddY[j]];\n    possible = -1;\n    let k = lastK + 1;\n    minDistance = Number.MAX_VALUE;\n    distanceJ = 0;\n    gettingCloser = true;\n    while (possible === -1 && k < intervalL.length && gettingCloser) {\n      distanceJ = Math.abs(frequency - (intervalL[k].x + intervalR[k].x) / 2);\n\n      // Still getting closer?\n      if (distanceJ < minDistance) {\n        minDistance = distanceJ;\n      } else {\n        gettingCloser = false;\n      }\n      if (distanceJ < Math.abs(intervalL[k].x - intervalR[k].x) / 2) {\n        possible = k;\n        lastK = k;\n      }\n      ++k;\n    }\n\n    if (possible !== -1) {\n      if (Math.abs(Y[minddY[j]]) > options.minMaxRatio * maxY) {\n        signals[signalsLen++] = {\n          index: minddY[j],\n          x: frequency,\n          y: (Y[minddY[j]] + yCorrection.b) / yCorrection.m,\n          width: Math.abs(intervalR[possible].x - intervalL[possible].x), // widthCorrection\n          soft: broadMask[j]\n        };\n        if (options.boundaries) {\n          signals[signalsLen - 1].left = intervalL[possible];\n          signals[signalsLen - 1].right = intervalR[possible];\n        }\n        if (options.heightFactor) {\n          let yLeft = Y[intervalL[possible].index];\n          let yRight = Y[intervalR[possible].index];\n          signals[signalsLen - 1].height =\n            options.heightFactor *\n            (signals[signalsLen - 1].y - (yLeft + yRight) / 2);\n        }\n      }\n    }\n  }\n  signals.length = signalsLen;\n\n  if (options.realTopDetection) {\n    realTopDetection(signals, X, Y);\n  }\n\n  // Correct the values to fit the original spectra data\n  for (let j = 0; j < signals.length; j++) {\n    signals[j].base = options.noiseLevel;\n  }\n\n  signals.sort(function (a, b) {\n    return a.x - b.x;\n  });\n\n  return signals;\n}\n\nfunction getNoiseLevel(y) {\n  var mean = 0;\n\n  var stddev = 0;\n  var length = y.length;\n  for (let i = 0; i < length; ++i) {\n    mean += y[i];\n  }\n  mean /= length;\n  var averageDeviations = new Array(length);\n  for (let i = 0; i < length; ++i) {\n    averageDeviations[i] = Math.abs(y[i] - mean);\n  }\n  averageDeviations.sort();\n  if (length % 2 === 1) {\n    stddev = averageDeviations[(length - 1) / 2] / 0.6745;\n  } else {\n    stddev =\n      (0.5 *\n        (averageDeviations[length / 2] + averageDeviations[length / 2 - 1])) /\n      0.6745;\n  }\n\n  return stddev;\n}\n\nfunction realTopDetection(peakList, x, y) {\n  var alpha, beta, gamma, p, currentPoint;\n  for (var j = 0; j < peakList.length; j++) {\n    currentPoint = peakList[j].index; // peakList[j][2];\n    // The detected peak could be moved 1 or 2 unit to left or right.\n    if (\n      y[currentPoint - 1] >= y[currentPoint - 2] &&\n      y[currentPoint - 1] >= y[currentPoint]\n    ) {\n      currentPoint--;\n    } else {\n      if (\n        y[currentPoint + 1] >= y[currentPoint] &&\n        y[currentPoint + 1] >= y[currentPoint + 2]\n      ) {\n        currentPoint++;\n      } else {\n        if (\n          y[currentPoint - 2] >= y[currentPoint - 3] &&\n          y[currentPoint - 2] >= y[currentPoint - 1]\n        ) {\n          currentPoint -= 2;\n        } else {\n          if (\n            y[currentPoint + 2] >= y[currentPoint + 1] &&\n            y[currentPoint + 2] >= y[currentPoint + 3]\n          ) {\n            currentPoint += 2;\n          }\n        }\n      }\n    }\n    // interpolation to a sin() function\n    if (\n      y[currentPoint - 1] > 0 &&\n      y[currentPoint + 1] > 0 &&\n      y[currentPoint] >= y[currentPoint - 1] &&\n      y[currentPoint] >= y[currentPoint + 1]\n    ) {\n      alpha = 20 * Math.log10(y[currentPoint - 1]);\n      beta = 20 * Math.log10(y[currentPoint]);\n      gamma = 20 * Math.log10(y[currentPoint + 1]);\n      p = (0.5 * (alpha - gamma)) / (alpha - 2 * beta + gamma);\n      // console.log(alpha, beta, gamma, `p: ${p}`);\n      // console.log(x[currentPoint]+\" \"+tmp+\" \"+currentPoint);\n      peakList[j].x =\n        x[currentPoint] + (x[currentPoint] - x[currentPoint - 1]) * p;\n      peakList[j].y =\n        y[currentPoint] -\n        0.25 * (y[currentPoint - 1] - y[currentPoint + 1]) * p;\n    }\n  }\n}\n\nmodule.exports = gsd;\n","//Code translate from Pascal source in http://pubs.acs.org/doi/pdf/10.1021/ac00205a007\nvar extend = require('extend');\nvar stat = require('ml-stat');\n\nvar defaultOptions = {\n    windowSize: 9,\n    derivative: 0,\n    polynomial: 3,\n};\n\n\nfunction SavitzkyGolay(data, h, options) {\n    options = extend({}, defaultOptions, options);\n\n    if ((options.windowSize % 2 === 0) || (options.windowSize < 5) || !(Number.isInteger(options.windowSize)))\n            throw new RangeError('Invalid window size (should be odd and at least 5 integer number)')\n\n\n    if (options.windowSize>data.length)\n        throw new RangeError('Window size is higher than the data length '+options.windowSize+\">\"+data.length);\n    if ((options.derivative < 0) || !(Number.isInteger(options.derivative)))\n        throw new RangeError('Derivative should be a positive integer');\n    if ((options.polynomial < 1) || !(Number.isInteger(options.polynomial)))\n        throw new RangeError('Polynomial should be a positive integer');\n    if (options.polynomial >= 6)\n        console.warn('You should not use polynomial grade higher than 5 if you are' +\n            ' not sure that your data arises from such a model. Possible polynomial oscillation problems');\n\n    var windowSize = options.windowSize;\n\n    var half = Math.floor(windowSize/2);\n    var np = data.length;\n    var ans = new Array(np);\n    var weights = fullWeights(windowSize,options.polynomial,options.derivative);\n    var hs = 0;\n    var constantH = true;\n    if( Object.prototype.toString.call( h ) === '[object Array]' ) {\n        constantH = false;\n    }\n    else{\n        hs = Math.pow(h, options.derivative);\n    }\n    //console.log(\"Constant h: \"+constantH);\n    //For the borders\n    for(var i=0;i<half;i++){\n        var wg1=weights[half-i-1];\n        var wg2=weights[half+i+1];\n        var d1 = 0,d2=0;\n        for (var l = 0; l < windowSize; l++){\n            d1 += wg1[l] * data[l];\n            d2 += wg2[l] * data[np-windowSize+l-1];\n        }\n        if(constantH){\n            ans[half-i-1] = d1/hs;\n            ans[np-half+i] = d2/hs;\n        }\n        else{\n            hs = getHs(h,half-i-1,half, options.derivative);\n            ans[half-i-1] = d1/hs;\n            hs = getHs(h,np-half+i,half, options.derivative);\n            ans[np-half+i] = d2/hs;\n        }\n    }\n    //For the internal points\n    var wg = weights[half];\n    for(var i=windowSize;i<np+1;i++){\n        var d = 0;\n        for (var l = 0; l < windowSize; l++)\n            d += wg[l] * data[l+i-windowSize];\n        if(!constantH)\n            hs = getHs(h,i-half-1,half, options.derivative);\n        ans[i-half-1] = d/hs;\n    }\n    return ans;\n}\n\nfunction getHs(h,center,half,derivative){\n    var hs = 0;\n    var count = 0;\n    for(var i=center-half;i<center+half;i++){\n        if(i>=0 && i < h.length-1){\n            hs+= (h[i+1]-h[i]);\n            count++;\n        }\n    }\n    return Math.pow(hs/count,derivative);\n}\n\nfunction GramPoly(i,m,k,s){\n    var Grampoly = 0;\n    if(k>0){\n        Grampoly = (4*k-2)/(k*(2*m-k+1))*(i*GramPoly(i,m,k-1,s) +\n            s*GramPoly(i,m,k-1,s-1)) - ((k-1)*(2*m+k))/(k*(2*m-k+1))*GramPoly(i,m,k-2,s);\n    }\n    else{\n        if(k==0&&s==0){\n            Grampoly=1;\n        }\n        else{\n            Grampoly=0;\n        }\n    }\n    //console.log(Grampoly);\n    return Grampoly;\n}\n\nfunction GenFact(a,b){\n    var gf=1;\n    if(a>=b){\n        for(var j=a-b+1;j<=a;j++){\n            gf*=j;\n        }\n    }\n    return gf;\n}\n\nfunction Weight(i,t,m,n,s){\n    var sum=0;\n    for(var k=0;k<=n;k++){\n        //console.log(k);\n        sum+=(2*k+1)*(GenFact(2*m,k)/GenFact(2*m+k+1,k+1))*GramPoly(i,m,k,0)*GramPoly(t,m,k,s)\n    }\n    return sum;\n}\n\n/**\n *\n * @param m  Number of points\n * @param n  Polynomial grade\n * @param s  Derivative\n */\nfunction fullWeights(m,n,s){\n    var weights = new Array(m);\n    var np = Math.floor(m/2);\n    for(var t=-np;t<=np;t++){\n        weights[t+np] = new Array(m);\n        for(var j=-np;j<=np;j++){\n            weights[t+np][j+np]=Weight(j,t,np,n,s);\n        }\n    }\n    return weights;\n}\n\n/*function entropy(data,h,options){\n    var trend = SavitzkyGolay(data,h,trendOptions);\n    var copy = new Array(data.length);\n    var sum = 0;\n    var max = 0;\n    for(var i=0;i<data.length;i++){\n        copy[i] = data[i]-trend[i];\n    }\n\n    sum/=data.length;\n    console.log(sum+\" \"+max);\n    console.log(stat.array.standardDeviation(copy));\n    console.log(Math.abs(stat.array.mean(copy))/stat.array.standardDeviation(copy));\n    return sum;\n\n}\n\n\n\nfunction guessWindowSize(data, h){\n    console.log(\"entropy \"+entropy(data,h,trendOptions));\n    return 5;\n}\n*/\nmodule.exports = SavitzkyGolay;\n \n","'use strict';\n\nvar hasOwn = Object.prototype.hasOwnProperty;\nvar toStr = Object.prototype.toString;\nvar defineProperty = Object.defineProperty;\nvar gOPD = Object.getOwnPropertyDescriptor;\n\nvar isArray = function isArray(arr) {\n\tif (typeof Array.isArray === 'function') {\n\t\treturn Array.isArray(arr);\n\t}\n\n\treturn toStr.call(arr) === '[object Array]';\n};\n\nvar isPlainObject = function isPlainObject(obj) {\n\tif (!obj || toStr.call(obj) !== '[object Object]') {\n\t\treturn false;\n\t}\n\n\tvar hasOwnConstructor = hasOwn.call(obj, 'constructor');\n\tvar hasIsPrototypeOf = obj.constructor && obj.constructor.prototype && hasOwn.call(obj.constructor.prototype, 'isPrototypeOf');\n\t// Not own constructor property must be Object\n\tif (obj.constructor && !hasOwnConstructor && !hasIsPrototypeOf) {\n\t\treturn false;\n\t}\n\n\t// Own properties are enumerated firstly, so to speed up,\n\t// if last one is own, then all properties are own.\n\tvar key;\n\tfor (key in obj) { /**/ }\n\n\treturn typeof key === 'undefined' || hasOwn.call(obj, key);\n};\n\n// If name is '__proto__', and Object.defineProperty is available, define __proto__ as an own property on target\nvar setProperty = function setProperty(target, options) {\n\tif (defineProperty && options.name === '__proto__') {\n\t\tdefineProperty(target, options.name, {\n\t\t\tenumerable: true,\n\t\t\tconfigurable: true,\n\t\t\tvalue: options.newValue,\n\t\t\twritable: true\n\t\t});\n\t} else {\n\t\ttarget[options.name] = options.newValue;\n\t}\n};\n\n// Return undefined instead of __proto__ if '__proto__' is not an own property\nvar getProperty = function getProperty(obj, name) {\n\tif (name === '__proto__') {\n\t\tif (!hasOwn.call(obj, name)) {\n\t\t\treturn void 0;\n\t\t} else if (gOPD) {\n\t\t\t// In early versions of node, obj['__proto__'] is buggy when obj has\n\t\t\t// __proto__ as an own property. Object.getOwnPropertyDescriptor() works.\n\t\t\treturn gOPD(obj, name).value;\n\t\t}\n\t}\n\n\treturn obj[name];\n};\n\nmodule.exports = function extend() {\n\tvar options, name, src, copy, copyIsArray, clone;\n\tvar target = arguments[0];\n\tvar i = 1;\n\tvar length = arguments.length;\n\tvar deep = false;\n\n\t// Handle a deep copy situation\n\tif (typeof target === 'boolean') {\n\t\tdeep = target;\n\t\ttarget = arguments[1] || {};\n\t\t// skip the boolean and the target\n\t\ti = 2;\n\t}\n\tif (target == null || (typeof target !== 'object' && typeof target !== 'function')) {\n\t\ttarget = {};\n\t}\n\n\tfor (; i < length; ++i) {\n\t\toptions = arguments[i];\n\t\t// Only deal with non-null/undefined values\n\t\tif (options != null) {\n\t\t\t// Extend the base object\n\t\t\tfor (name in options) {\n\t\t\t\tsrc = getProperty(target, name);\n\t\t\t\tcopy = getProperty(options, name);\n\n\t\t\t\t// Prevent never-ending loop\n\t\t\t\tif (target !== copy) {\n\t\t\t\t\t// Recurse if we're merging plain objects or arrays\n\t\t\t\t\tif (deep && copy && (isPlainObject(copy) || (copyIsArray = isArray(copy)))) {\n\t\t\t\t\t\tif (copyIsArray) {\n\t\t\t\t\t\t\tcopyIsArray = false;\n\t\t\t\t\t\t\tclone = src && isArray(src) ? src : [];\n\t\t\t\t\t\t} else {\n\t\t\t\t\t\t\tclone = src && isPlainObject(src) ? src : {};\n\t\t\t\t\t\t}\n\n\t\t\t\t\t\t// Never move original objects, clone them\n\t\t\t\t\t\tsetProperty(target, { name: name, newValue: extend(deep, clone, copy) });\n\n\t\t\t\t\t// Don't bring in undefined values\n\t\t\t\t\t} else if (typeof copy !== 'undefined') {\n\t\t\t\t\t\tsetProperty(target, { name: name, newValue: copy });\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t}\n\n\t// Return the modified object\n\treturn target;\n};\n","'use strict';\n\nexports.array = require('./array');\nexports.matrix = require('./matrix');\n","'use strict';\nvar arrayStat = require('./array');\n\n// https://github.com/accord-net/framework/blob/development/Sources/Accord.Statistics/Tools.cs\n\nfunction entropy(matrix, eps) {\n    if (typeof(eps) === 'undefined') {\n        eps = 0;\n    }\n    var sum = 0,\n        l1 = matrix.length,\n        l2 = matrix[0].length;\n    for (var i = 0; i < l1; i++) {\n        for (var j = 0; j < l2; j++) {\n            sum += matrix[i][j] * Math.log(matrix[i][j] + eps);\n        }\n    }\n    return -sum;\n}\n\nfunction mean(matrix, dimension) {\n    if (typeof(dimension) === 'undefined') {\n        dimension = 0;\n    }\n    var rows = matrix.length,\n        cols = matrix[0].length,\n        theMean, N, i, j;\n\n    if (dimension === -1) {\n        theMean = [0];\n        N = rows * cols;\n        for (i = 0; i < rows; i++) {\n            for (j = 0; j < cols; j++) {\n                theMean[0] += matrix[i][j];\n            }\n        }\n        theMean[0] /= N;\n    } else if (dimension === 0) {\n        theMean = new Array(cols);\n        N = rows;\n        for (j = 0; j < cols; j++) {\n            theMean[j] = 0;\n            for (i = 0; i < rows; i++) {\n                theMean[j] += matrix[i][j];\n            }\n            theMean[j] /= N;\n        }\n    } else if (dimension === 1) {\n        theMean = new Array(rows);\n        N = cols;\n        for (j = 0; j < rows; j++) {\n            theMean[j] = 0;\n            for (i = 0; i < cols; i++) {\n                theMean[j] += matrix[j][i];\n            }\n            theMean[j] /= N;\n        }\n    } else {\n        throw new Error('Invalid dimension');\n    }\n    return theMean;\n}\n\nfunction standardDeviation(matrix, means, unbiased) {\n    var vari = variance(matrix, means, unbiased), l = vari.length;\n    for (var i = 0; i < l; i++) {\n        vari[i] = Math.sqrt(vari[i]);\n    }\n    return vari;\n}\n\nfunction variance(matrix, means, unbiased) {\n    if (typeof(unbiased) === 'undefined') {\n        unbiased = true;\n    }\n    means = means || mean(matrix);\n    var rows = matrix.length;\n    if (rows === 0) return [];\n    var cols = matrix[0].length;\n    var vari = new Array(cols);\n\n    for (var j = 0; j < cols; j++) {\n        var sum1 = 0, sum2 = 0, x = 0;\n        for (var i = 0; i < rows; i++) {\n            x = matrix[i][j] - means[j];\n            sum1 += x;\n            sum2 += x * x;\n        }\n        if (unbiased) {\n            vari[j] = (sum2 - ((sum1 * sum1) / rows)) / (rows - 1);\n        } else {\n            vari[j] = (sum2 - ((sum1 * sum1) / rows)) / rows;\n        }\n    }\n    return vari;\n}\n\nfunction median(matrix) {\n    var rows = matrix.length, cols = matrix[0].length;\n    var medians = new Array(cols);\n\n    for (var i = 0; i < cols; i++) {\n        var data = new Array(rows);\n        for (var j = 0; j < rows; j++) {\n            data[j] = matrix[j][i];\n        }\n        data.sort();\n        var N = data.length;\n        if (N % 2 === 0) {\n            medians[i] = (data[N / 2] + data[(N / 2) - 1]) * 0.5;\n        } else {\n            medians[i] = data[Math.floor(N / 2)];\n        }\n    }\n    return medians;\n}\n\nfunction mode(matrix) {\n    var rows = matrix.length,\n        cols = matrix[0].length,\n        modes = new Array(cols),\n        i, j;\n    for (i = 0; i < cols; i++) {\n        var itemCount = new Array(rows);\n        for (var k = 0; k < rows; k++) {\n            itemCount[k] = 0;\n        }\n        var itemArray = new Array(rows);\n        var count = 0;\n\n        for (j = 0; j < rows; j++) {\n            var index = itemArray.indexOf(matrix[j][i]);\n            if (index >= 0) {\n                itemCount[index]++;\n            } else {\n                itemArray[count] = matrix[j][i];\n                itemCount[count] = 1;\n                count++;\n            }\n        }\n\n        var maxValue = 0, maxIndex = 0;\n        for (j = 0; j < count; j++) {\n            if (itemCount[j] > maxValue) {\n                maxValue = itemCount[j];\n                maxIndex = j;\n            }\n        }\n\n        modes[i] = itemArray[maxIndex];\n    }\n    return modes;\n}\n\nfunction skewness(matrix, unbiased) {\n    if (typeof(unbiased) === 'undefined') unbiased = true;\n    var means = mean(matrix);\n    var n = matrix.length, l = means.length;\n    var skew = new Array(l);\n\n    for (var j = 0; j < l; j++) {\n        var s2 = 0, s3 = 0;\n        for (var i = 0; i < n; i++) {\n            var dev = matrix[i][j] - means[j];\n            s2 += dev * dev;\n            s3 += dev * dev * dev;\n        }\n\n        var m2 = s2 / n;\n        var m3 = s3 / n;\n        var g = m3 / Math.pow(m2, 3 / 2);\n\n        if (unbiased) {\n            var a = Math.sqrt(n * (n - 1));\n            var b = n - 2;\n            skew[j] = (a / b) * g;\n        } else {\n            skew[j] = g;\n        }\n    }\n    return skew;\n}\n\nfunction kurtosis(matrix, unbiased) {\n    if (typeof(unbiased) === 'undefined') unbiased = true;\n    var means = mean(matrix);\n    var n = matrix.length, m = matrix[0].length;\n    var kurt = new Array(m);\n\n    for (var j = 0; j < m; j++) {\n        var s2 = 0, s4 = 0;\n        for (var i = 0; i < n; i++) {\n            var dev = matrix[i][j] - means[j];\n            s2 += dev * dev;\n            s4 += dev * dev * dev * dev;\n        }\n        var m2 = s2 / n;\n        var m4 = s4 / n;\n\n        if (unbiased) {\n            var v = s2 / (n - 1);\n            var a = (n * (n + 1)) / ((n - 1) * (n - 2) * (n - 3));\n            var b = s4 / (v * v);\n            var c = ((n - 1) * (n - 1)) / ((n - 2) * (n - 3));\n            kurt[j] = a * b - 3 * c;\n        } else {\n            kurt[j] = m4 / (m2 * m2) - 3;\n        }\n    }\n    return kurt;\n}\n\nfunction standardError(matrix) {\n    var samples = matrix.length;\n    var standardDeviations = standardDeviation(matrix), l = standardDeviations.length;\n    var standardErrors = new Array(l);\n    var sqrtN = Math.sqrt(samples);\n\n    for (var i = 0; i < l; i++) {\n        standardErrors[i] = standardDeviations[i] / sqrtN;\n    }\n    return standardErrors;\n}\n\nfunction covariance(matrix, dimension) {\n    return scatter(matrix, undefined, dimension);\n}\n\nfunction scatter(matrix, divisor, dimension) {\n    if (typeof(dimension) === 'undefined') {\n        dimension = 0;\n    }\n    if (typeof(divisor) === 'undefined') {\n        if (dimension === 0) {\n            divisor = matrix.length - 1;\n        } else if (dimension === 1) {\n            divisor = matrix[0].length - 1;\n        }\n    }\n    var means = mean(matrix, dimension),\n        rows = matrix.length;\n    if (rows === 0) {\n        return [[]];\n    }\n    var cols = matrix[0].length,\n        cov, i, j, s, k;\n\n    if (dimension === 0) {\n        cov = new Array(cols);\n        for (i = 0; i < cols; i++) {\n            cov[i] = new Array(cols);\n        }\n        for (i = 0; i < cols; i++) {\n            for (j = i; j < cols; j++) {\n                s = 0;\n                for (k = 0; k < rows; k++) {\n                    s += (matrix[k][j] - means[j]) * (matrix[k][i] - means[i]);\n                }\n                s /= divisor;\n                cov[i][j] = s;\n                cov[j][i] = s;\n            }\n        }\n    } else if (dimension === 1) {\n        cov = new Array(rows);\n        for (i = 0; i < rows; i++) {\n            cov[i] = new Array(rows);\n        }\n        for (i = 0; i < rows; i++) {\n            for (j = i; j < rows; j++) {\n                s = 0;\n                for (k = 0; k < cols; k++) {\n                    s += (matrix[j][k] - means[j]) * (matrix[i][k] - means[i]);\n                }\n                s /= divisor;\n                cov[i][j] = s;\n                cov[j][i] = s;\n            }\n        }\n    } else {\n        throw new Error('Invalid dimension');\n    }\n\n    return cov;\n}\n\nfunction correlation(matrix) {\n    var means = mean(matrix),\n        standardDeviations = standardDeviation(matrix, true, means),\n        scores = zScores(matrix, means, standardDeviations),\n        rows = matrix.length,\n        cols = matrix[0].length,\n        i, j;\n\n    var cor = new Array(cols);\n    for (i = 0; i < cols; i++) {\n        cor[i] = new Array(cols);\n    }\n    for (i = 0; i < cols; i++) {\n        for (j = i; j < cols; j++) {\n            var c = 0;\n            for (var k = 0, l = scores.length; k < l; k++) {\n                c += scores[k][j] * scores[k][i];\n            }\n            c /= rows - 1;\n            cor[i][j] = c;\n            cor[j][i] = c;\n        }\n    }\n    return cor;\n}\n\nfunction zScores(matrix, means, standardDeviations) {\n    means = means || mean(matrix);\n    if (typeof(standardDeviations) === 'undefined') standardDeviations = standardDeviation(matrix, true, means);\n    return standardize(center(matrix, means, false), standardDeviations, true);\n}\n\nfunction center(matrix, means, inPlace) {\n    means = means || mean(matrix);\n    var result = matrix,\n        l = matrix.length,\n        i, j, jj;\n\n    if (!inPlace) {\n        result = new Array(l);\n        for (i = 0; i < l; i++) {\n            result[i] = new Array(matrix[i].length);\n        }\n    }\n\n    for (i = 0; i < l; i++) {\n        var row = result[i];\n        for (j = 0, jj = row.length; j < jj; j++) {\n            row[j] = matrix[i][j] - means[j];\n        }\n    }\n    return result;\n}\n\nfunction standardize(matrix, standardDeviations, inPlace) {\n    if (typeof(standardDeviations) === 'undefined') standardDeviations = standardDeviation(matrix);\n    var result = matrix,\n        l = matrix.length,\n        i, j, jj;\n\n    if (!inPlace) {\n        result = new Array(l);\n        for (i = 0; i < l; i++) {\n            result[i] = new Array(matrix[i].length);\n        }\n    }\n\n    for (i = 0; i < l; i++) {\n        var resultRow = result[i];\n        var sourceRow = matrix[i];\n        for (j = 0, jj = resultRow.length; j < jj; j++) {\n            if (standardDeviations[j] !== 0 && !isNaN(standardDeviations[j])) {\n                resultRow[j] = sourceRow[j] / standardDeviations[j];\n            }\n        }\n    }\n    return result;\n}\n\nfunction weightedVariance(matrix, weights) {\n    var means = mean(matrix);\n    var rows = matrix.length;\n    if (rows === 0) return [];\n    var cols = matrix[0].length;\n    var vari = new Array(cols);\n\n    for (var j = 0; j < cols; j++) {\n        var sum = 0;\n        var a = 0, b = 0;\n\n        for (var i = 0; i < rows; i++) {\n            var z = matrix[i][j] - means[j];\n            var w = weights[i];\n\n            sum += w * (z * z);\n            b += w;\n            a += w * w;\n        }\n\n        vari[j] = sum * (b / (b * b - a));\n    }\n\n    return vari;\n}\n\nfunction weightedMean(matrix, weights, dimension) {\n    if (typeof(dimension) === 'undefined') {\n        dimension = 0;\n    }\n    var rows = matrix.length;\n    if (rows === 0) return [];\n    var cols = matrix[0].length,\n        means, i, ii, j, w, row;\n\n    if (dimension === 0) {\n        means = new Array(cols);\n        for (i = 0; i < cols; i++) {\n            means[i] = 0;\n        }\n        for (i = 0; i < rows; i++) {\n            row = matrix[i];\n            w = weights[i];\n            for (j = 0; j < cols; j++) {\n                means[j] += row[j] * w;\n            }\n        }\n    } else if (dimension === 1) {\n        means = new Array(rows);\n        for (i = 0; i < rows; i++) {\n            means[i] = 0;\n        }\n        for (j = 0; j < rows; j++) {\n            row = matrix[j];\n            w = weights[j];\n            for (i = 0; i < cols; i++) {\n                means[j] += row[i] * w;\n            }\n        }\n    } else {\n        throw new Error('Invalid dimension');\n    }\n\n    var weightSum = arrayStat.sum(weights);\n    if (weightSum !== 0) {\n        for (i = 0, ii = means.length; i < ii; i++) {\n            means[i] /= weightSum;\n        }\n    }\n    return means;\n}\n\nfunction weightedCovariance(matrix, weights, means, dimension) {\n    dimension = dimension || 0;\n    means = means || weightedMean(matrix, weights, dimension);\n    var s1 = 0, s2 = 0;\n    for (var i = 0, ii = weights.length; i < ii; i++) {\n        s1 += weights[i];\n        s2 += weights[i] * weights[i];\n    }\n    var factor = s1 / (s1 * s1 - s2);\n    return weightedScatter(matrix, weights, means, factor, dimension);\n}\n\nfunction weightedScatter(matrix, weights, means, factor, dimension) {\n    dimension = dimension || 0;\n    means = means || weightedMean(matrix, weights, dimension);\n    if (typeof(factor) === 'undefined') {\n        factor = 1;\n    }\n    var rows = matrix.length;\n    if (rows === 0) {\n        return [[]];\n    }\n    var cols = matrix[0].length,\n        cov, i, j, k, s;\n\n    if (dimension === 0) {\n        cov = new Array(cols);\n        for (i = 0; i < cols; i++) {\n            cov[i] = new Array(cols);\n        }\n        for (i = 0; i < cols; i++) {\n            for (j = i; j < cols; j++) {\n                s = 0;\n                for (k = 0; k < rows; k++) {\n                    s += weights[k] * (matrix[k][j] - means[j]) * (matrix[k][i] - means[i]);\n                }\n                cov[i][j] = s * factor;\n                cov[j][i] = s * factor;\n            }\n        }\n    } else if (dimension === 1) {\n        cov = new Array(rows);\n        for (i = 0; i < rows; i++) {\n            cov[i] = new Array(rows);\n        }\n        for (i = 0; i < rows; i++) {\n            for (j = i; j < rows; j++) {\n                s = 0;\n                for (k = 0; k < cols; k++) {\n                    s += weights[k] * (matrix[j][k] - means[j]) * (matrix[i][k] - means[i]);\n                }\n                cov[i][j] = s * factor;\n                cov[j][i] = s * factor;\n            }\n        }\n    } else {\n        throw new Error('Invalid dimension');\n    }\n\n    return cov;\n}\n\nmodule.exports = {\n    entropy: entropy,\n    mean: mean,\n    standardDeviation: standardDeviation,\n    variance: variance,\n    median: median,\n    mode: mode,\n    skewness: skewness,\n    kurtosis: kurtosis,\n    standardError: standardError,\n    covariance: covariance,\n    scatter: scatter,\n    correlation: correlation,\n    zScores: zScores,\n    center: center,\n    standardize: standardize,\n    weightedVariance: weightedVariance,\n    weightedMean: weightedMean,\n    weightedCovariance: weightedCovariance,\n    weightedScatter: weightedScatter\n};\n","/**\n * Created by acastillo on 9/6/15.\n */\n'use strict';\n\nvar optimize = require('ml-optimize-lorentzian');\n\nfunction sampleFunction(from, to, x, y, lastIndex) {\n  var nbPoints = x.length;\n  var sampleX = [];\n  var sampleY = [];\n  var direction = Math.sign(x[1] - x[0]); // Direction of the derivative\n  if (direction === -1) {\n    lastIndex[0] = x.length - 1;\n  }\n\n  var delta = Math.abs(to - from) / 2;\n  var mid = (from + to) / 2;\n  var stop = false;\n  var index = lastIndex[0];\n  while (!stop && index < nbPoints && index >= 0) {\n    if (Math.abs(x[index] - mid) <= delta) {\n      sampleX.push(x[index]);\n      sampleY.push(y[index]);\n      index += direction;\n    } else {\n      // It is outside the range.\n      if (Math.sign(mid - x[index]) === 1) {\n        // We'll reach the mid going in the current direction\n        index += direction;\n      } else {\n        // There is not more peaks in the current range\n        stop = true;\n      }\n    }\n    // console.log(sampleX);\n  }\n  lastIndex[0] = index;\n  return [sampleX, sampleY];\n}\n\nmodule.exports = function optimizePeaks(peakList, x, y, n, fnType) {\n  var i;\n  var j;\n\n  var lastIndex = [0];\n  var groups = groupPeaks(peakList, n);\n  var result = [];\n  var factor = 1;\n  if (fnType === 'gaussian') {\n    factor = 1.17741;\n  } // From https://en.wikipedia.org/wiki/Gaussian_function#Properties\n  var sampling, error, opts;\n  for (i = 0; i < groups.length; i++) {\n    var peaks = groups[i].group;\n    if (peaks.length > 1) {\n      // Multiple peaks\n      // console.log(\"Pending group of overlaped peaks \"+peaks.length);\n      // console.log(\"here1\");\n      // console.log(groups[i].limits);\n      sampling = sampleFunction(\n        groups[i].limits[0] - groups[i].limits[1],\n        groups[i].limits[0] + groups[i].limits[1],\n        x,\n        y,\n        lastIndex\n      );\n      // console.log(sampling);\n      if (sampling[0].length > 5) {\n        error = peaks[0].width / 1000;\n        opts = [3, 100, error, error, error, error * 10, error * 10, 11, 9, 1];\n        // var gauss = Opt.optimizeSingleGaussian(sampling[0], sampling[1], opts, peaks);\n        var optPeaks = [];\n        if (fnType === 'gaussian') {\n          optPeaks = optimize.optimizeGaussianSum(sampling, peaks, opts);\n        } else {\n          if (fnType === 'lorentzian') {\n            optPeaks = optimize.optimizeLorentzianSum(sampling, peaks, opts);\n          }\n        }\n        // console.log(optPeak);\n        for (j = 0; j < optPeaks.length; j++) {\n          result.push({\n            x: optPeaks[j][0][0],\n            y: optPeaks[j][1][0],\n            width: optPeaks[j][2][0] * factor\n          });\n        }\n      }\n    } else {\n      // Single peak\n      peaks = peaks[0];\n      sampling = sampleFunction(\n        peaks.x - n * peaks.width,\n        peaks.x + n * peaks.width,\n        x,\n        y,\n        lastIndex\n      );\n      // console.log(\"here2\");\n      // console.log(groups[i].limits);\n      if (sampling[0].length > 5) {\n        error = peaks.width / 1000;\n        opts = [3, 100, error, error, error, error * 10, error * 10, 11, 9, 1];\n        // var gauss = Opt.optimizeSingleGaussian(sampling[0], sampling[1], opts, peaks);\n        // var gauss = Opt.optimizeSingleGaussian([sampling[0],sampling[1]], peaks, opts);\n        var optPeak = [];\n        if (fnType === 'gaussian') {\n          optPeak = optimize.optimizeSingleGaussian(\n            [sampling[0], sampling[1]],\n            peaks,\n            opts\n          );\n        } else {\n          if (fnType === 'lorentzian') {\n            optPeak = optimize.optimizeSingleLorentzian(\n              [sampling[0], sampling[1]],\n              peaks,\n              opts\n            );\n          }\n        }\n        // console.log(optPeak);\n        result.push({\n          x: optPeak[0][0],\n          y: optPeak[1][0],\n          width: optPeak[2][0] * factor\n        }); // From https://en.wikipedia.org/wiki/Gaussian_function#Properties}\n      }\n    }\n  }\n  return result;\n};\n\nfunction groupPeaks(peakList, nL) {\n  var group = [];\n  var groups = [];\n  var i, j;\n  var limits = [peakList[0].x, nL * peakList[0].width];\n  var upperLimit, lowerLimit;\n  // Merge forward\n  for (i = 0; i < peakList.length; i++) {\n    // If the 2 things overlaps\n    if (\n      Math.abs(peakList[i].x - limits[0]) <\n      nL * peakList[i].width + limits[1]\n    ) {\n      // Add the peak to the group\n      group.push(peakList[i]);\n      // Update the group limits\n      upperLimit = limits[0] + limits[1];\n      if (peakList[i].x + nL * peakList[i].width > upperLimit) {\n        upperLimit = peakList[i].x + nL * peakList[i].width;\n      }\n      lowerLimit = limits[0] - limits[1];\n      if (peakList[i].x - nL * peakList[i].width < lowerLimit) {\n        lowerLimit = peakList[i].x - nL * peakList[i].width;\n      }\n      limits = [\n        (upperLimit + lowerLimit) / 2,\n        Math.abs(upperLimit - lowerLimit) / 2\n      ];\n    } else {\n      groups.push({ limits: limits, group: group });\n      // var optmimalPeak = fitSpectrum(group,limits,spectrum);\n      group = [peakList[i]];\n      limits = [peakList[i].x, nL * peakList[i].width];\n    }\n  }\n  groups.push({ limits: limits, group: group });\n  // Merge backward\n  for (i = groups.length - 2; i >= 0; i--) {\n    // The groups overlaps\n    if (\n      Math.abs(groups[i].limits[0] - groups[i + 1].limits[0]) <\n      (groups[i].limits[1] + groups[i + 1].limits[1]) / 2\n    ) {\n      for (j = 0; j < groups[i + 1].group.length; j++) {\n        groups[i].group.push(groups[i + 1].group[j]);\n      }\n      upperLimit = groups[i].limits[0] + groups[i].limits[1];\n      if (groups[i + 1].limits[0] + groups[i + 1].limits[1] > upperLimit) {\n        upperLimit = groups[i + 1].limits[0] + groups[i + 1].limits[1];\n      }\n      lowerLimit = groups[i].limits[0] - groups[i].limits[1];\n      if (groups[i + 1].limits[0] - groups[i + 1].limits[1] < lowerLimit) {\n        lowerLimit = groups[i + 1].limits[0] - groups[i + 1].limits[1];\n      }\n      // console.log(limits);\n      groups[i].limits = [\n        (upperLimit + lowerLimit) / 2,\n        Math.abs(upperLimit - lowerLimit) / 2\n      ];\n\n      groups.splice(i + 1, 1);\n    }\n  }\n  return groups;\n}\n","'use strict';\n\nmodule.exports = require('./LM');\nmodule.exports.Matrix = require('ml-matrix');\nmodule.exports.Matrix.algebra = require('./algebra');\n","/**\n * Created by acastillo on 8/5/15.\n */\nvar Matrix = require(\"ml-matrix\");\nvar math = require(\"./algebra\");\n\nvar DEBUG = false;\n/** Levenberg Marquardt curve-fitting: minimize sum of weighted squared residuals\n ----------  INPUT  VARIABLES  -----------\n func   = function of n independent variables, 't', and m parameters, 'p',\n returning the simulated model: y_hat = func(t,p,c)\n p      = n-vector of initial guess of parameter values\n t      = m-vectors or matrix of independent variables (used as arg to func)\n y_dat  = m-vectors or matrix of data to be fit by func(t,p)\n weight = weighting vector for least squares fit ( weight >= 0 ) ...\n inverse of the standard measurement errors\n Default:  sqrt(d.o.f. / ( y_dat' * y_dat ))\n dp     = fractional increment of 'p' for numerical derivatives\n dp(j)>0 central differences calculated\n dp(j)<0 one sided 'backwards' differences calculated\n dp(j)=0 sets corresponding partials to zero; i.e. holds p(j) fixed\n Default:  0.001;\n p_min  = n-vector of lower bounds for parameter values\n p_max  = n-vector of upper bounds for parameter values\n c      = an optional matrix of values passed to func(t,p,c)\n opts   = vector of algorithmic parameters\n parameter    defaults    meaning\n opts(1)  =  prnt            3        >1 intermediate results; >2 plots\n opts(2)  =  MaxIter      10*Npar     maximum number of iterations\n opts(3)  =  epsilon_1       1e-3     convergence tolerance for gradient\n opts(4)  =  epsilon_2       1e-3     convergence tolerance for parameters\n opts(5)  =  epsilon_3       1e-3     convergence tolerance for Chi-square\n opts(6)  =  epsilon_4       1e-2     determines acceptance of a L-M step\n opts(7)  =  lambda_0        1e-2     initial value of L-M paramter\n opts(8)  =  lambda_UP_fac   11       factor for increasing lambda\n opts(9)  =  lambda_DN_fac    9       factor for decreasing lambda\n opts(10) =  Update_Type      1       1: Levenberg-Marquardt lambda update\n 2: Quadratic update\n 3: Nielsen's lambda update equations\n\n ----------  OUTPUT  VARIABLES  -----------\n p       = least-squares optimal estimate of the parameter values\n X2      = Chi squared criteria\n sigma_p = asymptotic standard error of the parameters\n sigma_y = asymptotic standard error of the curve-fit\n corr    = correlation matrix of the parameters\n R_sq    = R-squared cofficient of multiple determination\n cvg_hst = convergence history\n\n Henri Gavin, Dept. Civil & Environ. Engineering, Duke Univ. 22 Sep 2013\n modified from: http://octave.sourceforge.net/optim/function/leasqr.html\n using references by\n Press, et al., Numerical Recipes, Cambridge Univ. Press, 1992, Chapter 15.\n Sam Roweis       http://www.cs.toronto.edu/~roweis/notes/lm.pdf\n Manolis Lourakis http://www.ics.forth.gr/~lourakis/levmar/levmar.pdf\n Hans Nielson     http://www2.imm.dtu.dk/~hbn/publ/TR9905.ps\n Mathworks        optimization toolbox reference manual\n K. Madsen, H.B., Nielsen, and O. Tingleff\n http://www2.imm.dtu.dk/pubdb/views/edoc_download.php/3215/pdf/imm3215.pdf\n */\nvar LM = {\n\n    optimize: function(func,p,t,y_dat,weight,dp,p_min,p_max,c,opts){\n\n        var tensor_parameter = 0;\t\t\t// set to 1 of parameter is a tensor\n\n        var iteration  = 0;\t\t\t// iteration counter\n        //func_calls = 0;\t\t\t// running count of function evaluations\n\n        if((typeof p[0])!=\"object\"){\n            for(var i=0;i< p.length;i++){\n                p[i]=[p[i]];\n            }\n\n        }\n        //p = p(:); y_dat = y_dat(:); \t\t// make column vectors\n        var i,k;\n        var eps = 2^-52;\n        var Npar   = p.length;//length(p); \t\t\t// number of parameters\n        var Npnt   = y_dat.length;//length(y_dat);\t\t// number of data points\n        var p_old  = Matrix.zeros(Npar,1);\t\t// previous set of parameters\n        var y_old  = Matrix.zeros(Npnt,1);\t\t// previous model, y_old = y_hat(t;p_old)\n        var X2     = 1e-2/eps;\t\t\t// a really big initial Chi-sq value\n        var X2_old = 1e-2/eps;\t\t\t// a really big initial Chi-sq value\n        var J =  Matrix.zeros(Npnt,Npar);\n\n\n        if (t.length != y_dat.length) {\n            console.log('lm.m error: the length of t must equal the length of y_dat');\n\n            length_t = t.length;\n            length_y_dat = y_dat.length;\n            var X2 = 0, corr = 0, sigma_p = 0, sigma_y = 0, R_sq = 0, cvg_hist = 0;\n            if (!tensor_parameter) {\n                return;\n            }\n        }\n\n        weight = weight||Math.sqrt((Npnt-Npar+1)/(math.multiply(math.transpose(y_dat),y_dat)));\n        dp = dp || 0.001;\n        p_min   = p_min || math.multiply(Math.abs(p),-100);\n        p_max   = p_max || math.multiply(Math.abs(p),100);\n        c = c || 1;\n        // Algorithmic Paramters\n        //prnt MaxIter  eps1  eps2  epx3  eps4  lam0  lamUP lamDN UpdateType\n        opts = opts ||[  3,10*Npar, 1e-3, 1e-3, 1e-3, 1e-2, 1e-2, 11, 9, 1 ];\n\n        var prnt          = opts[0];\t// >1 intermediate results; >2 plots\n        var MaxIter       = opts[1];\t// maximum number of iterations\n        var epsilon_1     = opts[2];\t// convergence tolerance for gradient\n        var epsilon_2     = opts[3];\t// convergence tolerance for parameter\n        var epsilon_3     = opts[4];\t// convergence tolerance for Chi-square\n        var epsilon_4     = opts[5];\t// determines acceptance of a L-M step\n        var lambda_0      = opts[6];\t// initial value of damping paramter, lambda\n        var lambda_UP_fac = opts[7];\t// factor for increasing lambda\n        var lambda_DN_fac = opts[8];\t// factor for decreasing lambda\n        var Update_Type   = opts[9];\t// 1: Levenberg-Marquardt lambda update\n        // 2: Quadratic update\n        // 3: Nielsen's lambda update equations\n\n        if ( tensor_parameter && prnt == 3 ) prnt = 2;\n\n\n        if(!dp.length || dp.length == 1){\n            var dp_array = new Array(Npar);\n            for(var i=0;i<Npar;i++)\n                dp_array[i]=[dp];\n            dp=dp_array;\n        }\n\n        // indices of the parameters to be fit\n        var idx   = [];\n        for(i=0;i<dp.length;i++){\n            if(dp[i][0]!=0){\n                idx.push(i);\n            }\n        }\n\n        var Nfit = idx.length;\t\t\t// number of parameters to fit\n        var stop = false;\t\t\t\t// termination flag\n\n        var weight_sq = null;\n        //console.log(weight);\n        if ( !weight.length || weight.length < Npnt )\t{\n            // squared weighting vector\n            //weight_sq = ( weight(1)*ones(Npnt,1) ).^2;\n            //console.log(\"weight[0] \"+typeof weight[0]);\n            var tmp = math.multiply(Matrix.ones(Npnt,1),weight[0]);\n            weight_sq = math.dotMultiply(tmp,tmp);\n        }\n        else{\n            //weight_sq = (weight(:)).^2;\n            weight_sq = math.dotMultiply(weight,weight);\n        }\n\n\n        // initialize Jacobian with finite difference calculation\n        //console.log(\"J \"+weight_sq);\n        var result = this.lm_matx(func,t,p_old,y_old,1,J,p,y_dat,weight_sq,dp,c);\n        var JtWJ = result.JtWJ,JtWdy=result.JtWdy,X2=result.Chi_sq,y_hat=result.y_hat,J=result.J;\n        //[JtWJ,JtWdy,X2,y_hat,J] = this.lm_matx(func,t,p_old,y_old,1,J,p,y_dat,weight_sq,dp,c);\n        //console.log(JtWJ);\n\n        if ( Math.max(Math.abs(JtWdy)) < epsilon_1 ){\n            console.log(' *** Your Initial Guess is Extremely Close to Optimal ***')\n            console.log(' *** epsilon_1 = ', epsilon_1);\n            stop = true;\n        }\n\n\n        switch(Update_Type){\n            case 1: // Marquardt: init'l lambda\n                lambda  = lambda_0;\n                break;\n            default:    // Quadratic and Nielsen\n                lambda  = lambda_0 * Math.max(math.diag(JtWJ));\n                nu=2;\n        }\n        //console.log(X2);\n        X2_old = X2; // previous value of X2\n        //console.log(MaxIter+\" \"+Npar);\n        //var cvg_hst = Matrix.ones(MaxIter,Npar+3);\t\t// initialize convergence history\n        var h = null;\n        while ( !stop && iteration <= MaxIter ) {\t\t// --- Main Loop\n            iteration = iteration + 1;\n            // incremental change in parameters\n            switch(Update_Type){\n                case 1:\t\t\t\t\t// Marquardt\n                    //h = ( JtWJ + lambda * math.diag(math.diag(JtWJ)) ) \\ JtWdy;\n                    //h = math.multiply(math.inv(JtWdy),math.add(JtWJ,math.multiply(lambda,math.diag(math.diag(Npar)))));\n                    h = math.solve(math.add(JtWJ,math.multiply(math.diag(math.diag(JtWJ)),lambda)),JtWdy);\n                    break;\n                default:\t\t\t\t\t// Quadratic and Nielsen\n                    //h = ( JtWJ + lambda * math.eye(Npar) ) \\ JtWdy;\n\n                    h = math.solve(math.add(JtWJ,math.multiply( Matrix.eye(Npar),lambda)),JtWdy);\n            }\n\n            /*for(var k=0;k< h.length;k++){\n             h[k]=[h[k]];\n             }*/\n            //console.log(\"h \"+h);\n            //h=math.matrix(h);\n            //  big = max(abs(h./p)) > 2;\n            //this is a big step\n            // --- Are parameters [p+h] much better than [p] ?\n            var hidx = new Array(idx.length);\n            for(k=0;k<idx.length;k++){\n                hidx[k]=h[idx[k]];\n            }\n            var p_try = math.add(p, hidx);// update the [idx] elements\n\n            for(k=0;k<p_try.length;k++){\n                p_try[k][0]=Math.min(Math.max(p_min[k][0],p_try[k][0]),p_max[k][0]);\n            }\n            // p_try = Math.min(Math.max(p_min,p_try),p_max);           // apply constraints\n\n            var delta_y = math.subtract(y_dat, func(t,p_try,c));       // residual error using p_try\n            //func_calls = func_calls + 1;\n            //X2_try = delta_y' * ( delta_y .* weight_sq );  // Chi-squared error criteria\n\n            var X2_try = math.multiply(math.transpose(delta_y),math.dotMultiply(delta_y,weight_sq));\n\n            if ( Update_Type == 2 ){  \t\t\t  // Quadratic\n                //    One step of quadratic line update in the h direction for minimum X2\n                //var alpha =  JtWdy'*h / ( (X2_try - X2)/2 + 2*JtWdy'*h ) ;\n                var JtWdy_th = math.multiply(math.transpose(JtWdy),h);\n                var alpha =  math.multiply(JtWdy_th,math.inv(math.add(math.multiply(math.subtract(X2_try - X2),1/2)),math.multiply(JtWdy_th,2)));//JtWdy'*h / ( (X2_try - X2)/2 + 2*JtWdy'*h ) ;\n\n                h = math.multiply(alpha, h);\n                for(var k=0;k<idx.length;k++){\n                    hidx[k]=h[idx[k]];\n                }\n\n                p_try = math.add(p ,hidx);                     // update only [idx] elements\n                p_try = math.min(math.max(p_min,p_try),p_max);          // apply constraints\n\n                delta_y = math.subtract(y_dat, func(t,p_try,c));      // residual error using p_try\n                // func_calls = func_calls + 1;\n                //X2_try = delta_y' * ( delta_y .* weight_sq ); // Chi-squared error criteria\n                X2_try = math.multiply(math.transpose(delta_y), mat.dotMultiply(delta_y, weight_sq));\n            }\n\n            //rho = (X2 - X2_try) / ( 2*h' * (lambda * h + JtWdy) ); // Nielsen\n            var rho = (X2-X2_try)/math.multiply(math.multiply(math.transpose(h),2),math.add(math.multiply(lambda, h),JtWdy));\n            //console.log(\"rho \"+rho);\n            if ( rho > epsilon_4 ) {\t\t// it IS significantly better\n                //console.log(\"Here\");\n                dX2 = X2 - X2_old;\n                X2_old = X2;\n                p_old = p;\n                y_old = y_hat;\n                p = p_try;\t\t\t// accept p_try\n\n                result = this.lm_matx(func, t, p_old, y_old, dX2, J, p, y_dat, weight_sq, dp, c);\n                JtWJ = result.JtWJ,JtWdy=result.JtWdy,X2=result.Chi_sq,y_hat=result.y_hat,J=result.J;\n                // decrease lambda ==> Gauss-Newton method\n\n                switch (Update_Type) {\n                    case 1:\t\t\t\t\t\t\t// Levenberg\n                        lambda = Math.max(lambda / lambda_DN_fac, 1.e-7);\n                        break;\n                    case 2:\t\t\t\t\t\t\t// Quadratic\n                        lambda = Math.max(lambda / (1 + alpha), 1.e-7);\n                        break;\n                    case 3:\t\t\t\t\t\t\t// Nielsen\n                        lambda = math.multiply(Math.max(1 / 3, 1 - (2 * rho - 1) ^ 3),lambda);\n                        nu = 2;\n                        break;\n                }\n            }\n            else {\t\t\t\t\t// it IS NOT better\n                X2 = X2_old;\t\t\t// do not accept p_try\n                if (iteration%(2 * Npar)==0) {\t// rank-1 update of Jacobian\n                    result = this.lm_matx(func, t, p_old, y_old, -1, J, p, y_dat, weight_sq, dp, c);\n                    JtWJ = result.JtWJ,JtWdy=result.JtWdy,dX2=result.Chi_sq,y_hat=result.y_hat,J=result.J;\n                }\n\n                // increase lambda  ==> gradient descent method\n                switch (Update_Type) {\n                    case 1:\t\t\t\t\t\t\t// Levenberg\n                        lambda = Math.min(lambda * lambda_UP_fac, 1.e7);\n                        break;\n                    case 2:\t\t\t\t\t\t\t// Quadratic\n                        lambda = lambda + Math.abs((X2_try - X2) / 2 / alpha);\n                        break;\n                    case 3:\t\t\t\t\t\t// Nielsen\n                        lambda = lambda * nu;\n                        nu = 2 * nu;\n                        break;\n                }\n            }\n        }// --- End of Main Loop\n\n        // --- convergence achieved, find covariance and confidence intervals\n\n        // equal weights for paramter error analysis\n        weight_sq = math.multiply(math.multiply(math.transpose(delta_y),delta_y), Matrix.ones(Npnt,1));\n\n        weight_sq.apply(function(i,j){\n            weight_sq[i][j] = (Npnt-Nfit+1)/weight_sq[i][j];\n        });\n        //console.log(weight_sq);\n        result = this.lm_matx(func,t,p_old,y_old,-1,J,p,y_dat,weight_sq,dp,c);\n        JtWJ = result.JtWJ,JtWdy=result.JtWdy,X2=result.Chi_sq,y_hat=result.y_hat,J=result.J;\n\n        /*if nargout > 2\t\t\t\t// standard error of parameters\n         covar = inv(JtWJ);\n         sigma_p = sqrt(diag(covar));\n         end\n\n         if nargout > 3\t\t\t\t// standard error of the fit\n         //  sigma_y = sqrt(diag(J * covar * J'));\t// slower version of below\n         sigma_y = zeros(Npnt,1);\n         for i=1:Npnt\n         sigma_y(i) = J(i,:) * covar * J(i,:)';\n         end\n         sigma_y = sqrt(sigma_y);\n         end\n\n         if nargout > 4\t\t\t\t// parameter correlation matrix\n         corr = covar ./ [sigma_p*sigma_p'];\n         end\n\n         if nargout > 5\t\t\t\t// coefficient of multiple determination\n         R_sq = corrcoef([y_dat y_hat]);\n         R_sq = R_sq(1,2).^2;\n         end\n\n         if nargout > 6\t\t\t\t// convergence history\n         cvg_hst = cvg_hst(1:iteration,:);\n         end*/\n\n        // endfunction  # ---------------------------------------------------------- LM\n\n        return { p:p, X2:X2};\n    },\n\n    lm_FD_J:function(func,t,p,y,dp,c) {\n        // J = lm_FD_J(func,t,p,y,{dp},{c})\n        //\n        // partial derivatives (Jacobian) dy/dp for use with lm.m\n        // computed via Finite Differences\n        // Requires n or 2n function evaluations, n = number of nonzero values of dp\n        // -------- INPUT VARIABLES ---------\n        // func = function of independent variables, 't', and parameters, 'p',\n        //        returning the simulated model: y_hat = func(t,p,c)\n        // t  = m-vector of independent variables (used as arg to func)\n        // p  = n-vector of current parameter values\n        // y  = func(t,p,c) n-vector initialised by user before each call to lm_FD_J\n        // dp = fractional increment of p for numerical derivatives\n        //      dp(j)>0 central differences calculated\n        //      dp(j)<0 one sided differences calculated\n        //      dp(j)=0 sets corresponding partials to zero; i.e. holds p(j) fixed\n        //      Default:  0.001;\n        // c  = optional vector of constants passed to y_hat = func(t,p,c)\n        //---------- OUTPUT VARIABLES -------\n        // J  = Jacobian Matrix J(i,j)=dy(i)/dp(j)\ti=1:n; j=1:m\n\n        //   Henri Gavin, Dept. Civil & Environ. Engineering, Duke Univ. November 2005\n        //   modified from: ftp://fly.cnuce.cnr.it/pub/software/octave/leasqr/\n        //   Press, et al., Numerical Recipes, Cambridge Univ. Press, 1992, Chapter 15.\n\n        var m = y.length;\t\t\t// number of data points\n        var n = p.length;\t\t\t// number of parameters\n\n        dp = dp || math.multiply( Matrix.ones(n, 1), 0.001);\n\n        var ps = p.clone();//JSON.parse(JSON.stringify(p));\n        //var ps = $.extend(true, [], p);\n        var J = new Matrix(m,n), del =new Array(n);         // initialize Jacobian to Zero\n\n        for (var j = 0;j < n; j++) {\n            //console.log(j+\" \"+dp[j]+\" \"+p[j]+\" \"+ps[j]+\" \"+del[j]);\n            del[j] = dp[j]*(1+Math.abs(p[j][0]));  // parameter perturbation\n            p[j] = [ps[j][0]+del[j]];\t      // perturb parameter p(j)\n            //console.log(j+\" \"+dp[j]+\" \"+p[j]+\" \"+ps[j]+\" \"+del[j]);\n\n            if (del[j] != 0){\n                y1 = func(t, p, c);\n                //func_calls = func_calls + 1;\n                if (dp[j][0] < 0) {\t\t// backwards difference\n                    //J(:,j) = math.dotDivide(math.subtract(y1, y),del[j]);//. / del[j];\n                    //console.log(del[j]);\n                    //console.log(y);\n                    var column = math.dotDivide(math.subtract(y1, y),del[j]);\n                    for(var k=0;k< m;k++){\n                        J[k][j]=column[k][0];\n                    }\n                    //console.log(column);\n                }\n                else{\n                    p[j][0] = ps[j][0] - del[j];\n                    //J(:,j) = (y1 - feval(func, t, p, c)). / (2. * del[j]);\n                    var column = math.dotDivide(math.subtract(y1,func(t,p,c)),2*del[j]);\n                    for(var k=0;k< m;k++){\n                        J[k][j]=column[k][0];\n                    }\n\n                }\t\t\t// central difference, additional func call\n            }\n\n            p[j] = ps[j];\t\t// restore p(j)\n\n        }\n        //console.log(\"lm_FD_J: \"+ JSON.stringify(J));\n        return J;\n\n    },\n\n    // endfunction # -------------------------------------------------- LM_FD_J\n    lm_Broyden_J: function(p_old,y_old,J,p,y){\n        // J = lm_Broyden_J(p_old,y_old,J,p,y)\n        // carry out a rank-1 update to the Jacobian matrix using Broyden's equation\n        //---------- INPUT VARIABLES -------\n        // p_old = previous set of parameters\n        // y_old = model evaluation at previous set of parameters, y_hat(t;p_old)\n        // J  = current version of the Jacobian matrix\n        // p     = current  set of parameters\n        // y     = model evaluation at current  set of parameters, y_hat(t;p)\n        //---------- OUTPUT VARIABLES -------\n        // J = rank-1 update to Jacobian Matrix J(i,j)=dy(i)/dp(j)\ti=1:n; j=1:m\n        //console.log(p+\" X \"+ p_old)\n        var h  = math.subtract(p, p_old);\n\n        //console.log(\"hhh \"+h);\n        var h_t = math.transpose(h);\n        h_t.div(math.multiply(h_t,h));\n\n        //console.log(h_t);\n        //J = J + ( y - y_old - J*h )*h' / (h'*h);\t// Broyden rank-1 update eq'n\n        J = math.add(J, math.multiply(math.subtract(y, math.add(y_old,math.multiply(J,h))),h_t));\n        return J;\n        // endfunction # ---------------------------------------------- LM_Broyden_J\n    },\n\n    lm_matx : function (func,t,p_old,y_old,dX2,J,p,y_dat,weight_sq,dp,c,iteration){\n        // [JtWJ,JtWdy,Chi_sq,y_hat,J] = this.lm_matx(func,t,p_old,y_old,dX2,J,p,y_dat,weight_sq,{da},{c})\n        //\n        // Evaluate the linearized fitting matrix, JtWJ, and vector JtWdy,\n        // and calculate the Chi-squared error function, Chi_sq\n        // Used by Levenberg-Marquard algorithm, lm.m\n        // -------- INPUT VARIABLES ---------\n        // func   = function ofpn independent variables, p, and m parameters, p,\n        //         returning the simulated model: y_hat = func(t,p,c)\n        // t      = m-vectors or matrix of independent variables (used as arg to func)\n        // p_old  = n-vector of previous parameter values\n        // y_old  = m-vector of previous model ... y_old = y_hat(t;p_old);\n        // dX2    = previous change in Chi-squared criteria\n        // J   = m-by-n Jacobian of model, y_hat, with respect to parameters, p\n        // p      = n-vector of current  parameter values\n        // y_dat  = n-vector of data to be fit by func(t,p,c)\n        // weight_sq = square of the weighting vector for least squares fit ...\n        //\t    inverse of the standard measurement errors\n        // dp     = fractional increment of 'p' for numerical derivatives\n        //          dp(j)>0 central differences calculated\n        //          dp(j)<0 one sided differences calculated\n        //          dp(j)=0 sets corresponding partials to zero; i.e. holds p(j) fixed\n        //          Default:  0.001;\n        // c      = optional vector of constants passed to y_hat = func(t,p,c)\n        //---------- OUTPUT VARIABLES -------\n        // JtWJ\t = linearized Hessian matrix (inverse of covariance matrix)\n        // JtWdy   = linearized fitting vector\n        // Chi_sq = Chi-squared criteria: weighted sum of the squared residuals WSSR\n        // y_hat  = model evaluated with parameters 'p'\n        // J   = m-by-n Jacobian of model, y_hat, with respect to parameters, p\n\n        //   Henri Gavin, Dept. Civil & Environ. Engineering, Duke Univ. November 2005\n        //   modified from: ftp://fly.cnuce.cnr.it/pub/software/octave/leasqr/\n        //   Press, et al., Numerical Recipes, Cambridge Univ. Press, 1992, Chapter 15.\n\n\n        var Npnt = y_dat.length;\t\t// number of data points\n        var Npar = p.length;\t\t// number of parameters\n\n        dp = dp || 0.001;\n\n\n        //var JtWJ = new Matrix.zeros(Npar);\n        //var JtWdy  = new Matrix.zeros(Npar,1);\n\n        var y_hat = func(t,p,c);\t// evaluate model using parameters 'p'\n        //func_calls = func_calls + 1;\n        //console.log(J);\n        if ( (iteration%(2*Npar))==0 || dX2 > 0 ) {\n            //console.log(\"Par\");\n            J = this.lm_FD_J(func, t, p, y_hat, dp, c);\t\t// finite difference\n        }\n        else{\n            //console.log(\"ImPar\");\n            J = this.lm_Broyden_J(p_old, y_old, J, p, y_hat); // rank-1 update\n        }\n        //console.log(y_dat);\n        //console.log(y_hat);\n        var delta_y = math.subtract(y_dat, y_hat);\t// residual error between model and data\n        //console.log(delta_y[0][0]);\n        //console.log(delta_y.rows+\" \"+delta_y.columns+\" \"+JSON.stringify(weight_sq));\n        //var Chi_sq = delta_y' * ( delta_y .* weight_sq ); \t// Chi-squared error criteria\n        var Chi_sq = math.multiply(math.transpose(delta_y),math.dotMultiply(delta_y,weight_sq));\n        //JtWJ  = J' * ( J .* ( weight_sq * ones(1,Npar) ) );\n        var Jt = math.transpose(J);\n\n        //console.log(weight_sq);\n\n        var JtWJ = math.multiply(Jt, math.dotMultiply(J,math.multiply(weight_sq, Matrix.ones(1,Npar))));\n\n        //JtWdy = J' * ( weight_sq .* delta_y );\n        var JtWdy = math.multiply(Jt, math.dotMultiply(weight_sq,delta_y));\n\n\n        return {JtWJ:JtWJ,JtWdy:JtWdy,Chi_sq:Chi_sq,y_hat:y_hat,J:J};\n        // endfunction  # ------------------------------------------------------ LM_MATX\n    }\n\n\n\n};\n\nmodule.exports = LM;","'use strict';\n\nif (!Symbol.species) {\n    Symbol.species = Symbol.for('@@species');\n}\n","module.exports = exports = require('./ArrayUtils');\n\n\nexports.getEquallySpacedData = require('./getEquallySpaced').getEquallySpacedData;\nexports.SNV = require('./snv').SNV;\n","'use strict';\n\nconst Stat = require('ml-stat').array;\n/**\n * Function that returns an array of points given 1D array as follows:\n *\n * [x1, y1, .. , x2, y2, ..]\n *\n * And receive the number of dimensions of each point.\n * @param array\n * @param dimensions\n * @returns {Array} - Array of points.\n */\nfunction coordArrayToPoints(array, dimensions) {\n    if(array.length % dimensions !== 0) {\n        throw new RangeError('Dimensions number must be accordance with the size of the array.');\n    }\n\n    var length = array.length / dimensions;\n    var pointsArr = new Array(length);\n\n    var k = 0;\n    for(var i = 0; i < array.length; i += dimensions) {\n        var point = new Array(dimensions);\n        for(var j = 0; j < dimensions; ++j) {\n            point[j] = array[i + j];\n        }\n\n        pointsArr[k] = point;\n        k++;\n    }\n\n    return pointsArr;\n}\n\n\n/**\n * Function that given an array as follows:\n * [x1, y1, .. , x2, y2, ..]\n *\n * Returns an array as follows:\n * [[x1, x2, ..], [y1, y2, ..], [ .. ]]\n *\n * And receives the number of dimensions of each coordinate.\n * @param array\n * @param dimensions\n * @returns {Array} - Matrix of coordinates\n */\nfunction coordArrayToCoordMatrix(array, dimensions) {\n    if(array.length % dimensions !== 0) {\n        throw new RangeError('Dimensions number must be accordance with the size of the array.');\n    }\n\n    var coordinatesArray = new Array(dimensions);\n    var points = array.length / dimensions;\n    for (var i = 0; i < coordinatesArray.length; i++) {\n        coordinatesArray[i] = new Array(points);\n    }\n\n    for(i = 0; i < array.length; i += dimensions) {\n        for(var j = 0; j < dimensions; ++j) {\n            var currentPoint = Math.floor(i / dimensions);\n            coordinatesArray[j][currentPoint] = array[i + j];\n        }\n    }\n\n    return coordinatesArray;\n}\n\n/**\n * Function that receives a coordinate matrix as follows:\n * [[x1, x2, ..], [y1, y2, ..], [ .. ]]\n *\n * Returns an array of coordinates as follows:\n * [x1, y1, .. , x2, y2, ..]\n *\n * @param coordMatrix\n * @returns {Array}\n */\nfunction coordMatrixToCoordArray(coordMatrix) {\n    var coodinatesArray = new Array(coordMatrix.length * coordMatrix[0].length);\n    var k = 0;\n    for(var i = 0; i < coordMatrix[0].length; ++i) {\n        for(var j = 0; j < coordMatrix.length; ++j) {\n            coodinatesArray[k] = coordMatrix[j][i];\n            ++k;\n        }\n    }\n\n    return coodinatesArray;\n}\n\n/**\n * Tranpose a matrix, this method is for coordMatrixToPoints and\n * pointsToCoordMatrix, that because only transposing the matrix\n * you can change your representation.\n *\n * @param matrix\n * @returns {Array}\n */\nfunction transpose(matrix) {\n    var resultMatrix = new Array(matrix[0].length);\n    for(var i = 0; i < resultMatrix.length; ++i) {\n        resultMatrix[i] = new Array(matrix.length);\n    }\n\n    for (i = 0; i < matrix.length; ++i) {\n        for(var j = 0; j < matrix[0].length; ++j) {\n            resultMatrix[j][i] = matrix[i][j];\n        }\n    }\n\n    return resultMatrix;\n}\n\n/**\n * Function that transform an array of points into a coordinates array\n * as follows:\n * [x1, y1, .. , x2, y2, ..]\n *\n * @param points\n * @returns {Array}\n */\nfunction pointsToCoordArray(points) {\n    var coodinatesArray = new Array(points.length * points[0].length);\n    var k = 0;\n    for(var i = 0; i < points.length; ++i) {\n        for(var j = 0; j < points[0].length; ++j) {\n            coodinatesArray[k] = points[i][j];\n            ++k;\n        }\n    }\n\n    return coodinatesArray;\n}\n\n/**\n * Apply the dot product between the smaller vector and a subsets of the\n * largest one.\n *\n * @param firstVector\n * @param secondVector\n * @returns {Array} each dot product of size of the difference between the\n *                  larger and the smallest one.\n */\nfunction applyDotProduct(firstVector, secondVector) {\n    var largestVector, smallestVector;\n    if(firstVector.length <= secondVector.length) {\n        smallestVector = firstVector;\n        largestVector = secondVector;\n    } else {\n        smallestVector = secondVector;\n        largestVector = firstVector;\n    }\n\n    var difference = largestVector.length - smallestVector.length + 1;\n    var dotProductApplied = new Array(difference);\n\n    for (var i = 0; i < difference; ++i) {\n        var sum = 0;\n        for (var j = 0; j < smallestVector.length; ++j) {\n            sum += smallestVector[j] * largestVector[i + j];\n        }\n        dotProductApplied[i] = sum;\n    }\n\n    return dotProductApplied;\n}\n/**\n * To scale the input array between the specified min and max values. The operation is performed inplace\n * if the options.inplace is specified. If only one of the min or max parameters is specified, then the scaling\n * will multiply the input array by min/min(input) or max/max(input)\n * @param input\n * @param options\n * @returns {*}\n */\nfunction scale(input, options){\n    var y;\n    if(options.inPlace){\n        y = input;\n    }\n    else{\n        y = new Array(input.length);\n    }\n    const max = options.max;\n    const min = options.min;\n    if(typeof max === \"number\"){\n        if(typeof min === \"number\"){\n            var minMax = Stat.minMax(input);\n            var factor = (max - min)/(minMax.max-minMax.min);\n            for(var i=0;i< y.length;i++){\n                y[i]=(input[i]-minMax.min)*factor+min;\n            }\n        }\n        else{\n            var currentMin = Stat.max(input);\n            var factor = max/currentMin;\n            for(var i=0;i< y.length;i++){\n                y[i] = input[i]*factor;\n            }\n        }\n    }\n    else{\n        if(typeof min === \"number\"){\n            var currentMin = Stat.min(input);\n            var factor = min/currentMin;\n            for(var i=0;i< y.length;i++){\n                y[i] = input[i]*factor;\n            }\n        }\n    }\n    return y;\n}\n\nmodule.exports = {\n    coordArrayToPoints: coordArrayToPoints,\n    coordArrayToCoordMatrix: coordArrayToCoordMatrix,\n    coordMatrixToCoordArray: coordMatrixToCoordArray,\n    coordMatrixToPoints: transpose,\n    pointsToCoordArray: pointsToCoordArray,\n    pointsToCoordMatrix: transpose,\n    applyDotProduct: applyDotProduct,\n    scale:scale\n};\n\n","'use strict';\n\nvar arrayStat = require('./array');\n\nfunction compareNumbers(a, b) {\n    return a - b;\n}\n\nexports.max = function max(matrix) {\n    var max = -Infinity;\n    for (var i = 0; i < matrix.length; i++) {\n        for (var j = 0; j < matrix[i].length; j++) {\n            if (matrix[i][j] > max) max = matrix[i][j];\n        }\n    }\n    return max;\n};\n\nexports.min = function min(matrix) {\n    var min = Infinity;\n    for (var i = 0; i < matrix.length; i++) {\n        for (var j = 0; j < matrix[i].length; j++) {\n            if (matrix[i][j] < min) min = matrix[i][j];\n        }\n    }\n    return min;\n};\n\nexports.minMax = function minMax(matrix) {\n    var min = Infinity;\n    var max = -Infinity;\n    for (var i = 0; i < matrix.length; i++) {\n        for (var j = 0; j < matrix[i].length; j++) {\n            if (matrix[i][j] < min) min = matrix[i][j];\n            if (matrix[i][j] > max) max = matrix[i][j];\n        }\n    }\n    return {\n        min:min,\n        max:max\n    };\n};\n\nexports.entropy = function entropy(matrix, eps) {\n    if (typeof (eps) === 'undefined') {\n        eps = 0;\n    }\n    var sum = 0,\n        l1 = matrix.length,\n        l2 = matrix[0].length;\n    for (var i = 0; i < l1; i++) {\n        for (var j = 0; j < l2; j++) {\n            sum += matrix[i][j] * Math.log(matrix[i][j] + eps);\n        }\n    }\n    return -sum;\n};\n\nexports.mean = function mean(matrix, dimension) {\n    if (typeof (dimension) === 'undefined') {\n        dimension = 0;\n    }\n    var rows = matrix.length,\n        cols = matrix[0].length,\n        theMean, N, i, j;\n\n    if (dimension === -1) {\n        theMean = [0];\n        N = rows * cols;\n        for (i = 0; i < rows; i++) {\n            for (j = 0; j < cols; j++) {\n                theMean[0] += matrix[i][j];\n            }\n        }\n        theMean[0] /= N;\n    } else if (dimension === 0) {\n        theMean = new Array(cols);\n        N = rows;\n        for (j = 0; j < cols; j++) {\n            theMean[j] = 0;\n            for (i = 0; i < rows; i++) {\n                theMean[j] += matrix[i][j];\n            }\n            theMean[j] /= N;\n        }\n    } else if (dimension === 1) {\n        theMean = new Array(rows);\n        N = cols;\n        for (j = 0; j < rows; j++) {\n            theMean[j] = 0;\n            for (i = 0; i < cols; i++) {\n                theMean[j] += matrix[j][i];\n            }\n            theMean[j] /= N;\n        }\n    } else {\n        throw new Error('Invalid dimension');\n    }\n    return theMean;\n};\n\nexports.sum = function sum(matrix, dimension) {\n    if (typeof (dimension) === 'undefined') {\n        dimension = 0;\n    }\n    var rows = matrix.length,\n        cols = matrix[0].length,\n        theSum, i, j;\n\n    if (dimension === -1) {\n        theSum = [0];\n        for (i = 0; i < rows; i++) {\n            for (j = 0; j < cols; j++) {\n                theSum[0] += matrix[i][j];\n            }\n        }\n    } else if (dimension === 0) {\n        theSum = new Array(cols);\n        for (j = 0; j < cols; j++) {\n            theSum[j] = 0;\n            for (i = 0; i < rows; i++) {\n                theSum[j] += matrix[i][j];\n            }\n        }\n    } else if (dimension === 1) {\n        theSum = new Array(rows);\n        for (j = 0; j < rows; j++) {\n            theSum[j] = 0;\n            for (i = 0; i < cols; i++) {\n                theSum[j] += matrix[j][i];\n            }\n        }\n    } else {\n        throw new Error('Invalid dimension');\n    }\n    return theSum;\n};\n\nexports.product = function product(matrix, dimension) {\n    if (typeof (dimension) === 'undefined') {\n        dimension = 0;\n    }\n    var rows = matrix.length,\n        cols = matrix[0].length,\n        theProduct, i, j;\n\n    if (dimension === -1) {\n        theProduct = [1];\n        for (i = 0; i < rows; i++) {\n            for (j = 0; j < cols; j++) {\n                theProduct[0] *= matrix[i][j];\n            }\n        }\n    } else if (dimension === 0) {\n        theProduct = new Array(cols);\n        for (j = 0; j < cols; j++) {\n            theProduct[j] = 1;\n            for (i = 0; i < rows; i++) {\n                theProduct[j] *= matrix[i][j];\n            }\n        }\n    } else if (dimension === 1) {\n        theProduct = new Array(rows);\n        for (j = 0; j < rows; j++) {\n            theProduct[j] = 1;\n            for (i = 0; i < cols; i++) {\n                theProduct[j] *= matrix[j][i];\n            }\n        }\n    } else {\n        throw new Error('Invalid dimension');\n    }\n    return theProduct;\n};\n\nexports.standardDeviation = function standardDeviation(matrix, means, unbiased) {\n    var vari = exports.variance(matrix, means, unbiased), l = vari.length;\n    for (var i = 0; i < l; i++) {\n        vari[i] = Math.sqrt(vari[i]);\n    }\n    return vari;\n};\n\nexports.variance = function variance(matrix, means, unbiased) {\n    if (typeof (unbiased) === 'undefined') {\n        unbiased = true;\n    }\n    means = means || exports.mean(matrix);\n    var rows = matrix.length;\n    if (rows === 0) return [];\n    var cols = matrix[0].length;\n    var vari = new Array(cols);\n\n    for (var j = 0; j < cols; j++) {\n        var sum1 = 0, sum2 = 0, x = 0;\n        for (var i = 0; i < rows; i++) {\n            x = matrix[i][j] - means[j];\n            sum1 += x;\n            sum2 += x * x;\n        }\n        if (unbiased) {\n            vari[j] = (sum2 - ((sum1 * sum1) / rows)) / (rows - 1);\n        } else {\n            vari[j] = (sum2 - ((sum1 * sum1) / rows)) / rows;\n        }\n    }\n    return vari;\n};\n\nexports.median = function median(matrix) {\n    var rows = matrix.length, cols = matrix[0].length;\n    var medians = new Array(cols);\n\n    for (var i = 0; i < cols; i++) {\n        var data = new Array(rows);\n        for (var j = 0; j < rows; j++) {\n            data[j] = matrix[j][i];\n        }\n        data.sort(compareNumbers);\n        var N = data.length;\n        if (N % 2 === 0) {\n            medians[i] = (data[N / 2] + data[(N / 2) - 1]) * 0.5;\n        } else {\n            medians[i] = data[Math.floor(N / 2)];\n        }\n    }\n    return medians;\n};\n\nexports.mode = function mode(matrix) {\n    var rows = matrix.length,\n        cols = matrix[0].length,\n        modes = new Array(cols),\n        i, j;\n    for (i = 0; i < cols; i++) {\n        var itemCount = new Array(rows);\n        for (var k = 0; k < rows; k++) {\n            itemCount[k] = 0;\n        }\n        var itemArray = new Array(rows);\n        var count = 0;\n\n        for (j = 0; j < rows; j++) {\n            var index = itemArray.indexOf(matrix[j][i]);\n            if (index >= 0) {\n                itemCount[index]++;\n            } else {\n                itemArray[count] = matrix[j][i];\n                itemCount[count] = 1;\n                count++;\n            }\n        }\n\n        var maxValue = 0, maxIndex = 0;\n        for (j = 0; j < count; j++) {\n            if (itemCount[j] > maxValue) {\n                maxValue = itemCount[j];\n                maxIndex = j;\n            }\n        }\n\n        modes[i] = itemArray[maxIndex];\n    }\n    return modes;\n};\n\nexports.skewness = function skewness(matrix, unbiased) {\n    if (typeof (unbiased) === 'undefined') unbiased = true;\n    var means = exports.mean(matrix);\n    var n = matrix.length, l = means.length;\n    var skew = new Array(l);\n\n    for (var j = 0; j < l; j++) {\n        var s2 = 0, s3 = 0;\n        for (var i = 0; i < n; i++) {\n            var dev = matrix[i][j] - means[j];\n            s2 += dev * dev;\n            s3 += dev * dev * dev;\n        }\n\n        var m2 = s2 / n;\n        var m3 = s3 / n;\n        var g = m3 / Math.pow(m2, 3 / 2);\n\n        if (unbiased) {\n            var a = Math.sqrt(n * (n - 1));\n            var b = n - 2;\n            skew[j] = (a / b) * g;\n        } else {\n            skew[j] = g;\n        }\n    }\n    return skew;\n};\n\nexports.kurtosis = function kurtosis(matrix, unbiased) {\n    if (typeof (unbiased) === 'undefined') unbiased = true;\n    var means = exports.mean(matrix);\n    var n = matrix.length, m = matrix[0].length;\n    var kurt = new Array(m);\n\n    for (var j = 0; j < m; j++) {\n        var s2 = 0, s4 = 0;\n        for (var i = 0; i < n; i++) {\n            var dev = matrix[i][j] - means[j];\n            s2 += dev * dev;\n            s4 += dev * dev * dev * dev;\n        }\n        var m2 = s2 / n;\n        var m4 = s4 / n;\n\n        if (unbiased) {\n            var v = s2 / (n - 1);\n            var a = (n * (n + 1)) / ((n - 1) * (n - 2) * (n - 3));\n            var b = s4 / (v * v);\n            var c = ((n - 1) * (n - 1)) / ((n - 2) * (n - 3));\n            kurt[j] = a * b - 3 * c;\n        } else {\n            kurt[j] = m4 / (m2 * m2) - 3;\n        }\n    }\n    return kurt;\n};\n\nexports.standardError = function standardError(matrix) {\n    var samples = matrix.length;\n    var standardDeviations = exports.standardDeviation(matrix);\n    var l = standardDeviations.length;\n    var standardErrors = new Array(l);\n    var sqrtN = Math.sqrt(samples);\n\n    for (var i = 0; i < l; i++) {\n        standardErrors[i] = standardDeviations[i] / sqrtN;\n    }\n    return standardErrors;\n};\n\nexports.covariance = function covariance(matrix, dimension) {\n    return exports.scatter(matrix, undefined, dimension);\n};\n\nexports.scatter = function scatter(matrix, divisor, dimension) {\n    if (typeof (dimension) === 'undefined') {\n        dimension = 0;\n    }\n    if (typeof (divisor) === 'undefined') {\n        if (dimension === 0) {\n            divisor = matrix.length - 1;\n        } else if (dimension === 1) {\n            divisor = matrix[0].length - 1;\n        }\n    }\n    var means = exports.mean(matrix, dimension);\n    var rows = matrix.length;\n    if (rows === 0) {\n        return [[]];\n    }\n    var cols = matrix[0].length,\n        cov, i, j, s, k;\n\n    if (dimension === 0) {\n        cov = new Array(cols);\n        for (i = 0; i < cols; i++) {\n            cov[i] = new Array(cols);\n        }\n        for (i = 0; i < cols; i++) {\n            for (j = i; j < cols; j++) {\n                s = 0;\n                for (k = 0; k < rows; k++) {\n                    s += (matrix[k][j] - means[j]) * (matrix[k][i] - means[i]);\n                }\n                s /= divisor;\n                cov[i][j] = s;\n                cov[j][i] = s;\n            }\n        }\n    } else if (dimension === 1) {\n        cov = new Array(rows);\n        for (i = 0; i < rows; i++) {\n            cov[i] = new Array(rows);\n        }\n        for (i = 0; i < rows; i++) {\n            for (j = i; j < rows; j++) {\n                s = 0;\n                for (k = 0; k < cols; k++) {\n                    s += (matrix[j][k] - means[j]) * (matrix[i][k] - means[i]);\n                }\n                s /= divisor;\n                cov[i][j] = s;\n                cov[j][i] = s;\n            }\n        }\n    } else {\n        throw new Error('Invalid dimension');\n    }\n\n    return cov;\n};\n\nexports.correlation = function correlation(matrix) {\n    var means = exports.mean(matrix),\n        standardDeviations = exports.standardDeviation(matrix, true, means),\n        scores = exports.zScores(matrix, means, standardDeviations),\n        rows = matrix.length,\n        cols = matrix[0].length,\n        i, j;\n\n    var cor = new Array(cols);\n    for (i = 0; i < cols; i++) {\n        cor[i] = new Array(cols);\n    }\n    for (i = 0; i < cols; i++) {\n        for (j = i; j < cols; j++) {\n            var c = 0;\n            for (var k = 0, l = scores.length; k < l; k++) {\n                c += scores[k][j] * scores[k][i];\n            }\n            c /= rows - 1;\n            cor[i][j] = c;\n            cor[j][i] = c;\n        }\n    }\n    return cor;\n};\n\nexports.zScores = function zScores(matrix, means, standardDeviations) {\n    means = means || exports.mean(matrix);\n    if (typeof (standardDeviations) === 'undefined') standardDeviations = exports.standardDeviation(matrix, true, means);\n    return exports.standardize(exports.center(matrix, means, false), standardDeviations, true);\n};\n\nexports.center = function center(matrix, means, inPlace) {\n    means = means || exports.mean(matrix);\n    var result = matrix,\n        l = matrix.length,\n        i, j, jj;\n\n    if (!inPlace) {\n        result = new Array(l);\n        for (i = 0; i < l; i++) {\n            result[i] = new Array(matrix[i].length);\n        }\n    }\n\n    for (i = 0; i < l; i++) {\n        var row = result[i];\n        for (j = 0, jj = row.length; j < jj; j++) {\n            row[j] = matrix[i][j] - means[j];\n        }\n    }\n    return result;\n};\n\nexports.standardize = function standardize(matrix, standardDeviations, inPlace) {\n    if (typeof (standardDeviations) === 'undefined') standardDeviations = exports.standardDeviation(matrix);\n    var result = matrix,\n        l = matrix.length,\n        i, j, jj;\n\n    if (!inPlace) {\n        result = new Array(l);\n        for (i = 0; i < l; i++) {\n            result[i] = new Array(matrix[i].length);\n        }\n    }\n\n    for (i = 0; i < l; i++) {\n        var resultRow = result[i];\n        var sourceRow = matrix[i];\n        for (j = 0, jj = resultRow.length; j < jj; j++) {\n            if (standardDeviations[j] !== 0 && !isNaN(standardDeviations[j])) {\n                resultRow[j] = sourceRow[j] / standardDeviations[j];\n            }\n        }\n    }\n    return result;\n};\n\nexports.weightedVariance = function weightedVariance(matrix, weights) {\n    var means = exports.mean(matrix);\n    var rows = matrix.length;\n    if (rows === 0) return [];\n    var cols = matrix[0].length;\n    var vari = new Array(cols);\n\n    for (var j = 0; j < cols; j++) {\n        var sum = 0;\n        var a = 0, b = 0;\n\n        for (var i = 0; i < rows; i++) {\n            var z = matrix[i][j] - means[j];\n            var w = weights[i];\n\n            sum += w * (z * z);\n            b += w;\n            a += w * w;\n        }\n\n        vari[j] = sum * (b / (b * b - a));\n    }\n\n    return vari;\n};\n\nexports.weightedMean = function weightedMean(matrix, weights, dimension) {\n    if (typeof (dimension) === 'undefined') {\n        dimension = 0;\n    }\n    var rows = matrix.length;\n    if (rows === 0) return [];\n    var cols = matrix[0].length,\n        means, i, ii, j, w, row;\n\n    if (dimension === 0) {\n        means = new Array(cols);\n        for (i = 0; i < cols; i++) {\n            means[i] = 0;\n        }\n        for (i = 0; i < rows; i++) {\n            row = matrix[i];\n            w = weights[i];\n            for (j = 0; j < cols; j++) {\n                means[j] += row[j] * w;\n            }\n        }\n    } else if (dimension === 1) {\n        means = new Array(rows);\n        for (i = 0; i < rows; i++) {\n            means[i] = 0;\n        }\n        for (j = 0; j < rows; j++) {\n            row = matrix[j];\n            w = weights[j];\n            for (i = 0; i < cols; i++) {\n                means[j] += row[i] * w;\n            }\n        }\n    } else {\n        throw new Error('Invalid dimension');\n    }\n\n    var weightSum = arrayStat.sum(weights);\n    if (weightSum !== 0) {\n        for (i = 0, ii = means.length; i < ii; i++) {\n            means[i] /= weightSum;\n        }\n    }\n    return means;\n};\n\nexports.weightedCovariance = function weightedCovariance(matrix, weights, means, dimension) {\n    dimension = dimension || 0;\n    means = means || exports.weightedMean(matrix, weights, dimension);\n    var s1 = 0, s2 = 0;\n    for (var i = 0, ii = weights.length; i < ii; i++) {\n        s1 += weights[i];\n        s2 += weights[i] * weights[i];\n    }\n    var factor = s1 / (s1 * s1 - s2);\n    return exports.weightedScatter(matrix, weights, means, factor, dimension);\n};\n\nexports.weightedScatter = function weightedScatter(matrix, weights, means, factor, dimension) {\n    dimension = dimension || 0;\n    means = means || exports.weightedMean(matrix, weights, dimension);\n    if (typeof (factor) === 'undefined') {\n        factor = 1;\n    }\n    var rows = matrix.length;\n    if (rows === 0) {\n        return [[]];\n    }\n    var cols = matrix[0].length,\n        cov, i, j, k, s;\n\n    if (dimension === 0) {\n        cov = new Array(cols);\n        for (i = 0; i < cols; i++) {\n            cov[i] = new Array(cols);\n        }\n        for (i = 0; i < cols; i++) {\n            for (j = i; j < cols; j++) {\n                s = 0;\n                for (k = 0; k < rows; k++) {\n                    s += weights[k] * (matrix[k][j] - means[j]) * (matrix[k][i] - means[i]);\n                }\n                cov[i][j] = s * factor;\n                cov[j][i] = s * factor;\n            }\n        }\n    } else if (dimension === 1) {\n        cov = new Array(rows);\n        for (i = 0; i < rows; i++) {\n            cov[i] = new Array(rows);\n        }\n        for (i = 0; i < rows; i++) {\n            for (j = i; j < rows; j++) {\n                s = 0;\n                for (k = 0; k < cols; k++) {\n                    s += weights[k] * (matrix[j][k] - means[j]) * (matrix[i][k] - means[i]);\n                }\n                cov[i][j] = s * factor;\n                cov[j][i] = s * factor;\n            }\n        }\n    } else {\n        throw new Error('Invalid dimension');\n    }\n\n    return cov;\n};\n","'use strict';\n\n/**\n *\n * Function that returns a Number array of equally spaced numberOfPoints\n * containing a representation of intensities of the spectra arguments x\n * and y.\n *\n * The options parameter contains an object in the following form:\n * from: starting point\n * to: last point\n * numberOfPoints: number of points between from and to\n * variant: \"slot\" or \"smooth\" - smooth is the default option\n *\n * The slot variant consist that each point in the new array is calculated\n * averaging the existing points between the slot that belongs to the current\n * value. The smooth variant is the same but takes the integral of the range\n * of the slot and divide by the step size between two points in the new array.\n *\n * @param x - sorted increasing x values\n * @param y\n * @param options\n * @returns {Array} new array with the equally spaced data.\n *\n */\nfunction getEquallySpacedData(x, y, options) {\n    if (x.length>1 && x[0]>x[1]) {\n        x=x.slice().reverse();\n        y=y.slice().reverse();\n    }\n\n    var xLength = x.length;\n    if(xLength !== y.length)\n        throw new RangeError(\"the x and y vector doesn't have the same size.\");\n\n    if (options === undefined) options = {};\n\n    var from = options.from === undefined ? x[0] : options.from\n    if (isNaN(from) || !isFinite(from)) {\n        throw new RangeError(\"'From' value must be a number\");\n    }\n    var to = options.to === undefined ? x[x.length - 1] : options.to;\n    if (isNaN(to) || !isFinite(to)) {\n        throw new RangeError(\"'To' value must be a number\");\n    }\n\n    var reverse = from > to;\n    if(reverse) {\n        var temp = from;\n        from = to;\n        to = temp;\n    }\n\n    var numberOfPoints = options.numberOfPoints === undefined ? 100 : options.numberOfPoints;\n    if (isNaN(numberOfPoints) || !isFinite(numberOfPoints)) {\n        throw new RangeError(\"'Number of points' value must be a number\");\n    }\n    if(numberOfPoints < 1)\n        throw new RangeError(\"the number of point must be higher than 1\");\n\n    var algorithm = options.variant === \"slot\" ? \"slot\" : \"smooth\"; // default value: smooth\n\n    var output = algorithm === \"slot\" ? getEquallySpacedSlot(x, y, from, to, numberOfPoints) : getEquallySpacedSmooth(x, y, from, to, numberOfPoints);\n\n    return reverse ? output.reverse() : output;\n}\n\n/**\n * function that retrieves the getEquallySpacedData with the variant \"smooth\"\n *\n * @param x\n * @param y\n * @param from - Initial point\n * @param to - Final point\n * @param numberOfPoints\n * @returns {Array} - Array of y's equally spaced with the variant \"smooth\"\n */\nfunction getEquallySpacedSmooth(x, y, from, to, numberOfPoints) {\n    var xLength = x.length;\n\n    var step = (to - from) / (numberOfPoints - 1);\n    var halfStep = step / 2;\n\n    var start = from - halfStep;\n    var output = new Array(numberOfPoints);\n\n    var initialOriginalStep = x[1] - x[0];\n    var lastOriginalStep = x[x.length - 1] - x[x.length - 2];\n\n    // Init main variables\n    var min = start;\n    var max = start + step;\n\n    var previousX = Number.MIN_VALUE;\n    var previousY = 0;\n    var nextX = x[0] - initialOriginalStep;\n    var nextY = 0;\n\n    var currentValue = 0;\n    var slope = 0;\n    var intercept = 0;\n    var sumAtMin = 0;\n    var sumAtMax = 0;\n\n    var i = 0; // index of input\n    var j = 0; // index of output\n\n    function getSlope(x0, y0, x1, y1) {\n        return (y1 - y0) / (x1 - x0);\n    }\n\n    main: while(true) {\n        while (nextX - max >= 0) {\n            // no overlap with original point, just consume current value\n            var add = integral(0, max - previousX, slope, previousY);\n            sumAtMax = currentValue + add;\n\n            output[j] = (sumAtMax - sumAtMin) / step;\n            j++;\n\n            if (j === numberOfPoints)\n                break main;\n\n            min = max;\n            max += step;\n            sumAtMin = sumAtMax;\n        }\n\n        if(previousX <= min && min <= nextX) {\n            add = integral(0, min - previousX, slope, previousY);\n            sumAtMin = currentValue + add;\n        }\n\n        currentValue += integral(previousX, nextX, slope, intercept);\n\n        previousX = nextX;\n        previousY = nextY;\n\n        if (i < xLength) {\n            nextX = x[i];\n            nextY = y[i];\n            i++;\n        } else if (i === xLength) {\n            nextX += lastOriginalStep;\n            nextY = 0;\n        }\n        // updating parameters\n        slope = getSlope(previousX, previousY, nextX, nextY);\n        intercept = -slope*previousX + previousY;\n    }\n\n    return output;\n}\n\n/**\n * function that retrieves the getEquallySpacedData with the variant \"slot\"\n *\n * @param x\n * @param y\n * @param from - Initial point\n * @param to - Final point\n * @param numberOfPoints\n * @returns {Array} - Array of y's equally spaced with the variant \"slot\"\n */\nfunction getEquallySpacedSlot(x, y, from, to, numberOfPoints) {\n    var xLength = x.length;\n\n    var step = (to - from) / (numberOfPoints - 1);\n    var halfStep = step / 2;\n    var lastStep = x[x.length - 1] - x[x.length - 2];\n\n    var start = from - halfStep;\n    var output = new Array(numberOfPoints);\n\n    // Init main variables\n    var min = start;\n    var max = start + step;\n\n    var previousX = -Number.MAX_VALUE;\n    var previousY = 0;\n    var nextX = x[0];\n    var nextY = y[0];\n    var frontOutsideSpectra = 0;\n    var backOutsideSpectra = true;\n\n    var currentValue = 0;\n\n    // for slot algorithm\n    var currentPoints = 0;\n\n    var i = 1; // index of input\n    var j = 0; // index of output\n\n    main: while(true) {\n        if (previousX>=nextX) throw (new Error('x must be an increasing serie'));\n        while (previousX - max > 0) {\n            // no overlap with original point, just consume current value\n            if(backOutsideSpectra) {\n                currentPoints++;\n                backOutsideSpectra = false;\n            }\n\n            output[j] = currentPoints <= 0 ? 0 : currentValue / currentPoints;\n            j++;\n\n            if (j === numberOfPoints)\n                break main;\n\n            min = max;\n            max += step;\n            currentValue = 0;\n            currentPoints = 0;\n        }\n\n        if(previousX > min) {\n            currentValue += previousY;\n            currentPoints++;\n        }\n\n        if(previousX === -Number.MAX_VALUE || frontOutsideSpectra > 1)\n            currentPoints--;\n\n        previousX = nextX;\n        previousY = nextY;\n\n        if (i < xLength) {\n            nextX = x[i];\n            nextY = y[i];\n            i++;\n        } else {\n            nextX += lastStep;\n            nextY = 0;\n            frontOutsideSpectra++;\n        }\n    }\n\n    return output;\n}\n/**\n * Function that calculates the integral of the line between two\n * x-coordinates, given the slope and intercept of the line.\n *\n * @param x0\n * @param x1\n * @param slope\n * @param intercept\n * @returns {number} integral value.\n */\nfunction integral(x0, x1, slope, intercept) {\n    return (0.5 * slope * x1 * x1 + intercept * x1) - (0.5 * slope * x0 * x0 + intercept * x0);\n}\n\nexports.getEquallySpacedData = getEquallySpacedData;\nexports.integral = integral;","'use strict';\n\nexports.SNV = SNV;\nvar Stat = require('ml-stat').array;\n\n/**\n * Function that applies the standard normal variate (SNV) to an array of values.\n *\n * @param data - Array of values.\n * @returns {Array} - applied the SNV.\n */\nfunction SNV(data) {\n    var mean = Stat.mean(data);\n    var std = Stat.standardDeviation(data);\n    var result = data.slice();\n    for (var i = 0; i < data.length; i++) {\n        result[i] = (result[i] - mean) / std;\n    }\n    return result;\n}\n","'use strict';\n\nvar BaseView = require('./base');\n\nclass MatrixTransposeView extends BaseView {\n    constructor(matrix) {\n        super(matrix, matrix.columns, matrix.rows);\n    }\n\n    set(rowIndex, columnIndex, value) {\n        this.matrix.set(columnIndex, rowIndex, value);\n        return this;\n    }\n\n    get(rowIndex, columnIndex) {\n        return this.matrix.get(columnIndex, rowIndex);\n    }\n}\n\nmodule.exports = MatrixTransposeView;\n","'use strict';\n\nvar BaseView = require('./base');\n\nclass MatrixRowView extends BaseView {\n    constructor(matrix, row) {\n        super(matrix, 1, matrix.columns);\n        this.row = row;\n    }\n\n    set(rowIndex, columnIndex, value) {\n        this.matrix.set(this.row, columnIndex, value);\n        return this;\n    }\n\n    get(rowIndex, columnIndex) {\n        return this.matrix.get(this.row, columnIndex);\n    }\n}\n\nmodule.exports = MatrixRowView;\n","'use strict';\n\nvar BaseView = require('./base');\nvar util = require('../util');\n\nclass MatrixSubView extends BaseView {\n    constructor(matrix, startRow, endRow, startColumn, endColumn) {\n        util.checkRange(matrix, startRow, endRow, startColumn, endColumn);\n        super(matrix, endRow - startRow + 1, endColumn - startColumn + 1);\n        this.startRow = startRow;\n        this.startColumn = startColumn;\n    }\n\n    set(rowIndex, columnIndex, value) {\n        this.matrix.set(this.startRow + rowIndex, this.startColumn + columnIndex, value);\n        return this;\n    }\n\n    get(rowIndex, columnIndex) {\n        return this.matrix.get(this.startRow + rowIndex, this.startColumn + columnIndex);\n    }\n}\n\nmodule.exports = MatrixSubView;\n","'use strict';\n\nvar BaseView = require('./base');\nvar util = require('../util');\n\nclass MatrixSelectionView extends BaseView {\n    constructor(matrix, rowIndices, columnIndices) {\n        var indices = util.checkIndices(matrix, rowIndices, columnIndices);\n        super(matrix, indices.row.length, indices.column.length);\n        this.rowIndices = indices.row;\n        this.columnIndices = indices.column;\n    }\n\n    set(rowIndex, columnIndex, value) {\n        this.matrix.set(this.rowIndices[rowIndex], this.columnIndices[columnIndex], value);\n        return this;\n    }\n\n    get(rowIndex, columnIndex) {\n        return this.matrix.get(this.rowIndices[rowIndex], this.columnIndices[columnIndex]);\n    }\n}\n\nmodule.exports = MatrixSelectionView;\n","'use strict';\n\nvar BaseView = require('./base');\n\nclass MatrixColumnView extends BaseView {\n    constructor(matrix, column) {\n        super(matrix, matrix.rows, 1);\n        this.column = column;\n    }\n\n    set(rowIndex, columnIndex, value) {\n        this.matrix.set(rowIndex, this.column, value);\n        return this;\n    }\n\n    get(rowIndex) {\n        return this.matrix.get(rowIndex, this.column);\n    }\n}\n\nmodule.exports = MatrixColumnView;\n","'use strict';\n\nvar BaseView = require('./base');\n\nclass MatrixFlipRowView extends BaseView {\n    constructor(matrix) {\n        super(matrix, matrix.rows, matrix.columns);\n    }\n\n    set(rowIndex, columnIndex, value) {\n        this.matrix.set(this.rows - rowIndex - 1, columnIndex, value);\n        return this;\n    }\n\n    get(rowIndex, columnIndex) {\n        return this.matrix.get(this.rows - rowIndex - 1, columnIndex);\n    }\n}\n\nmodule.exports = MatrixFlipRowView;\n","'use strict';\n\nvar BaseView = require('./base');\n\nclass MatrixFlipColumnView extends BaseView {\n    constructor(matrix) {\n        super(matrix, matrix.rows, matrix.columns);\n    }\n\n    set(rowIndex, columnIndex, value) {\n        this.matrix.set(rowIndex, this.columns - columnIndex - 1, value);\n        return this;\n    }\n\n    get(rowIndex, columnIndex) {\n        return this.matrix.get(rowIndex, this.columns - columnIndex - 1);\n    }\n}\n\nmodule.exports = MatrixFlipColumnView;\n","'use strict';\n\nvar Matrix = require('./matrix').Matrix;\n\nvar SingularValueDecomposition = require('./dc/svd');\nvar EigenvalueDecomposition = require('./dc/evd');\nvar LuDecomposition = require('./dc/lu');\nvar QrDecomposition = require('./dc/qr');\nvar CholeskyDecomposition = require('./dc/cholesky');\n\nfunction inverse(matrix) {\n    matrix = Matrix.checkMatrix(matrix);\n    return solve(matrix, Matrix.eye(matrix.rows));\n}\n\n/**\n * Returns the inverse\n * @memberOf Matrix\n * @static\n * @param {Matrix} matrix\n * @return {Matrix} matrix\n * @alias inv\n */\nMatrix.inverse = Matrix.inv = inverse;\n\n/**\n * Returns the inverse\n * @memberOf Matrix\n * @static\n * @param {Matrix} matrix\n * @return {Matrix} matrix\n * @alias inv\n */\nMatrix.prototype.inverse = Matrix.prototype.inv = function () {\n    return inverse(this);\n};\n\nfunction solve(leftHandSide, rightHandSide) {\n    leftHandSide = Matrix.checkMatrix(leftHandSide);\n    rightHandSide = Matrix.checkMatrix(rightHandSide);\n    return leftHandSide.isSquare() ? new LuDecomposition(leftHandSide).solve(rightHandSide) : new QrDecomposition(leftHandSide).solve(rightHandSide);\n}\n\nMatrix.solve = solve;\nMatrix.prototype.solve = function (other) {\n    return solve(this, other);\n};\n\nmodule.exports = {\n    SingularValueDecomposition: SingularValueDecomposition,\n    SVD: SingularValueDecomposition,\n    EigenvalueDecomposition: EigenvalueDecomposition,\n    EVD: EigenvalueDecomposition,\n    LuDecomposition: LuDecomposition,\n    LU: LuDecomposition,\n    QrDecomposition: QrDecomposition,\n    QR: QrDecomposition,\n    CholeskyDecomposition: CholeskyDecomposition,\n    CHO: CholeskyDecomposition,\n    inverse: inverse,\n    solve: solve\n};\n","'use strict';\n\nconst Matrix = require('../matrix').Matrix;\nconst util = require('./util');\nconst hypotenuse = util.hypotenuse;\nconst getFilled2DArray = util.getFilled2DArray;\n\nconst defaultOptions = {\n    assumeSymmetric: false\n};\n\n// https://github.com/lutzroeder/Mapack/blob/master/Source/EigenvalueDecomposition.cs\nfunction EigenvalueDecomposition(matrix, options) {\n    options = Object.assign({}, defaultOptions, options);\n    if (!(this instanceof EigenvalueDecomposition)) {\n        return new EigenvalueDecomposition(matrix, options);\n    }\n    matrix = Matrix.checkMatrix(matrix);\n    if (!matrix.isSquare()) {\n        throw new Error('Matrix is not a square matrix');\n    }\n\n    var n = matrix.columns,\n        V = getFilled2DArray(n, n, 0),\n        d = new Array(n),\n        e = new Array(n),\n        value = matrix,\n        i, j;\n\n    var isSymmetric = false;\n    if (options.assumeSymmetric) {\n        isSymmetric = true;\n    } else {\n        isSymmetric = matrix.isSymmetric();\n    }\n\n    if (isSymmetric) {\n        for (i = 0; i < n; i++) {\n            for (j = 0; j < n; j++) {\n                V[i][j] = value.get(i, j);\n            }\n        }\n        tred2(n, e, d, V);\n        tql2(n, e, d, V);\n    } else {\n        var H = getFilled2DArray(n, n, 0),\n            ort = new Array(n);\n        for (j = 0; j < n; j++) {\n            for (i = 0; i < n; i++) {\n                H[i][j] = value.get(i, j);\n            }\n        }\n        orthes(n, H, ort, V);\n        hqr2(n, e, d, V, H);\n    }\n\n    this.n = n;\n    this.e = e;\n    this.d = d;\n    this.V = V;\n}\n\nEigenvalueDecomposition.prototype = {\n    get realEigenvalues() {\n        return this.d;\n    },\n    get imaginaryEigenvalues() {\n        return this.e;\n    },\n    get eigenvectorMatrix() {\n        if (!Matrix.isMatrix(this.V)) {\n            this.V = new Matrix(this.V);\n        }\n        return this.V;\n    },\n    get diagonalMatrix() {\n        var n = this.n,\n            e = this.e,\n            d = this.d,\n            X = new Matrix(n, n),\n            i, j;\n        for (i = 0; i < n; i++) {\n            for (j = 0; j < n; j++) {\n                X[i][j] = 0;\n            }\n            X[i][i] = d[i];\n            if (e[i] > 0) {\n                X[i][i + 1] = e[i];\n            } else if (e[i] < 0) {\n                X[i][i - 1] = e[i];\n            }\n        }\n        return X;\n    }\n};\n\nfunction tred2(n, e, d, V) {\n\n    var f, g, h, i, j, k,\n        hh, scale;\n\n    for (j = 0; j < n; j++) {\n        d[j] = V[n - 1][j];\n    }\n\n    for (i = n - 1; i > 0; i--) {\n        scale = 0;\n        h = 0;\n        for (k = 0; k < i; k++) {\n            scale = scale + Math.abs(d[k]);\n        }\n\n        if (scale === 0) {\n            e[i] = d[i - 1];\n            for (j = 0; j < i; j++) {\n                d[j] = V[i - 1][j];\n                V[i][j] = 0;\n                V[j][i] = 0;\n            }\n        } else {\n            for (k = 0; k < i; k++) {\n                d[k] /= scale;\n                h += d[k] * d[k];\n            }\n\n            f = d[i - 1];\n            g = Math.sqrt(h);\n            if (f > 0) {\n                g = -g;\n            }\n\n            e[i] = scale * g;\n            h = h - f * g;\n            d[i - 1] = f - g;\n            for (j = 0; j < i; j++) {\n                e[j] = 0;\n            }\n\n            for (j = 0; j < i; j++) {\n                f = d[j];\n                V[j][i] = f;\n                g = e[j] + V[j][j] * f;\n                for (k = j + 1; k <= i - 1; k++) {\n                    g += V[k][j] * d[k];\n                    e[k] += V[k][j] * f;\n                }\n                e[j] = g;\n            }\n\n            f = 0;\n            for (j = 0; j < i; j++) {\n                e[j] /= h;\n                f += e[j] * d[j];\n            }\n\n            hh = f / (h + h);\n            for (j = 0; j < i; j++) {\n                e[j] -= hh * d[j];\n            }\n\n            for (j = 0; j < i; j++) {\n                f = d[j];\n                g = e[j];\n                for (k = j; k <= i - 1; k++) {\n                    V[k][j] -= (f * e[k] + g * d[k]);\n                }\n                d[j] = V[i - 1][j];\n                V[i][j] = 0;\n            }\n        }\n        d[i] = h;\n    }\n\n    for (i = 0; i < n - 1; i++) {\n        V[n - 1][i] = V[i][i];\n        V[i][i] = 1;\n        h = d[i + 1];\n        if (h !== 0) {\n            for (k = 0; k <= i; k++) {\n                d[k] = V[k][i + 1] / h;\n            }\n\n            for (j = 0; j <= i; j++) {\n                g = 0;\n                for (k = 0; k <= i; k++) {\n                    g += V[k][i + 1] * V[k][j];\n                }\n                for (k = 0; k <= i; k++) {\n                    V[k][j] -= g * d[k];\n                }\n            }\n        }\n\n        for (k = 0; k <= i; k++) {\n            V[k][i + 1] = 0;\n        }\n    }\n\n    for (j = 0; j < n; j++) {\n        d[j] = V[n - 1][j];\n        V[n - 1][j] = 0;\n    }\n\n    V[n - 1][n - 1] = 1;\n    e[0] = 0;\n}\n\nfunction tql2(n, e, d, V) {\n\n    var g, h, i, j, k, l, m, p, r,\n        dl1, c, c2, c3, el1, s, s2,\n        iter;\n\n    for (i = 1; i < n; i++) {\n        e[i - 1] = e[i];\n    }\n\n    e[n - 1] = 0;\n\n    var f = 0,\n        tst1 = 0,\n        eps = Math.pow(2, -52);\n\n    for (l = 0; l < n; l++) {\n        tst1 = Math.max(tst1, Math.abs(d[l]) + Math.abs(e[l]));\n        m = l;\n        while (m < n) {\n            if (Math.abs(e[m]) <= eps * tst1) {\n                break;\n            }\n            m++;\n        }\n\n        if (m > l) {\n            iter = 0;\n            do {\n                iter = iter + 1;\n\n                g = d[l];\n                p = (d[l + 1] - g) / (2 * e[l]);\n                r = hypotenuse(p, 1);\n                if (p < 0) {\n                    r = -r;\n                }\n\n                d[l] = e[l] / (p + r);\n                d[l + 1] = e[l] * (p + r);\n                dl1 = d[l + 1];\n                h = g - d[l];\n                for (i = l + 2; i < n; i++) {\n                    d[i] -= h;\n                }\n\n                f = f + h;\n\n                p = d[m];\n                c = 1;\n                c2 = c;\n                c3 = c;\n                el1 = e[l + 1];\n                s = 0;\n                s2 = 0;\n                for (i = m - 1; i >= l; i--) {\n                    c3 = c2;\n                    c2 = c;\n                    s2 = s;\n                    g = c * e[i];\n                    h = c * p;\n                    r = hypotenuse(p, e[i]);\n                    e[i + 1] = s * r;\n                    s = e[i] / r;\n                    c = p / r;\n                    p = c * d[i] - s * g;\n                    d[i + 1] = h + s * (c * g + s * d[i]);\n\n                    for (k = 0; k < n; k++) {\n                        h = V[k][i + 1];\n                        V[k][i + 1] = s * V[k][i] + c * h;\n                        V[k][i] = c * V[k][i] - s * h;\n                    }\n                }\n\n                p = -s * s2 * c3 * el1 * e[l] / dl1;\n                e[l] = s * p;\n                d[l] = c * p;\n\n            }\n            while (Math.abs(e[l]) > eps * tst1);\n        }\n        d[l] = d[l] + f;\n        e[l] = 0;\n    }\n\n    for (i = 0; i < n - 1; i++) {\n        k = i;\n        p = d[i];\n        for (j = i + 1; j < n; j++) {\n            if (d[j] < p) {\n                k = j;\n                p = d[j];\n            }\n        }\n\n        if (k !== i) {\n            d[k] = d[i];\n            d[i] = p;\n            for (j = 0; j < n; j++) {\n                p = V[j][i];\n                V[j][i] = V[j][k];\n                V[j][k] = p;\n            }\n        }\n    }\n}\n\nfunction orthes(n, H, ort, V) {\n\n    var low = 0,\n        high = n - 1,\n        f, g, h, i, j, m,\n        scale;\n\n    for (m = low + 1; m <= high - 1; m++) {\n        scale = 0;\n        for (i = m; i <= high; i++) {\n            scale = scale + Math.abs(H[i][m - 1]);\n        }\n\n        if (scale !== 0) {\n            h = 0;\n            for (i = high; i >= m; i--) {\n                ort[i] = H[i][m - 1] / scale;\n                h += ort[i] * ort[i];\n            }\n\n            g = Math.sqrt(h);\n            if (ort[m] > 0) {\n                g = -g;\n            }\n\n            h = h - ort[m] * g;\n            ort[m] = ort[m] - g;\n\n            for (j = m; j < n; j++) {\n                f = 0;\n                for (i = high; i >= m; i--) {\n                    f += ort[i] * H[i][j];\n                }\n\n                f = f / h;\n                for (i = m; i <= high; i++) {\n                    H[i][j] -= f * ort[i];\n                }\n            }\n\n            for (i = 0; i <= high; i++) {\n                f = 0;\n                for (j = high; j >= m; j--) {\n                    f += ort[j] * H[i][j];\n                }\n\n                f = f / h;\n                for (j = m; j <= high; j++) {\n                    H[i][j] -= f * ort[j];\n                }\n            }\n\n            ort[m] = scale * ort[m];\n            H[m][m - 1] = scale * g;\n        }\n    }\n\n    for (i = 0; i < n; i++) {\n        for (j = 0; j < n; j++) {\n            V[i][j] = (i === j ? 1 : 0);\n        }\n    }\n\n    for (m = high - 1; m >= low + 1; m--) {\n        if (H[m][m - 1] !== 0) {\n            for (i = m + 1; i <= high; i++) {\n                ort[i] = H[i][m - 1];\n            }\n\n            for (j = m; j <= high; j++) {\n                g = 0;\n                for (i = m; i <= high; i++) {\n                    g += ort[i] * V[i][j];\n                }\n\n                g = (g / ort[m]) / H[m][m - 1];\n                for (i = m; i <= high; i++) {\n                    V[i][j] += g * ort[i];\n                }\n            }\n        }\n    }\n}\n\nfunction hqr2(nn, e, d, V, H) {\n    var n = nn - 1,\n        low = 0,\n        high = nn - 1,\n        eps = Math.pow(2, -52),\n        exshift = 0,\n        norm = 0,\n        p = 0,\n        q = 0,\n        r = 0,\n        s = 0,\n        z = 0,\n        iter = 0,\n        i, j, k, l, m, t, w, x, y,\n        ra, sa, vr, vi,\n        notlast, cdivres;\n\n    for (i = 0; i < nn; i++) {\n        if (i < low || i > high) {\n            d[i] = H[i][i];\n            e[i] = 0;\n        }\n\n        for (j = Math.max(i - 1, 0); j < nn; j++) {\n            norm = norm + Math.abs(H[i][j]);\n        }\n    }\n\n    while (n >= low) {\n        l = n;\n        while (l > low) {\n            s = Math.abs(H[l - 1][l - 1]) + Math.abs(H[l][l]);\n            if (s === 0) {\n                s = norm;\n            }\n            if (Math.abs(H[l][l - 1]) < eps * s) {\n                break;\n            }\n            l--;\n        }\n\n        if (l === n) {\n            H[n][n] = H[n][n] + exshift;\n            d[n] = H[n][n];\n            e[n] = 0;\n            n--;\n            iter = 0;\n        } else if (l === n - 1) {\n            w = H[n][n - 1] * H[n - 1][n];\n            p = (H[n - 1][n - 1] - H[n][n]) / 2;\n            q = p * p + w;\n            z = Math.sqrt(Math.abs(q));\n            H[n][n] = H[n][n] + exshift;\n            H[n - 1][n - 1] = H[n - 1][n - 1] + exshift;\n            x = H[n][n];\n\n            if (q >= 0) {\n                z = (p >= 0) ? (p + z) : (p - z);\n                d[n - 1] = x + z;\n                d[n] = d[n - 1];\n                if (z !== 0) {\n                    d[n] = x - w / z;\n                }\n                e[n - 1] = 0;\n                e[n] = 0;\n                x = H[n][n - 1];\n                s = Math.abs(x) + Math.abs(z);\n                p = x / s;\n                q = z / s;\n                r = Math.sqrt(p * p + q * q);\n                p = p / r;\n                q = q / r;\n\n                for (j = n - 1; j < nn; j++) {\n                    z = H[n - 1][j];\n                    H[n - 1][j] = q * z + p * H[n][j];\n                    H[n][j] = q * H[n][j] - p * z;\n                }\n\n                for (i = 0; i <= n; i++) {\n                    z = H[i][n - 1];\n                    H[i][n - 1] = q * z + p * H[i][n];\n                    H[i][n] = q * H[i][n] - p * z;\n                }\n\n                for (i = low; i <= high; i++) {\n                    z = V[i][n - 1];\n                    V[i][n - 1] = q * z + p * V[i][n];\n                    V[i][n] = q * V[i][n] - p * z;\n                }\n            } else {\n                d[n - 1] = x + p;\n                d[n] = x + p;\n                e[n - 1] = z;\n                e[n] = -z;\n            }\n\n            n = n - 2;\n            iter = 0;\n        } else {\n            x = H[n][n];\n            y = 0;\n            w = 0;\n            if (l < n) {\n                y = H[n - 1][n - 1];\n                w = H[n][n - 1] * H[n - 1][n];\n            }\n\n            if (iter === 10) {\n                exshift += x;\n                for (i = low; i <= n; i++) {\n                    H[i][i] -= x;\n                }\n                s = Math.abs(H[n][n - 1]) + Math.abs(H[n - 1][n - 2]);\n                x = y = 0.75 * s;\n                w = -0.4375 * s * s;\n            }\n\n            if (iter === 30) {\n                s = (y - x) / 2;\n                s = s * s + w;\n                if (s > 0) {\n                    s = Math.sqrt(s);\n                    if (y < x) {\n                        s = -s;\n                    }\n                    s = x - w / ((y - x) / 2 + s);\n                    for (i = low; i <= n; i++) {\n                        H[i][i] -= s;\n                    }\n                    exshift += s;\n                    x = y = w = 0.964;\n                }\n            }\n\n            iter = iter + 1;\n\n            m = n - 2;\n            while (m >= l) {\n                z = H[m][m];\n                r = x - z;\n                s = y - z;\n                p = (r * s - w) / H[m + 1][m] + H[m][m + 1];\n                q = H[m + 1][m + 1] - z - r - s;\n                r = H[m + 2][m + 1];\n                s = Math.abs(p) + Math.abs(q) + Math.abs(r);\n                p = p / s;\n                q = q / s;\n                r = r / s;\n                if (m === l) {\n                    break;\n                }\n                if (Math.abs(H[m][m - 1]) * (Math.abs(q) + Math.abs(r)) < eps * (Math.abs(p) * (Math.abs(H[m - 1][m - 1]) + Math.abs(z) + Math.abs(H[m + 1][m + 1])))) {\n                    break;\n                }\n                m--;\n            }\n\n            for (i = m + 2; i <= n; i++) {\n                H[i][i - 2] = 0;\n                if (i > m + 2) {\n                    H[i][i - 3] = 0;\n                }\n            }\n\n            for (k = m; k <= n - 1; k++) {\n                notlast = (k !== n - 1);\n                if (k !== m) {\n                    p = H[k][k - 1];\n                    q = H[k + 1][k - 1];\n                    r = (notlast ? H[k + 2][k - 1] : 0);\n                    x = Math.abs(p) + Math.abs(q) + Math.abs(r);\n                    if (x !== 0) {\n                        p = p / x;\n                        q = q / x;\n                        r = r / x;\n                    }\n                }\n\n                if (x === 0) {\n                    break;\n                }\n\n                s = Math.sqrt(p * p + q * q + r * r);\n                if (p < 0) {\n                    s = -s;\n                }\n\n                if (s !== 0) {\n                    if (k !== m) {\n                        H[k][k - 1] = -s * x;\n                    } else if (l !== m) {\n                        H[k][k - 1] = -H[k][k - 1];\n                    }\n\n                    p = p + s;\n                    x = p / s;\n                    y = q / s;\n                    z = r / s;\n                    q = q / p;\n                    r = r / p;\n\n                    for (j = k; j < nn; j++) {\n                        p = H[k][j] + q * H[k + 1][j];\n                        if (notlast) {\n                            p = p + r * H[k + 2][j];\n                            H[k + 2][j] = H[k + 2][j] - p * z;\n                        }\n\n                        H[k][j] = H[k][j] - p * x;\n                        H[k + 1][j] = H[k + 1][j] - p * y;\n                    }\n\n                    for (i = 0; i <= Math.min(n, k + 3); i++) {\n                        p = x * H[i][k] + y * H[i][k + 1];\n                        if (notlast) {\n                            p = p + z * H[i][k + 2];\n                            H[i][k + 2] = H[i][k + 2] - p * r;\n                        }\n\n                        H[i][k] = H[i][k] - p;\n                        H[i][k + 1] = H[i][k + 1] - p * q;\n                    }\n\n                    for (i = low; i <= high; i++) {\n                        p = x * V[i][k] + y * V[i][k + 1];\n                        if (notlast) {\n                            p = p + z * V[i][k + 2];\n                            V[i][k + 2] = V[i][k + 2] - p * r;\n                        }\n\n                        V[i][k] = V[i][k] - p;\n                        V[i][k + 1] = V[i][k + 1] - p * q;\n                    }\n                }\n            }\n        }\n    }\n\n    if (norm === 0) {\n        return;\n    }\n\n    for (n = nn - 1; n >= 0; n--) {\n        p = d[n];\n        q = e[n];\n\n        if (q === 0) {\n            l = n;\n            H[n][n] = 1;\n            for (i = n - 1; i >= 0; i--) {\n                w = H[i][i] - p;\n                r = 0;\n                for (j = l; j <= n; j++) {\n                    r = r + H[i][j] * H[j][n];\n                }\n\n                if (e[i] < 0) {\n                    z = w;\n                    s = r;\n                } else {\n                    l = i;\n                    if (e[i] === 0) {\n                        H[i][n] = (w !== 0) ? (-r / w) : (-r / (eps * norm));\n                    } else {\n                        x = H[i][i + 1];\n                        y = H[i + 1][i];\n                        q = (d[i] - p) * (d[i] - p) + e[i] * e[i];\n                        t = (x * s - z * r) / q;\n                        H[i][n] = t;\n                        H[i + 1][n] = (Math.abs(x) > Math.abs(z)) ? ((-r - w * t) / x) : ((-s - y * t) / z);\n                    }\n\n                    t = Math.abs(H[i][n]);\n                    if ((eps * t) * t > 1) {\n                        for (j = i; j <= n; j++) {\n                            H[j][n] = H[j][n] / t;\n                        }\n                    }\n                }\n            }\n        } else if (q < 0) {\n            l = n - 1;\n\n            if (Math.abs(H[n][n - 1]) > Math.abs(H[n - 1][n])) {\n                H[n - 1][n - 1] = q / H[n][n - 1];\n                H[n - 1][n] = -(H[n][n] - p) / H[n][n - 1];\n            } else {\n                cdivres = cdiv(0, -H[n - 1][n], H[n - 1][n - 1] - p, q);\n                H[n - 1][n - 1] = cdivres[0];\n                H[n - 1][n] = cdivres[1];\n            }\n\n            H[n][n - 1] = 0;\n            H[n][n] = 1;\n            for (i = n - 2; i >= 0; i--) {\n                ra = 0;\n                sa = 0;\n                for (j = l; j <= n; j++) {\n                    ra = ra + H[i][j] * H[j][n - 1];\n                    sa = sa + H[i][j] * H[j][n];\n                }\n\n                w = H[i][i] - p;\n\n                if (e[i] < 0) {\n                    z = w;\n                    r = ra;\n                    s = sa;\n                } else {\n                    l = i;\n                    if (e[i] === 0) {\n                        cdivres = cdiv(-ra, -sa, w, q);\n                        H[i][n - 1] = cdivres[0];\n                        H[i][n] = cdivres[1];\n                    } else {\n                        x = H[i][i + 1];\n                        y = H[i + 1][i];\n                        vr = (d[i] - p) * (d[i] - p) + e[i] * e[i] - q * q;\n                        vi = (d[i] - p) * 2 * q;\n                        if (vr === 0 && vi === 0) {\n                            vr = eps * norm * (Math.abs(w) + Math.abs(q) + Math.abs(x) + Math.abs(y) + Math.abs(z));\n                        }\n                        cdivres = cdiv(x * r - z * ra + q * sa, x * s - z * sa - q * ra, vr, vi);\n                        H[i][n - 1] = cdivres[0];\n                        H[i][n] = cdivres[1];\n                        if (Math.abs(x) > (Math.abs(z) + Math.abs(q))) {\n                            H[i + 1][n - 1] = (-ra - w * H[i][n - 1] + q * H[i][n]) / x;\n                            H[i + 1][n] = (-sa - w * H[i][n] - q * H[i][n - 1]) / x;\n                        } else {\n                            cdivres = cdiv(-r - y * H[i][n - 1], -s - y * H[i][n], z, q);\n                            H[i + 1][n - 1] = cdivres[0];\n                            H[i + 1][n] = cdivres[1];\n                        }\n                    }\n\n                    t = Math.max(Math.abs(H[i][n - 1]), Math.abs(H[i][n]));\n                    if ((eps * t) * t > 1) {\n                        for (j = i; j <= n; j++) {\n                            H[j][n - 1] = H[j][n - 1] / t;\n                            H[j][n] = H[j][n] / t;\n                        }\n                    }\n                }\n            }\n        }\n    }\n\n    for (i = 0; i < nn; i++) {\n        if (i < low || i > high) {\n            for (j = i; j < nn; j++) {\n                V[i][j] = H[i][j];\n            }\n        }\n    }\n\n    for (j = nn - 1; j >= low; j--) {\n        for (i = low; i <= high; i++) {\n            z = 0;\n            for (k = low; k <= Math.min(j, high); k++) {\n                z = z + V[i][k] * H[k][j];\n            }\n            V[i][j] = z;\n        }\n    }\n}\n\nfunction cdiv(xr, xi, yr, yi) {\n    var r, d;\n    if (Math.abs(yr) > Math.abs(yi)) {\n        r = yi / yr;\n        d = yr + r * yi;\n        return [(xr + r * xi) / d, (xi - r * xr) / d];\n    } else {\n        r = yr / yi;\n        d = yi + r * yr;\n        return [(r * xr + xi) / d, (r * xi - xr) / d];\n    }\n}\n\nmodule.exports = EigenvalueDecomposition;\n","'use strict';\n\nvar Matrix = require('../matrix').Matrix;\nvar hypotenuse = require('./util').hypotenuse;\n\n//https://github.com/lutzroeder/Mapack/blob/master/Source/QrDecomposition.cs\nfunction QrDecomposition(value) {\n    if (!(this instanceof QrDecomposition)) {\n        return new QrDecomposition(value);\n    }\n    value = Matrix.checkMatrix(value);\n\n    var qr = value.clone(),\n        m = value.rows,\n        n = value.columns,\n        rdiag = new Array(n),\n        i, j, k, s;\n\n    for (k = 0; k < n; k++) {\n        var nrm = 0;\n        for (i = k; i < m; i++) {\n            nrm = hypotenuse(nrm, qr[i][k]);\n        }\n        if (nrm !== 0) {\n            if (qr[k][k] < 0) {\n                nrm = -nrm;\n            }\n            for (i = k; i < m; i++) {\n                qr[i][k] /= nrm;\n            }\n            qr[k][k] += 1;\n            for (j = k + 1; j < n; j++) {\n                s = 0;\n                for (i = k; i < m; i++) {\n                    s += qr[i][k] * qr[i][j];\n                }\n                s = -s / qr[k][k];\n                for (i = k; i < m; i++) {\n                    qr[i][j] += s * qr[i][k];\n                }\n            }\n        }\n        rdiag[k] = -nrm;\n    }\n\n    this.QR = qr;\n    this.Rdiag = rdiag;\n}\n\nQrDecomposition.prototype = {\n    solve: function (value) {\n        value = Matrix.checkMatrix(value);\n\n        var qr = this.QR,\n            m = qr.rows;\n\n        if (value.rows !== m) {\n            throw new Error('Matrix row dimensions must agree');\n        }\n        if (!this.isFullRank()) {\n            throw new Error('Matrix is rank deficient');\n        }\n\n        var count = value.columns;\n        var X = value.clone();\n        var n = qr.columns;\n        var i, j, k, s;\n\n        for (k = 0; k < n; k++) {\n            for (j = 0; j < count; j++) {\n                s = 0;\n                for (i = k; i < m; i++) {\n                    s += qr[i][k] * X[i][j];\n                }\n                s = -s / qr[k][k];\n                for (i = k; i < m; i++) {\n                    X[i][j] += s * qr[i][k];\n                }\n            }\n        }\n        for (k = n - 1; k >= 0; k--) {\n            for (j = 0; j < count; j++) {\n                X[k][j] /= this.Rdiag[k];\n            }\n            for (i = 0; i < k; i++) {\n                for (j = 0; j < count; j++) {\n                    X[i][j] -= X[k][j] * qr[i][k];\n                }\n            }\n        }\n\n        return X.subMatrix(0, n - 1, 0, count - 1);\n    },\n    isFullRank: function () {\n        var columns = this.QR.columns;\n        for (var i = 0; i < columns; i++) {\n            if (this.Rdiag[i] === 0) {\n                return false;\n            }\n        }\n        return true;\n    },\n    get upperTriangularMatrix() {\n        var qr = this.QR,\n            n = qr.columns,\n            X = new Matrix(n, n),\n            i, j;\n        for (i = 0; i < n; i++) {\n            for (j = 0; j < n; j++) {\n                if (i < j) {\n                    X[i][j] = qr[i][j];\n                } else if (i === j) {\n                    X[i][j] = this.Rdiag[i];\n                } else {\n                    X[i][j] = 0;\n                }\n            }\n        }\n        return X;\n    },\n    get orthogonalMatrix() {\n        var qr = this.QR,\n            rows = qr.rows,\n            columns = qr.columns,\n            X = new Matrix(rows, columns),\n            i, j, k, s;\n\n        for (k = columns - 1; k >= 0; k--) {\n            for (i = 0; i < rows; i++) {\n                X[i][k] = 0;\n            }\n            X[k][k] = 1;\n            for (j = k; j < columns; j++) {\n                if (qr[k][k] !== 0) {\n                    s = 0;\n                    for (i = k; i < rows; i++) {\n                        s += qr[i][k] * X[i][j];\n                    }\n\n                    s = -s / qr[k][k];\n\n                    for (i = k; i < rows; i++) {\n                        X[i][j] += s * qr[i][k];\n                    }\n                }\n            }\n        }\n        return X;\n    }\n};\n\nmodule.exports = QrDecomposition;\n","'use strict';\n\nvar Matrix = require('../matrix').Matrix;\n\n// https://github.com/lutzroeder/Mapack/blob/master/Source/CholeskyDecomposition.cs\nfunction CholeskyDecomposition(value) {\n    if (!(this instanceof CholeskyDecomposition)) {\n        return new CholeskyDecomposition(value);\n    }\n    value = Matrix.checkMatrix(value);\n    if (!value.isSymmetric()) {\n        throw new Error('Matrix is not symmetric');\n    }\n\n    var a = value,\n        dimension = a.rows,\n        l = new Matrix(dimension, dimension),\n        positiveDefinite = true,\n        i, j, k;\n\n    for (j = 0; j < dimension; j++) {\n        var Lrowj = l[j];\n        var d = 0;\n        for (k = 0; k < j; k++) {\n            var Lrowk = l[k];\n            var s = 0;\n            for (i = 0; i < k; i++) {\n                s += Lrowk[i] * Lrowj[i];\n            }\n            Lrowj[k] = s = (a[j][k] - s) / l[k][k];\n            d = d + s * s;\n        }\n\n        d = a[j][j] - d;\n\n        positiveDefinite &= (d > 0);\n        l[j][j] = Math.sqrt(Math.max(d, 0));\n        for (k = j + 1; k < dimension; k++) {\n            l[j][k] = 0;\n        }\n    }\n\n    if (!positiveDefinite) {\n        throw new Error('Matrix is not positive definite');\n    }\n\n    this.L = l;\n}\n\nCholeskyDecomposition.prototype = {\n    get lowerTriangularMatrix() {\n        return this.L;\n    },\n    solve: function (value) {\n        value = Matrix.checkMatrix(value);\n\n        var l = this.L,\n            dimension = l.rows;\n\n        if (value.rows !== dimension) {\n            throw new Error('Matrix dimensions do not match');\n        }\n\n        var count = value.columns,\n            B = value.clone(),\n            i, j, k;\n\n        for (k = 0; k < dimension; k++) {\n            for (j = 0; j < count; j++) {\n                for (i = 0; i < k; i++) {\n                    B[k][j] -= B[i][j] * l[k][i];\n                }\n                B[k][j] /= l[k][k];\n            }\n        }\n\n        for (k = dimension - 1; k >= 0; k--) {\n            for (j = 0; j < count; j++) {\n                for (i = k + 1; i < dimension; i++) {\n                    B[k][j] -= B[i][j] * l[i][k];\n                }\n                B[k][j] /= l[k][k];\n            }\n        }\n\n        return B;\n    }\n};\n\nmodule.exports = CholeskyDecomposition;\n","'use strict';\n\nvar Opt = require('ml-optimize-lorentzian');\n\n/**\n * This function try to join the peaks that seems to belong to a broad signal in a single broad peak.\n * @param peakList\n * @param options\n */\nmodule.exports = function joinBroadPeaks(peakList, options = {}) {\n  var width = options.width;\n  var broadLines = [];\n  // Optimize the possible broad lines\n  var max = 0;\n\n  var maxI = 0;\n\n  var count = 1;\n  for (let i = peakList.length - 1; i >= 0; i--) {\n    if (peakList[i].soft) {\n      broadLines.push(peakList.splice(i, 1)[0]);\n    }\n  }\n  // Push a feak peak\n  broadLines.push({ x: Number.MAX_VALUE });\n\n  var candidates = [[broadLines[0].x, broadLines[0].y]];\n  var indexes = [0];\n\n  for (let i = 1; i < broadLines.length; i++) {\n    // console.log(broadLines[i-1].x+\" \"+broadLines[i].x);\n    if (Math.abs(broadLines[i - 1].x - broadLines[i].x) < width) {\n      candidates.push([broadLines[i].x, broadLines[i].y]);\n      if (broadLines[i].y > max) {\n        max = broadLines[i].y;\n        maxI = i;\n      }\n      indexes.push(i);\n      count++;\n    } else {\n      if (count > 2) {\n        var fitted = Opt.optimizeSingleLorentzian(candidates, {\n          x: broadLines[maxI].x,\n          y: max,\n          width: Math.abs(\n            candidates[0][0] - candidates[candidates.length - 1][0]\n          )\n        });\n        peakList.push({\n          x: fitted[0][0],\n          y: fitted[1][0],\n          width: fitted[2][0],\n          soft: false\n        });\n      } else {\n        // Put back the candidates to the signals list\n        indexes.forEach((index) => {\n          peakList.push(broadLines[index]);\n        });\n      }\n      candidates = [[broadLines[i].x, broadLines[i].y]];\n      indexes = [i];\n      max = broadLines[i].y;\n      maxI = i;\n      count = 1;\n    }\n  }\n\n  peakList.sort(function (a, b) {\n    return a.x - b.x;\n  });\n\n  return peakList;\n};\n","'use strict';\n\n/**\n * This method will allow to enlarge peaks and prevent overlap between peaks\n * Because peaks may not be symmetric after we add 2 properties, from and to.\n * @param {Array} peakList\n * @param {object} [options={}]\n * @param {number} [factor=2]\n * @param {boolean} [overlap=false] by default we don't allow overlap\n * @return {Array} peakList\n */\nmodule.exports = function broadenPeaks(peakList, options = {}) {\n  const { factor = 2, overlap = false } = options;\n\n  for (let peak of peakList) {\n    peak.from = peak.x - (peak.width / 2) * factor;\n    peak.to = peak.x + (peak.width / 2) * factor;\n  }\n\n  if (!overlap) {\n    for (let i = 0; i < peakList.length - 1; i++) {\n      let peak = peakList[i];\n      let nextPeak = peakList[i + 1];\n      if (peak.to > nextPeak.from) {\n        peak.to = nextPeak.from = (peak.to + nextPeak.from) / 2;\n      }\n    }\n  }\n\n  for (let peak of peakList) {\n    peak.width = peak.to - peak.from;\n  }\n\n  return peakList;\n};\n","'use strict';\n\nfunction getConverter() {\n  // the following RegExp can only be used for XYdata, some peakTables have values with a \"E-5\" ...\n  const ntuplesSeparator = /[, \\t]+/;\n  const GC_MS_FIELDS = ['TIC', '.RIC', 'SCANNUMBER'];\n\n  function convertToFloatArray(stringArray) {\n    var floatArray = [];\n    for (let i = 0; i < stringArray.length; i++) {\n      floatArray.push(parseFloat(stringArray[i]));\n    }\n    return floatArray;\n  }\n\n  class Spectrum {}\n\n  const defaultOptions = {\n    keepRecordsRegExp: /^$/,\n    xy: false,\n    withoutXY: false,\n    chromatogram: false,\n    keepSpectra: false,\n    noContour: false,\n    nbContourLevels: 7,\n    noiseMultiplier: 5,\n    profiling: false\n  };\n\n  function convert(jcamp, options) {\n    options = Object.assign({}, defaultOptions, options);\n\n    var wantXY = !options.withoutXY;\n\n    var start = Date.now();\n\n    var ntuples = {};\n    var ldr, dataLabel, dataValue, ldrs;\n    var position, endLine, infos;\n\n    var result = {};\n    result.profiling = options.profiling ? [] : false;\n    result.logs = [];\n    var spectra = [];\n    result.spectra = spectra;\n    result.info = {};\n    var spectrum = new Spectrum();\n\n    if (!(typeof jcamp === 'string')) {\n      throw new TypeError('the JCAMP should be a string');\n    }\n\n    if (result.profiling) {\n      result.profiling.push({\n        action: 'Before split to LDRS',\n        time: Date.now() - start\n      });\n    }\n\n    ldrs = jcamp.split(/[\\r\\n]+##/);\n\n    if (result.profiling) {\n      result.profiling.push({\n        action: 'Split to LDRS',\n        time: Date.now() - start\n      });\n    }\n\n    if (ldrs[0]) ldrs[0] = ldrs[0].replace(/^[\\r\\n ]*##/, '');\n\n    for (let i = 0; i < ldrs.length; i++) {\n      ldr = ldrs[i];\n      // This is a new LDR\n      position = ldr.indexOf('=');\n      if (position > 0) {\n        dataLabel = ldr.substring(0, position);\n        dataValue = ldr.substring(position + 1).trim();\n      } else {\n        dataLabel = ldr;\n        dataValue = '';\n      }\n      dataLabel = dataLabel.replace(/[_ -]/g, '').toUpperCase();\n\n      if (dataLabel === 'DATATABLE') {\n        endLine = dataValue.indexOf('\\n');\n        if (endLine === -1) endLine = dataValue.indexOf('\\r');\n        if (endLine > 0) {\n          var xIndex = -1;\n          var yIndex = -1;\n          // ##DATA TABLE= (X++(I..I)), XYDATA\n          // We need to find the variables\n\n          infos = dataValue.substring(0, endLine).split(/[ ,;\\t]+/);\n          if (infos[0].indexOf('++') > 0) {\n            var firstVariable = infos[0].replace(\n              /.*\\(([a-zA-Z0-9]+)\\+\\+.*/,\n              '$1'\n            );\n            var secondVariable = infos[0].replace(\n              /.*\\.\\.([a-zA-Z0-9]+).*/,\n              '$1'\n            );\n            xIndex = ntuples.symbol.indexOf(firstVariable);\n            yIndex = ntuples.symbol.indexOf(secondVariable);\n          }\n\n          if (xIndex === -1) xIndex = 0;\n          if (yIndex === -1) yIndex = 0;\n\n          if (ntuples.first) {\n            if (ntuples.first.length > xIndex) {\n              spectrum.firstX = ntuples.first[xIndex];\n            }\n            if (ntuples.first.length > yIndex) {\n              spectrum.firstY = ntuples.first[yIndex];\n            }\n          }\n          if (ntuples.last) {\n            if (ntuples.last.length > xIndex) {\n              spectrum.lastX = ntuples.last[xIndex];\n            }\n            if (ntuples.last.length > yIndex) {\n              spectrum.lastY = ntuples.last[yIndex];\n            }\n          }\n          if (ntuples.vardim && ntuples.vardim.length > xIndex) {\n            spectrum.nbPoints = ntuples.vardim[xIndex];\n          }\n          if (ntuples.factor) {\n            if (ntuples.factor.length > xIndex) {\n              spectrum.xFactor = ntuples.factor[xIndex];\n            }\n            if (ntuples.factor.length > yIndex) {\n              spectrum.yFactor = ntuples.factor[yIndex];\n            }\n          }\n          if (ntuples.units) {\n            if (ntuples.units.length > xIndex) {\n              spectrum.xUnit = ntuples.units[xIndex];\n            }\n            if (ntuples.units.length > yIndex) {\n              spectrum.yUnit = ntuples.units[yIndex];\n            }\n          }\n          spectrum.datatable = infos[0];\n          if (infos[1] && infos[1].indexOf('PEAKS') > -1) {\n            dataLabel = 'PEAKTABLE';\n          } else if (\n            infos[1] &&\n            (infos[1].indexOf('XYDATA') || infos[0].indexOf('++') > 0)\n          ) {\n            dataLabel = 'XYDATA';\n            spectrum.deltaX =\n              (spectrum.lastX - spectrum.firstX) / (spectrum.nbPoints - 1);\n          }\n        }\n      }\n\n      if (dataLabel === 'XYDATA') {\n        if (wantXY) {\n          prepareSpectrum(result, spectrum);\n          // well apparently we should still consider it is a PEAK TABLE if there are no '++' after\n          if (dataValue.match(/.*\\+\\+.*/)) {\n            // ex: (X++(Y..Y))\n            if (!spectrum.deltaX) {\n              spectrum.deltaX =\n                (spectrum.lastX - spectrum.firstX) / (spectrum.nbPoints - 1);\n            }\n            fastParseXYData(spectrum, dataValue, result);\n          } else {\n            parsePeakTable(spectrum, dataValue, result);\n          }\n          spectra.push(spectrum);\n          spectrum = new Spectrum();\n        }\n        continue;\n      } else if (dataLabel === 'PEAKTABLE') {\n        if (wantXY) {\n          prepareSpectrum(result, spectrum);\n          parsePeakTable(spectrum, dataValue, result);\n          spectra.push(spectrum);\n          spectrum = new Spectrum();\n        }\n        continue;\n      }\n      if (dataLabel === 'PEAKASSIGNMENTS') {\n        if (wantXY) {\n          if (dataValue.match(/.*(XYA).*/)) {\n            // ex: (XYA)\n            parseXYA(spectrum, dataValue);\n          }\n          spectra.push(spectrum);\n          spectrum = new Spectrum();\n        }\n        continue;\n      }\n\n      if (dataLabel === 'TITLE') {\n        spectrum.title = dataValue;\n      } else if (dataLabel === 'DATATYPE') {\n        spectrum.dataType = dataValue;\n        if (dataValue.indexOf('nD') > -1) {\n          result.twoD = true;\n        }\n      } else if (dataLabel === 'NTUPLES') {\n        if (dataValue.indexOf('nD') > -1) {\n          result.twoD = true;\n        }\n      } else if (dataLabel === 'XUNITS') {\n        spectrum.xUnit = dataValue;\n      } else if (dataLabel === 'YUNITS') {\n        spectrum.yUnit = dataValue;\n      } else if (dataLabel === 'FIRSTX') {\n        spectrum.firstX = parseFloat(dataValue);\n      } else if (dataLabel === 'LASTX') {\n        spectrum.lastX = parseFloat(dataValue);\n      } else if (dataLabel === 'FIRSTY') {\n        spectrum.firstY = parseFloat(dataValue);\n      } else if (dataLabel === 'LASTY') {\n        spectrum.lastY = parseFloat(dataValue);\n      } else if (dataLabel === 'NPOINTS') {\n        spectrum.nbPoints = parseFloat(dataValue);\n      } else if (dataLabel === 'XFACTOR') {\n        spectrum.xFactor = parseFloat(dataValue);\n      } else if (dataLabel === 'YFACTOR') {\n        spectrum.yFactor = parseFloat(dataValue);\n      } else if (dataLabel === 'MAXX') {\n        spectrum.maxX = parseFloat(dataValue);\n      } else if (dataLabel === 'MINX') {\n        spectrum.minX = parseFloat(dataValue);\n      } else if (dataLabel === 'MAXY') {\n        spectrum.maxY = parseFloat(dataValue);\n      } else if (dataLabel === 'MINY') {\n        spectrum.minY = parseFloat(dataValue);\n      } else if (dataLabel === 'DELTAX') {\n        spectrum.deltaX = parseFloat(dataValue);\n      } else if (dataLabel === '.OBSERVEFREQUENCY' || dataLabel === '$SFO1') {\n        if (!spectrum.observeFrequency) {\n          spectrum.observeFrequency = parseFloat(dataValue);\n        }\n      } else if (dataLabel === '.OBSERVENUCLEUS') {\n        if (!spectrum.xType) {\n          result.xType = dataValue.replace(/[^a-zA-Z0-9]/g, '');\n        }\n      } else if (dataLabel === '$SFO2') {\n        if (!result.indirectFrequency) {\n          result.indirectFrequency = parseFloat(dataValue);\n        }\n      } else if (dataLabel === '$OFFSET') {\n        // OFFSET for Bruker spectra\n        result.shiftOffsetNum = 0;\n        if (!spectrum.shiftOffsetVal) {\n          spectrum.shiftOffsetVal = parseFloat(dataValue);\n        }\n      } else if (dataLabel === '$REFERENCEPOINT') {\n        // OFFSET for Varian spectra\n        // if we activate this part it does not work for ACD specmanager\n        //         } else if (dataLabel=='.SHIFTREFERENCE') {   // OFFSET FOR Bruker Spectra\n        //                 var parts = dataValue.split(/ *, */);\n        //                 result.shiftOffsetNum = parseInt(parts[2].trim());\n        //                 spectrum.shiftOffsetVal = parseFloat(parts[3].trim());\n      } else if (dataLabel === 'VARNAME') {\n        ntuples.varname = dataValue.split(ntuplesSeparator);\n      } else if (dataLabel === 'SYMBOL') {\n        ntuples.symbol = dataValue.split(ntuplesSeparator);\n      } else if (dataLabel === 'VARTYPE') {\n        ntuples.vartype = dataValue.split(ntuplesSeparator);\n      } else if (dataLabel === 'VARFORM') {\n        ntuples.varform = dataValue.split(ntuplesSeparator);\n      } else if (dataLabel === 'VARDIM') {\n        ntuples.vardim = convertToFloatArray(dataValue.split(ntuplesSeparator));\n      } else if (dataLabel === 'UNITS') {\n        ntuples.units = dataValue.split(ntuplesSeparator);\n      } else if (dataLabel === 'FACTOR') {\n        ntuples.factor = convertToFloatArray(dataValue.split(ntuplesSeparator));\n      } else if (dataLabel === 'FIRST') {\n        ntuples.first = convertToFloatArray(dataValue.split(ntuplesSeparator));\n      } else if (dataLabel === 'LAST') {\n        ntuples.last = convertToFloatArray(dataValue.split(ntuplesSeparator));\n      } else if (dataLabel === 'MIN') {\n        ntuples.min = convertToFloatArray(dataValue.split(ntuplesSeparator));\n      } else if (dataLabel === 'MAX') {\n        ntuples.max = convertToFloatArray(dataValue.split(ntuplesSeparator));\n      } else if (dataLabel === '.NUCLEUS') {\n        if (result.twoD) {\n          result.yType = dataValue.split(ntuplesSeparator)[0];\n        }\n      } else if (dataLabel === 'PAGE') {\n        spectrum.page = dataValue.trim();\n        spectrum.pageValue = parseFloat(dataValue.replace(/^.*=/, ''));\n        spectrum.pageSymbol = spectrum.page.replace(/[=].*/, '');\n        var pageSymbolIndex = ntuples.symbol.indexOf(spectrum.pageSymbol);\n        var unit = '';\n        if (ntuples.units && ntuples.units[pageSymbolIndex]) {\n          unit = ntuples.units[pageSymbolIndex];\n        }\n        if (result.indirectFrequency && unit !== 'PPM') {\n          spectrum.pageValue /= result.indirectFrequency;\n        }\n      } else if (dataLabel === 'RETENTIONTIME') {\n        spectrum.pageValue = parseFloat(dataValue);\n      } else if (isMSField(dataLabel)) {\n        spectrum[convertMSFieldToLabel(dataLabel)] = dataValue;\n      } else if (dataLabel === 'SAMPLEDESCRIPTION') {\n        spectrum.sampleDescription = dataValue;\n      }\n      if (dataLabel.match(options.keepRecordsRegExp)) {\n        if (result.info[dataLabel]) {\n          if (!Array.isArray(result.info[dataLabel])) {\n            result.info[dataLabel] = [result.info[dataLabel]];\n          }\n          result.info[dataLabel].push(dataValue.trim());\n        } else {\n          result.info[dataLabel] = dataValue.trim();\n        }\n      }\n    }\n\n    if (result.profiling) {\n      result.profiling.push({\n        action: 'Finished parsing',\n        time: Date.now() - start\n      });\n    }\n\n    if (Object.keys(ntuples).length > 0) {\n      var newNtuples = [];\n      var keys = Object.keys(ntuples);\n      for (let i = 0; i < keys.length; i++) {\n        var key = keys[i];\n        var values = ntuples[key];\n        for (let j = 0; j < values.length; j++) {\n          if (!newNtuples[j]) newNtuples[j] = {};\n          newNtuples[j][key] = values[j];\n        }\n      }\n      result.ntuples = newNtuples;\n    }\n\n    if (result.twoD && wantXY) {\n      add2D(result, options);\n      if (result.profiling) {\n        result.profiling.push({\n          action: 'Finished countour plot calculation',\n          time: Date.now() - start\n        });\n      }\n      if (!options.keepSpectra) {\n        delete result.spectra;\n      }\n    }\n\n    if (options.chromatogram) {\n      options.xy = true;\n    }\n\n    if (options.xy && wantXY) {\n      // the spectraData should not be a oneD array but an object with x and y\n      if (spectra.length > 0) {\n        for (let i = 0; i < spectra.length; i++) {\n          spectrum = spectra[i];\n          if (spectrum.data.length > 0) {\n            for (let j = 0; j < spectrum.data.length; j++) {\n              var data = spectrum.data[j];\n              var newData = {\n                x: new Array(data.length / 2),\n                y: new Array(data.length / 2)\n              };\n              for (var k = 0; k < data.length; k = k + 2) {\n                newData.x[k / 2] = data[k];\n                newData.y[k / 2] = data[k + 1];\n              }\n              spectrum.data[j] = newData;\n            }\n          }\n        }\n      }\n    }\n\n    // maybe it is a GC (HPLC) / MS. In this case we add a new format\n    if (options.chromatogram) {\n      if (result.spectra.length > 1) {\n        complexChromatogram(result);\n      } else {\n        simpleChromatogram(result);\n      }\n      if (result.profiling) {\n        result.profiling.push({\n          action: 'Finished chromatogram calculation',\n          time: Date.now() - start\n        });\n      }\n    }\n\n    if (result.profiling) {\n      result.profiling.push({\n        action: 'Total time',\n        time: Date.now() - start\n      });\n    }\n\n    return result;\n  }\n\n  function convertMSFieldToLabel(value) {\n    return value.toLowerCase().replace(/[^a-z0-9]/g, '');\n  }\n\n  function isMSField(dataLabel) {\n    return GC_MS_FIELDS.indexOf(dataLabel) !== -1;\n  }\n\n  function complexChromatogram(result) {\n    var spectra = result.spectra;\n    var length = spectra.length;\n    var chromatogram = {\n      times: new Array(length),\n      series: {\n        ms: {\n          dimension: 2,\n          data: new Array(length)\n        }\n      }\n    };\n\n    var existingGCMSFields = [];\n    for (let i = 0; i < GC_MS_FIELDS.length; i++) {\n      var label = convertMSFieldToLabel(GC_MS_FIELDS[i]);\n      if (spectra[0][label]) {\n        existingGCMSFields.push(label);\n        chromatogram.series[label] = {\n          dimension: 1,\n          data: new Array(length)\n        };\n      }\n    }\n\n    for (let i = 0; i < length; i++) {\n      var spectrum = spectra[i];\n      chromatogram.times[i] = spectrum.pageValue;\n      for (let j = 0; j < existingGCMSFields.length; j++) {\n        chromatogram.series[existingGCMSFields[j]].data[i] = parseFloat(\n          spectrum[existingGCMSFields[j]]\n        );\n      }\n      if (spectrum.data) {\n        chromatogram.series.ms.data[i] = [\n          spectrum.data[0].x,\n          spectrum.data[0].y\n        ];\n      }\n    }\n    result.chromatogram = chromatogram;\n  }\n\n  function simpleChromatogram(result) {\n    var data = result.spectra[0].data[0];\n    result.chromatogram = {\n      times: data.x.slice(),\n      series: {\n        intensity: {\n          dimension: 1,\n          data: data.y.slice()\n        }\n      }\n    };\n  }\n\n  function prepareSpectrum(result, spectrum) {\n    if (!spectrum.xFactor) spectrum.xFactor = 1;\n    if (!spectrum.yFactor) spectrum.yFactor = 1;\n    if (spectrum.observeFrequency) {\n      if (spectrum.xUnit && spectrum.xUnit.toUpperCase() === 'HZ') {\n        spectrum.xUnit = 'PPM';\n        spectrum.xFactor = spectrum.xFactor / spectrum.observeFrequency;\n        spectrum.firstX = spectrum.firstX / spectrum.observeFrequency;\n        spectrum.lastX = spectrum.lastX / spectrum.observeFrequency;\n        spectrum.deltaX = spectrum.deltaX / spectrum.observeFrequency;\n      }\n    }\n    if (spectrum.shiftOffsetVal) {\n      var shift = spectrum.firstX - spectrum.shiftOffsetVal;\n      spectrum.firstX = spectrum.firstX - shift;\n      spectrum.lastX = spectrum.lastX - shift;\n    }\n  }\n\n  function getMedian(data) {\n    data = data.sort(compareNumbers);\n    var l = data.length;\n    return data[Math.floor(l / 2)];\n  }\n\n  function compareNumbers(a, b) {\n    return a - b;\n  }\n\n  function convertTo3DZ(spectra) {\n    var minZ = spectra[0].data[0][0];\n    var maxZ = minZ;\n    var ySize = spectra.length;\n    var xSize = spectra[0].data[0].length / 2;\n    var z = new Array(ySize);\n    for (let i = 0; i < ySize; i++) {\n      z[i] = new Array(xSize);\n      var xVector = spectra[i].data[0];\n      for (let j = 0; j < xSize; j++) {\n        var value = xVector[j * 2 + 1];\n        z[i][j] = value;\n        if (value < minZ) minZ = value;\n        if (value > maxZ) maxZ = value;\n      }\n    }\n\n    const firstX = spectra[0].data[0][0];\n    const lastX = spectra[0].data[0][spectra[0].data[0].length - 2]; // has to be -2 because it is a 1D array [x,y,x,y,...]\n    const firstY = spectra[0].pageValue;\n    const lastY = spectra[ySize - 1].pageValue;\n\n    // Because the min / max value are the only information about the matrix if we invert\n    // min and max we need to invert the array\n    if (firstX > lastX) {\n      for (let spectrum of z) {\n        spectrum.reverse();\n      }\n    }\n    if (firstY > lastY) {\n      z.reverse();\n    }\n\n    return {\n      z: z,\n      minX: Math.min(firstX, lastX),\n      maxX: Math.max(firstX, lastX),\n      minY: Math.min(firstY, lastY),\n      maxY: Math.max(firstY, lastY),\n      minZ: minZ,\n      maxZ: maxZ,\n      noise: getMedian(z[0].map(Math.abs))\n    };\n  }\n\n  function add2D(result, options) {\n    var zData = convertTo3DZ(result.spectra);\n    if (!options.noContour) {\n      result.contourLines = generateContourLines(zData, options);\n      delete zData.z;\n    }\n    result.minMax = zData;\n  }\n\n  function generateContourLines(zData, options) {\n    var noise = zData.noise;\n    var z = zData.z;\n    var povarHeight0, povarHeight1, povarHeight2, povarHeight3;\n    var isOver0, isOver1, isOver2, isOver3;\n    var nbSubSpectra = z.length;\n    var nbPovars = z[0].length;\n    var pAx, pAy, pBx, pBy;\n\n    var x0 = zData.minX;\n    var xN = zData.maxX;\n    var dx = (xN - x0) / (nbPovars - 1);\n    var y0 = zData.minY;\n    var yN = zData.maxY;\n    var dy = (yN - y0) / (nbSubSpectra - 1);\n    var minZ = zData.minZ;\n    var maxZ = zData.maxZ;\n\n    // System.out.prvarln('y0 '+y0+' yN '+yN);\n    // -------------------------\n    // Povars attribution\n    //\n    // 0----1\n    // |  / |\n    // | /  |\n    // 2----3\n    //\n    // ---------------------d------\n\n    var iter = options.nbContourLevels * 2;\n    var contourLevels = new Array(iter);\n    var lineZValue;\n    for (var level = 0; level < iter; level++) {\n      // multiply by 2 for positif and negatif\n      var contourLevel = {};\n      contourLevels[level] = contourLevel;\n      var side = level % 2;\n      var factor =\n        (maxZ - options.noiseMultiplier * noise) *\n        Math.exp((level >> 1) - options.nbContourLevels);\n      if (side === 0) {\n        lineZValue = factor + options.noiseMultiplier * noise;\n      } else {\n        lineZValue = 0 - factor - options.noiseMultiplier * noise;\n      }\n      var lines = [];\n      contourLevel.zValue = lineZValue;\n      contourLevel.lines = lines;\n\n      if (lineZValue <= minZ || lineZValue >= maxZ) continue;\n\n      for (var iSubSpectra = 0; iSubSpectra < nbSubSpectra - 1; iSubSpectra++) {\n        var subSpectra = z[iSubSpectra];\n        var subSpectraAfter = z[iSubSpectra + 1];\n        for (var povar = 0; povar < nbPovars - 1; povar++) {\n          povarHeight0 = subSpectra[povar];\n          povarHeight1 = subSpectra[povar + 1];\n          povarHeight2 = subSpectraAfter[povar];\n          povarHeight3 = subSpectraAfter[povar + 1];\n\n          isOver0 = povarHeight0 > lineZValue;\n          isOver1 = povarHeight1 > lineZValue;\n          isOver2 = povarHeight2 > lineZValue;\n          isOver3 = povarHeight3 > lineZValue;\n\n          // Example povar0 is over the plane and povar1 and\n          // povar2 are below, we find the varersections and add\n          // the segment\n          if (isOver0 !== isOver1 && isOver0 !== isOver2) {\n            pAx =\n              povar +\n              (lineZValue - povarHeight0) / (povarHeight1 - povarHeight0);\n            pAy = iSubSpectra;\n            pBx = povar;\n            pBy =\n              iSubSpectra +\n              (lineZValue - povarHeight0) / (povarHeight2 - povarHeight0);\n            lines.push(pAx * dx + x0);\n            lines.push(pAy * dy + y0);\n            lines.push(pBx * dx + x0);\n            lines.push(pBy * dy + y0);\n          }\n          // remove push does not help !!!!\n          if (isOver3 !== isOver1 && isOver3 !== isOver2) {\n            pAx = povar + 1;\n            pAy =\n              iSubSpectra +\n              1 -\n              (lineZValue - povarHeight3) / (povarHeight1 - povarHeight3);\n            pBx =\n              povar +\n              1 -\n              (lineZValue - povarHeight3) / (povarHeight2 - povarHeight3);\n            pBy = iSubSpectra + 1;\n            lines.push(pAx * dx + x0);\n            lines.push(pAy * dy + y0);\n            lines.push(pBx * dx + x0);\n            lines.push(pBy * dy + y0);\n          }\n          // test around the diagonal\n          if (isOver1 !== isOver2) {\n            pAx =\n              (povar +\n                1 -\n                (lineZValue - povarHeight1) / (povarHeight2 - povarHeight1)) *\n                dx +\n              x0;\n            pAy =\n              (iSubSpectra +\n                (lineZValue - povarHeight1) / (povarHeight2 - povarHeight1)) *\n                dy +\n              y0;\n            if (isOver1 !== isOver0) {\n              pBx =\n                povar +\n                1 -\n                (lineZValue - povarHeight1) / (povarHeight0 - povarHeight1);\n              pBy = iSubSpectra;\n              lines.push(pAx);\n              lines.push(pAy);\n              lines.push(pBx * dx + x0);\n              lines.push(pBy * dy + y0);\n            }\n            if (isOver2 !== isOver0) {\n              pBx = povar;\n              pBy =\n                iSubSpectra +\n                1 -\n                (lineZValue - povarHeight2) / (povarHeight0 - povarHeight2);\n              lines.push(pAx);\n              lines.push(pAy);\n              lines.push(pBx * dx + x0);\n              lines.push(pBy * dy + y0);\n            }\n            if (isOver1 !== isOver3) {\n              pBx = povar + 1;\n              pBy =\n                iSubSpectra +\n                (lineZValue - povarHeight1) / (povarHeight3 - povarHeight1);\n              lines.push(pAx);\n              lines.push(pAy);\n              lines.push(pBx * dx + x0);\n              lines.push(pBy * dy + y0);\n            }\n            if (isOver2 !== isOver3) {\n              pBx =\n                povar +\n                (lineZValue - povarHeight2) / (povarHeight3 - povarHeight2);\n              pBy = iSubSpectra + 1;\n              lines.push(pAx);\n              lines.push(pAy);\n              lines.push(pBx * dx + x0);\n              lines.push(pBy * dy + y0);\n            }\n          }\n        }\n      }\n    }\n\n    return {\n      minX: zData.minX,\n      maxX: zData.maxX,\n      minY: zData.minY,\n      maxY: zData.maxY,\n      segments: contourLevels\n    };\n  }\n\n  function fastParseXYData(spectrum, value) {\n    // TODO need to deal with result\n    //  console.log(value);\n    // we check if deltaX is defined otherwise we calculate it\n\n    var yFactor = spectrum.yFactor;\n    var deltaX = spectrum.deltaX;\n\n    spectrum.isXYdata = true;\n    // TODO to be improved using 2 array {x:[], y:[]}\n    var currentData = [];\n    spectrum.data = [currentData];\n\n    var currentX = spectrum.firstX;\n    var currentY = spectrum.firstY;\n\n    // we skip the first line\n    //\n    var endLine = false;\n    var ascii;\n    let i = 0;\n    for (; i < value.length; i++) {\n      ascii = value.charCodeAt(i);\n      if (ascii === 13 || ascii === 10) {\n        endLine = true;\n      } else {\n        if (endLine) break;\n      }\n    }\n\n    // we proceed taking the i after the first line\n    var newLine = true;\n    var isDifference = false;\n    var isLastDifference = false;\n    var lastDifference = 0;\n    var isDuplicate = false;\n    var inComment = false;\n    var currentValue = 0; // can be a difference or a duplicate\n    var lastValue = 0; // must be the real last value\n    var isNegative = false;\n    var inValue = false;\n    var skipFirstValue = false;\n    var decimalPosition = 0;\n    for (; i <= value.length; i++) {\n      if (i === value.length) ascii = 13;\n      else ascii = value.charCodeAt(i);\n      if (inComment) {\n        // we should ignore the text if we are after $$\n        if (ascii === 13 || ascii === 10) {\n          newLine = true;\n          inComment = false;\n        }\n      } else {\n        // when is it a new value ?\n        // when it is not a digit, . or comma\n        // it is a number that is either new or we continue\n        if (ascii <= 57 && ascii >= 48) {\n          // a number\n          inValue = true;\n          if (decimalPosition > 0) {\n            currentValue += (ascii - 48) / Math.pow(10, decimalPosition++);\n          } else {\n            currentValue *= 10;\n            currentValue += ascii - 48;\n          }\n        } else if (ascii === 44 || ascii === 46) {\n          // a \",\" or \".\"\n          inValue = true;\n          decimalPosition++;\n        } else {\n          if (inValue) {\n            // need to process the previous value\n            if (newLine) {\n              newLine = false; // we don't check the X value\n              // console.log(\"NEW LINE\",isDifference, lastDifference);\n              // if new line and lastDifference, the first value is just a check !\n              // that we don't check ...\n              if (isLastDifference) skipFirstValue = true;\n            } else {\n              // need to deal with duplicate and differences\n              if (skipFirstValue) {\n                skipFirstValue = false;\n              } else {\n                if (isDifference) {\n                  lastDifference = isNegative ? 0 - currentValue : currentValue;\n                  isLastDifference = true;\n                  isDifference = false;\n                } else if (!isDuplicate) {\n                  lastValue = isNegative ? 0 - currentValue : currentValue;\n                }\n                var duplicate = isDuplicate ? currentValue - 1 : 1;\n                for (var j = 0; j < duplicate; j++) {\n                  if (isLastDifference) {\n                    currentY += lastDifference;\n                  } else {\n                    currentY = lastValue;\n                  }\n                  currentData.push(currentX);\n                  currentData.push(currentY * yFactor);\n                  currentX += deltaX;\n                }\n              }\n            }\n            isNegative = false;\n            currentValue = 0;\n            decimalPosition = 0;\n            inValue = false;\n            isDuplicate = false;\n          }\n\n          // positive SQZ digits @ A B C D E F G H I (ascii 64-73)\n          if (ascii < 74 && ascii > 63) {\n            inValue = true;\n            isLastDifference = false;\n            currentValue = ascii - 64;\n          } else if (ascii > 96 && ascii < 106) {\n            // negative SQZ digits a b c d e f g h i (ascii 97-105)\n            inValue = true;\n            isLastDifference = false;\n            currentValue = ascii - 96;\n            isNegative = true;\n          } else if (ascii === 115) {\n            // DUP digits S T U V W X Y Z s (ascii 83-90, 115)\n            inValue = true;\n            isDuplicate = true;\n            currentValue = 9;\n          } else if (ascii > 82 && ascii < 91) {\n            inValue = true;\n            isDuplicate = true;\n            currentValue = ascii - 82;\n          } else if (ascii > 73 && ascii < 83) {\n            // positive DIF digits % J K L M N O P Q R (ascii 37, 74-82)\n            inValue = true;\n            isDifference = true;\n            currentValue = ascii - 73;\n          } else if (ascii > 105 && ascii < 115) {\n            // negative DIF digits j k l m n o p q r (ascii 106-114)\n            inValue = true;\n            isDifference = true;\n            currentValue = ascii - 105;\n            isNegative = true;\n          } else if (ascii === 36 && value.charCodeAt(i + 1) === 36) {\n            // $ sign, we need to check the next one\n            inValue = true;\n            inComment = true;\n          } else if (ascii === 37) {\n            // positive DIF digits % J K L M N O P Q R (ascii 37, 74-82)\n            inValue = true;\n            isDifference = true;\n            currentValue = 0;\n            isNegative = false;\n          } else if (ascii === 45) {\n            // a \"-\"\n            // check if after there is a number, decimal or comma\n            var ascii2 = value.charCodeAt(i + 1);\n            if (\n              (ascii2 >= 48 && ascii2 <= 57) ||\n              ascii2 === 44 ||\n              ascii2 === 46\n            ) {\n              inValue = true;\n              if (!newLine) isLastDifference = false;\n              isNegative = true;\n            }\n          } else if (ascii === 13 || ascii === 10) {\n            newLine = true;\n            inComment = false;\n          }\n          // and now analyse the details ... space or tabulation\n          // if \"+\" we just don't care\n        }\n      }\n    }\n  }\n\n  function parseXYA(spectrum, value) {\n    var removeSymbolRegExp = /(\\(+|\\)+|<+|>+|\\s+)/g;\n\n    spectrum.isXYAdata = true;\n    var values;\n    var currentData = [];\n    spectrum.data = [currentData];\n\n    var lines = value.split(/,? *,?[;\\r\\n]+ */);\n\n    for (let i = 1; i < lines.length; i++) {\n      values = lines[i]\n        .trim()\n        .replace(removeSymbolRegExp, '')\n        .split(',');\n      currentData.push(parseFloat(values[0]));\n      currentData.push(parseFloat(values[1]));\n    }\n  }\n\n  function parsePeakTable(spectrum, value, result) {\n    var removeCommentRegExp = /\\$\\$.*/;\n    var peakTableSplitRegExp = /[,\\t ]+/;\n\n    spectrum.isPeaktable = true;\n    var values;\n    var currentData = [];\n    spectrum.data = [currentData];\n\n    // counts for around 20% of the time\n    var lines = value.split(/,? *,?[;\\r\\n]+ */);\n\n    for (let i = 1; i < lines.length; i++) {\n      values = lines[i]\n        .trim()\n        .replace(removeCommentRegExp, '')\n        .split(peakTableSplitRegExp);\n      if (values.length % 2 === 0) {\n        for (let j = 0; j < values.length; j = j + 2) {\n          // takes around 40% of the time to add and parse the 2 values nearly exclusively because of parseFloat\n          currentData.push(parseFloat(values[j]) * spectrum.xFactor);\n          currentData.push(parseFloat(values[j + 1]) * spectrum.yFactor);\n        }\n      } else {\n        result.logs.push(`Format error: ${values}`);\n      }\n    }\n  }\n\n  return convert;\n}\n\nvar convert = getConverter();\n\nfunction JcampConverter(input, options, useWorker) {\n  if (typeof options === 'boolean') {\n    useWorker = options;\n    options = {};\n  }\n  if (useWorker) {\n    return postToWorker(input, options);\n  } else {\n    return convert(input, options);\n  }\n}\n\nvar stamps = {};\nvar worker;\n\nfunction postToWorker(input, options) {\n  if (!worker) {\n    createWorker();\n  }\n  return new Promise(function (resolve) {\n    var stamp = `${Date.now()}${Math.random()}`;\n    stamps[stamp] = resolve;\n    worker.postMessage(\n      JSON.stringify({\n        stamp: stamp,\n        input: input,\n        options: options\n      })\n    );\n  });\n}\n\nfunction createWorker() {\n  var workerURL = URL.createObjectURL(\n    new Blob(\n      [`var getConverter =${getConverter.toString()};var convert = getConverter(); onmessage = function (event) { var data = JSON.parse(event.data); postMessage(JSON.stringify({stamp: data.stamp, output: convert(data.input, data.options)})); };`],\n      { type: 'application/javascript' }\n    )\n  );\n  worker = new Worker(workerURL);\n  URL.revokeObjectURL(workerURL);\n  worker.addEventListener('message', function (event) {\n    var data = JSON.parse(event.data);\n    var stamp = data.stamp;\n    if (stamps[stamp]) {\n      stamps[stamp](data.output);\n    }\n  });\n}\n\nfunction createTree(jcamp, options = {}) {\n  const { flatten = false } = options;\n  if (typeof jcamp !== 'string') {\n    throw new TypeError('the JCAMP should be a string');\n  }\n\n  let lines = jcamp.split(/[\\r\\n]+/);\n  let flat = [];\n  let stack = [];\n  let result = [];\n  let current;\n  let ntupleLevel = 0;\n\n  let spaces = jcamp.includes('## ');\n\n  for (var i = 0; i < lines.length; i++) {\n    let line = lines[i];\n    let labelLine = spaces ? line.replace(/ /g, '') : line;\n\n    if (labelLine.substring(0, 9) === '##NTUPLES') {\n      ntupleLevel++;\n    }\n\n    if (labelLine.substring(0, 7) === '##TITLE') {\n      let title = [labelLine.substring(8).trim()];\n      for (let j = i + 1; j < lines.length; j++) {\n        if (lines[j].startsWith('##')) {\n          break;\n        } else {\n          title.push(lines[j].trim());\n        }\n      }\n      stack.push({\n        title: title.join('\\n'),\n        jcamp: `${line}\\n`,\n        children: []\n      });\n      current = stack[stack.length - 1];\n      flat.push(current);\n    } else if (labelLine.substring(0, 5) === '##END' && ntupleLevel === 0) {\n      current.jcamp += `${line}\\n`;\n      var finished = stack.pop();\n      if (stack.length !== 0) {\n        current = stack[stack.length - 1];\n        current.children.push(finished);\n      } else {\n        current = undefined;\n        result.push(finished);\n      }\n    } else if (current && current.jcamp) {\n      current.jcamp += `${line}\\n`;\n      var match = labelLine.match(/^##(.*?)=(.+)/);\n      if (match) {\n        var dataLabel = match[1].replace(/[ _-]/g, '').toUpperCase();\n        if (dataLabel === 'DATATYPE') {\n          current.dataType = match[2].trim();\n        }\n      }\n    }\n\n    if (labelLine.substring(0, 5) === '##END' && ntupleLevel > 0) {\n      ntupleLevel--;\n    }\n  }\n  if (flatten) {\n    flat.forEach((entry) => {\n      entry.children = undefined;\n    });\n    return flat;\n  } else {\n    return result;\n  }\n}\n\nmodule.exports = {\n  convert: JcampConverter,\n  createTree: createTree\n};\n","export default function sortX(points, options = {}) {\n  const { x, y } = points;\n  const { reverse = false } = options;\n\n  var sortFunc;\n  if (!reverse) {\n    sortFunc = (a, b) => a.x - b.x;\n  } else {\n    sortFunc = (a, b) => b.x - a.x;\n  }\n\n  var grouped = x\n    .map((val, index) => ({\n      x: val,\n      y: y[index]\n    }))\n    .sort(sortFunc);\n\n  var response = { x: x.slice(), y: y.slice() };\n  for (var i = 0; i < x.length; i++) {\n    response.x[i] = grouped[i].x;\n    response.y[i] = grouped[i].y;\n  }\n\n  return response;\n}\n","import uniqueXFunction from 'ml-arrayxy-uniquex';\n\n/**\n * Parse a text-file and convert it to an array of XY points\n * @param {string} text - csv or tsv strings\n * @param {object} [options]\n * @param {string} [options.arrayType = 'xyxy'] - xxyy or xyxy\n * * 'xxyy' `[[x1,x2,x3,...],[y1,y2,y2,...]]`\n * * 'xyxy' `[[x1,y1],[x2,y2],[x3,y3], ...]]`\n * @param {boolean} [options.normalize = false] - will set the maximum value to 1\n * @param {boolean} [options.uniqueX = false] - Make the X values unique (works only with 'xxyy' format). If the X value is repeated the sum of Y is done.\n * @param {number} [options.xColumn = 0] - A number that specifies the x column\n * @param {number} [options.yColumn = 1] - A number that specifies the y column\n * @param {number} [options.maxNumberColumns = (Math.max(xColumn, yColumn)+1)] - A number that specifies the maximum number of y columns\n * @param {number} [options.minNumberColumns = (Math.max(xColumn, yColumn)+1)] - A number that specifies the minimum number of y columns\n * @param {boolean} [options.keepInfo = false] - shoud we keep the non numeric lines. In this case the system will return an object {data, info}\n * @return {Array<Array<number>>} - check the 'arrayType' option\n */\nexport function parseXY(text, options = {}) {\n  const {\n    normalize = false,\n    uniqueX = false,\n    arrayType = 'xyxy',\n    xColumn = 0,\n    yColumn = 1,\n    keepInfo = false,\n    maxNumberColumns = Math.max(xColumn, yColumn) + 1,\n    minNumberColumns = Math.max(xColumn, yColumn) + 1\n  } = options;\n\n  var lines = text.split(/[\\r\\n]+/);\n\n  if (arrayType !== 'xxyy' && arrayType !== 'xyxy') {\n    throw new Error(`unsupported arrayType (${arrayType})`);\n  }\n\n  var maxY = Number.MIN_VALUE;\n  var result = [[], []];\n  var info = [];\n  for (var l = 0; l < lines.length; l++) {\n    var line = lines[l].trim();\n    // we will consider only lines that contains only numbers\n    if (line.match(/[0-9]+/) && line.match(/^[0-9eE,;. \\t+-]+$/)) {\n      var fields = line.split(/,[; \\t]+|[; \\t]+/);\n      if (fields.length === 1) {\n        fields = line.split(/[,; \\t]+/);\n      }\n      if (\n        fields &&\n                fields.length >= minNumberColumns &&\n                fields.length <= maxNumberColumns\n      ) {\n        let x = parseFloat(fields[xColumn].replace(',', '.'));\n        let y = parseFloat(fields[yColumn].replace(',', '.'));\n\n        if (y > maxY) maxY = y;\n        result[0].push(x);\n        result[1].push(y);\n      }\n    } else if (line) {\n      info.push({ position: result[0].length, value: line });\n    }\n  }\n\n  if (normalize) {\n    for (var i = 0; i < result[0].length; i++) {\n      result[1][i] /= maxY;\n    }\n  }\n\n  if (uniqueX) {\n    uniqueXFunction(result[0], result[1]);\n  }\n\n  if (arrayType === 'xyxy') {\n    var newResult = [];\n    for (let i = 0; i < result[0].length; i++) {\n      newResult.push([result[0][i], result[1][i]]);\n    }\n    result = newResult;\n  }\n\n  if (!keepInfo) return result;\n\n  return {\n    info,\n    data: result\n  };\n}\n"],"sourceRoot":""}